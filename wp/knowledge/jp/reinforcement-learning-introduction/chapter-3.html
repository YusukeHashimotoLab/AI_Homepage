<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« : ææ–™æ¢ç´¢ç’°å¢ƒã®æ§‹ç¯‰ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬3ç« : ææ–™æ¢ç´¢ç’°å¢ƒã®æ§‹ç¯‰</h1>
            
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 20-30åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 7å€‹</span>
            </div>
        </div>
    </header>

    <main class="container">
        
<p><h1>ç¬¬3ç« : ææ–™æ¢ç´¢ç’°å¢ƒã®æ§‹ç¯‰</h1></p>

<p><h2>å­¦ç¿’ç›®æ¨™</h2></p>

<p>ã“ã®ç« ã§ã¯ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã—ã¾ã™ï¼š</p>

<ul>
<li>OpenAI Gymã‚«ã‚¹ã‚¿ãƒ ç’°å¢ƒã®å®Ÿè£…æ–¹æ³•</li>
<li>ææ–™è¨˜è¿°å­ã¨çŠ¶æ…‹ç©ºé–“ã®è¨­è¨ˆ</li>
<li>åŠ¹æœçš„ãªå ±é…¬é–¢æ•°ã®è¨­è¨ˆåŸå‰‡</li>
<li>DFTè¨ˆç®—ãƒ»å®Ÿé¨“è£…ç½®ã¨ã®çµ±åˆæ–¹æ³•</li>
</ul>

<p>---</p>

<p><h2>3.1 OpenAI Gymç’°å¢ƒã®åŸºç¤</h2></p>

<p><h3>Gymç’°å¢ƒã®æ§‹æˆè¦ç´ </h3></p>

<p>OpenAI Gymã¯ã€å¼·åŒ–å­¦ç¿’ç’°å¢ƒã®æ¨™æº–ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã™ã€‚ã™ã¹ã¦ã®Gymç’°å¢ƒã¯ä»¥ä¸‹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã—ã¾ã™ï¼š</p>

<p><pre><code class="language-python">import gym</p>
<p>import numpy as np</p>

<p>class CustomEnv(gym.Env):</p>
<p>    """ã‚«ã‚¹ã‚¿ãƒ Gymç’°å¢ƒã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ"""</p>

<p>    def __init__(self):</p>
<p>        super(CustomEnv, self).__init__()</p>

<p>        <h1>è¡Œå‹•ç©ºé–“ã¨è¦³æ¸¬ç©ºé–“ã®å®šç¾©ï¼ˆå¿…é ˆï¼‰</h1></p>
<p>        self.action_space = gym.spaces.Discrete(4)  <h1>é›¢æ•£è¡Œå‹•ï¼ˆ4ç¨®é¡ï¼‰</h1></p>
<p>        self.observation_space = gym.spaces.Box(</p>
<p>            low=0, high=10, shape=(4,), dtype=np.float32</p>
<p>        )  <h1>é€£ç¶šçŠ¶æ…‹ï¼ˆ4æ¬¡å…ƒã€ç¯„å›² [0, 10]ï¼‰</h1></p>

<p>    def reset(self):</p>
<p>        """ç’°å¢ƒã‚’åˆæœŸçŠ¶æ…‹ã«ãƒªã‚»ãƒƒãƒˆ</p>

<p>        Returns:</p>
<p>            observation: åˆæœŸçŠ¶æ…‹</p>
<p>        """</p>
<p>        self.state = np.random.uniform(0, 10, 4).astype(np.float32)</p>
<p>        return self.state</p>

<p>    def step(self, action):</p>
<p>        """è¡Œå‹•ã‚’å®Ÿè¡Œã—ã€ç’°å¢ƒã‚’1ã‚¹ãƒ†ãƒƒãƒ—é€²ã‚ã‚‹</p>

<p>        Args:</p>
<p>            action: å®Ÿè¡Œã™ã‚‹è¡Œå‹•</p>

<p>        Returns:</p>
<p>            observation: æ¬¡ã®çŠ¶æ…‹</p>
<p>            reward: å ±é…¬</p>
<p>            done: ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰çµ‚äº†ãƒ•ãƒ©ã‚°</p>
<p>            info: è¿½åŠ æƒ…å ±ï¼ˆè¾æ›¸ï¼‰</p>
<p>        """</p>
<p>        <h1>è¡Œå‹•ã«å¿œã˜ã¦çŠ¶æ…‹ã‚’æ›´æ–°</h1></p>
<p>        self.state = self._update_state(action)</p>

<p>        <h1>å ±é…¬ã‚’è¨ˆç®—</h1></p>
<p>        reward = self._compute_reward()</p>

<p>        <h1>çµ‚äº†æ¡ä»¶ã‚’ãƒã‚§ãƒƒã‚¯</h1></p>
<p>        done = self._is_done()</p>

<p>        <h1>è¿½åŠ æƒ…å ±</h1></p>
<p>        info = {'distance': self._compute_distance()}</p>

<p>        return self.state, reward, done, info</p>

<p>    def render(self, mode='human'):</p>
<p>        """ç’°å¢ƒã‚’å¯è¦–åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰"""</p>
<p>        print(f"Current state: {self.state}")</p>

<p>    def _update_state(self, action):</p>
<p>        """çŠ¶æ…‹æ›´æ–°ãƒ­ã‚¸ãƒƒã‚¯"""</p>
<p>        <h1>å®Ÿè£…ã¯ç’°å¢ƒã«ã‚ˆã‚‹</h1></p>
<p>        pass</p>

<p>    def _compute_reward(self):</p>
<p>        """å ±é…¬è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯"""</p>
<p>        pass</p>

<p>    def _is_done(self):</p>
<p>        """çµ‚äº†æ¡ä»¶ãƒã‚§ãƒƒã‚¯"""</p>
<p>        pass</p>

<p>    def _compute_distance(self):</p>
<p>        """è¿½åŠ æƒ…å ±ã®è¨ˆç®—"""</p>
<p>        pass</p>
<p></code></pre></p>

<p><h3>è¡Œå‹•ç©ºé–“ã¨è¦³æ¸¬ç©ºé–“ã®å®šç¾©</h3></p>

<p>Gymã¯å¤šæ§˜ãªç©ºé–“ã‚¿ã‚¤ãƒ—ã‚’ã‚µãƒãƒ¼ãƒˆï¼š</p>

<p><pre><code class="language-python">from gym import spaces</p>

<p><h1>é›¢æ•£è¡Œå‹•ï¼ˆæ•´æ•° 0, 1, 2, 3ï¼‰</h1></p>
<p>action_space = spaces.Discrete(4)</p>

<p><h1>é€£ç¶šè¡Œå‹•ï¼ˆå®Ÿæ•°ãƒ™ã‚¯ãƒˆãƒ« [-1, 1]^3ï¼‰</h1></p>
<p>action_space = spaces.Box(low=-1, high=1, shape=(3,), dtype=np.float32)</p>

<p><h1>è¾æ›¸å½¢å¼ï¼ˆè¤‡æ•°ã®å…¥åŠ›ï¼‰</h1></p>
<p>observation_space = spaces.Dict({</p>
<p>    'composition': spaces.Box(low=0, high=1, shape=(10,), dtype=np.float32),</p>
<p>    'temperature': spaces.Box(low=0, high=1000, shape=(1,), dtype=np.float32),</p>
<p>    'pressure': spaces.Box(low=0, high=10, shape=(1,), dtype=np.float32)</p>
<p>})</p>

<p><h1>ã‚¿ãƒ—ãƒ«å½¢å¼</h1></p>
<p>action_space = spaces.Tuple((</p>
<p>    spaces.Discrete(5),      <h1>å…ƒç´ é¸æŠ</h1></p>
<p>    spaces.Box(low=0, high=1, shape=(1,))  <h1>çµ„æˆæ¯”ç‡</h1></p>
<p>))</p>

<p><h1>ãƒãƒ«ãƒãƒã‚¤ãƒŠãƒªï¼ˆè¤‡æ•°ã®ãƒã‚¤ãƒŠãƒªé¸æŠï¼‰</h1></p>
<p>action_space = spaces.MultiBinary(10)  <h1>10å€‹ã®å…ƒç´ ã‚’ON/OFF</h1></p>
<p></code></pre></p>

<p>---</p>

<p><h2>3.2 ææ–™è¨˜è¿°å­ã¨çŠ¶æ…‹ç©ºé–“ã®è¨­è¨ˆ</h2></p>

<p><h3>ææ–™è¨˜è¿°å­ã®é¸æŠ</h3></p>

<p>çŠ¶æ…‹ç©ºé–“ã¯ã€<strong>ææ–™ã®ç‰¹æ€§ã‚’æ•°å€¤ãƒ™ã‚¯ãƒˆãƒ«ã§è¡¨ç¾</strong>ã—ãŸã‚‚ã®ã§ã™ã€‚åŠ¹æœçš„ãªè¨˜è¿°å­ã®é¸æŠãŒé‡è¦ã§ã™ã€‚</p>

<p><h4>1. çµ„æˆãƒ™ãƒ¼ã‚¹è¨˜è¿°å­</h4></p>

<p><strong>å…ƒç´ å‰²åˆ</strong>:</p>
<p><pre><code class="language-python"><h1>ä¾‹: Li2MnO3ã®çµ„æˆãƒ™ã‚¯ãƒˆãƒ«</h1></p>
<p>composition = {</p>
<p>    'Li': 2/6,   <h1>33.3%</h1></p>
<p>    'Mn': 1/6,   <h1>16.7%</h1></p>
<p>    'O': 3/6     <h1>50.0%</h1></p>
<p>}</p>

<p><h1>å‘¨æœŸè¡¨å…¨ä½“ã®ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆ118æ¬¡å…ƒï¼‰</h1></p>
<p>state = np.zeros(118)</p>
<p>state[2] = 0.333   <h1>Li (åŸå­ç•ªå·3)</h1></p>
<p>state[24] = 0.167  <h1>Mn (åŸå­ç•ªå·25)</h1></p>
<p>state[7] = 0.500   <h1>O (åŸå­ç•ªå·8)</h1></p>
<p></code></pre></p>

<p><strong>Magpieè¨˜è¿°å­</strong>ï¼ˆWard et al., 2016ï¼‰:</p>
<p><pre><code class="language-python">from matminer.featurizers.composition import ElementProperty</p>

<p>featurizer = ElementProperty.from_preset("magpie")</p>
<p><h1>çµ„æˆã‹ã‚‰132æ¬¡å…ƒã®è¨˜è¿°å­ã‚’ç”Ÿæˆ</h1></p>
<p><h1>- å¹³å‡åŸå­ç•ªå·ã€å¹³å‡é›»æ°—é™°æ€§åº¦ã€å¹³å‡ã‚¤ã‚ªãƒ³åŠå¾„ãªã©</h1></p>
<p>composition = "Li2MnO3"</p>
<p>features = featurizer.featurize(Composition(composition))</p>
<p></code></pre></p>

<p><h4>2. æ§‹é€ ãƒ™ãƒ¼ã‚¹è¨˜è¿°å­</h4></p>

<p><strong>æ ¼å­å®šæ•°</strong>:</p>
<p><pre><code class="language-python"><h1>çµæ™¶æ ¼å­</h1></p>
<p>state = np.array([</p>
<p>    a, b, c,           <h1>æ ¼å­å®šæ•°</h1></p>
<p>    alpha, beta, gamma <h1>è§’åº¦</h1></p>
<p>])</p>
<p></code></pre></p>

<p><strong>Smooth Overlap of Atomic Positions (SOAP)</strong>:</p>
<p><pre><code class="language-python">from dscribe.descriptors import SOAP</p>
<p>from ase import Atoms</p>

<p><h1>åŸå­æ§‹é€ ã‹ã‚‰è¨˜è¿°å­ç”Ÿæˆ</h1></p>
<p>atoms = Atoms('H2O', positions=[[0, 0, 0], [0, 0, 1], [0, 1, 0]])</p>
<p>soap = SOAP(species=['H', 'O'], rcut=5.0, nmax=8, lmax=6)</p>
<p>state = soap.create(atoms)  <h1>é«˜æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«</h1></p>
<p></code></pre></p>

<p><h4>3. ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</h4></p>

<p><strong>åˆæˆæ¡ä»¶</strong>:</p>
<p><pre><code class="language-python"><h1>åˆæˆãƒ—ãƒ­ã‚»ã‚¹ã®çŠ¶æ…‹</h1></p>
<p>state = np.array([</p>
<p>    temperature,      <h1>æ¸©åº¦ [K]</h1></p>
<p>    pressure,         <h1>åœ§åŠ› [Pa]</h1></p>
<p>    time,             <h1>æ™‚é–“ [s]</h1></p>
<p>    heating_rate,     <h1>æ˜‡æ¸©é€Ÿåº¦ [K/min]</h1></p>
<p>    atmosphere_O2     <h1>é…¸ç´ åˆ†åœ§ [Pa]</h1></p>
<p>])</p>
<p></code></pre></p>

<p><h3>å®Ÿä¾‹: ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ¢ç´¢ç’°å¢ƒ</h3></p>

<p><pre><code class="language-python">from pymatgen.core import Composition</p>
<p>from matminer.featurizers.composition import ElementProperty</p>

<p>class BandgapDiscoveryEnv(gym.Env):</p>
<p>    """ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æœ€é©åŒ–ç’°å¢ƒ</p>

<p>    ç›®æ¨™: ç‰¹å®šã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ï¼ˆä¾‹: 3.0 eVï¼‰ã‚’æŒã¤ææ–™ã‚’ç™ºè¦‹</p>
<p>    """</p>

<p>    def __init__(self, target_bandgap=3.0, element_pool=None):</p>
<p>        super(BandgapDiscoveryEnv, self).__init__()</p>

<p>        self.target_bandgap = target_bandgap</p>

<p>        <h1>ä½¿ç”¨å¯èƒ½ãªå…ƒç´ ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: å…¸å‹çš„ãªåŠå°ä½“å…ƒç´ ï¼‰</h1></p>
<p>        if element_pool is None:</p>
<p>            self.element_pool = ['Ti', 'Zr', 'Hf', 'V', 'Nb', 'Ta', 'Cr', 'Mo', 'W',</p>
<p>                                  'Mn', 'Fe', 'Co', 'Ni', 'Cu', 'Zn', 'Ga', 'Ge',</p>
<p>                                  'As', 'Se', 'Sr', 'Y', 'In', 'Sn', 'Sb', 'Te', 'O', 'S', 'N']</p>
<p>        else:</p>
<p>            self.element_pool = element_pool</p>

<p>        self.n_elements = len(self.element_pool)</p>

<p>        <h1>è¡Œå‹•ç©ºé–“: 3å…ƒç´ ã‚’é¸æŠ + å„å…ƒç´ ã®æ¯”ç‡</h1></p>
<p>        <h1>ç°¡ç•¥åŒ–: 3å…ƒç´ ã®é›¢æ•£é¸æŠï¼ˆçµ„ã¿åˆã‚ã›ï¼‰</h1></p>
<p>        self.action_space = gym.spaces.MultiDiscrete([self.n_elements] * 3)</p>

<p>        <h1>çŠ¶æ…‹ç©ºé–“: Magpieè¨˜è¿°å­ï¼ˆ132æ¬¡å…ƒï¼‰</h1></p>
<p>        self.featurizer = ElementProperty.from_preset("magpie")</p>
<p>        self.observation_space = gym.spaces.Box(</p>
<p>            low=-10, high=10, shape=(132,), dtype=np.float32</p>
<p>        )</p>

<p>        <h1>å±¥æ­´ï¼ˆè©¦ã—ãŸçµ„æˆï¼‰</h1></p>
<p>        self.history = []</p>
<p>        self.current_composition = None</p>

<p>    def reset(self):</p>
<p>        """ãƒ©ãƒ³ãƒ€ãƒ ãªåˆæœŸçµ„æˆ"""</p>
<p>        self.history = []</p>
<p>        action = self.action_space.sample()</p>
<p>        self.current_composition = self._action_to_composition(action)</p>
<p>        return self._get_state()</p>

<p>    def step(self, action):</p>
<p>        """æ–°ã—ã„ææ–™çµ„æˆã‚’è©¦ã™"""</p>
<p>        self.current_composition = self._action_to_composition(action)</p>

<p>        <h1>çŠ¶æ…‹ï¼ˆè¨˜è¿°å­ï¼‰</h1></p>
<p>        state = self._get_state()</p>

<p>        <h1>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’äºˆæ¸¬ï¼ˆã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒ¢ãƒ‡ãƒ« or DFTï¼‰</h1></p>
<p>        predicted_bandgap = self._predict_bandgap(self.current_composition)</p>

<p>        <h1>å ±é…¬: ç›®æ¨™ã¨ã®å·®ã®è² ã®å€¤</h1></p>
<p>        error = abs(predicted_bandgap - self.target_bandgap)</p>
<p>        reward = -error</p>

<p>        <h1>ãƒœãƒ¼ãƒŠã‚¹å ±é…¬ï¼ˆç›®æ¨™ã«è¿‘ã„å ´åˆï¼‰</h1></p>
<p>        if error < 0.1:</p>
<p>            reward += 10.0  <h1>éå¸¸ã«è¿‘ã„</h1></p>

<p>        <h1>å±¥æ­´ã«è¿½åŠ </h1></p>
<p>        self.history.append({</p>
<p>            'composition': self.current_composition,</p>
<p>            'bandgap': predicted_bandgap,</p>
<p>            'reward': reward</p>
<p>        })</p>

<p>        <h1>çµ‚äº†æ¡ä»¶: ç›®æ¨™ã«åˆ°é” or æœ€å¤§ã‚¹ãƒ†ãƒƒãƒ—æ•°</h1></p>
<p>        done = error < 0.05 or len(self.history) >= 100</p>

<p>        info = {</p>
<p>            'composition': self.current_composition,</p>
<p>            'predicted_bandgap': predicted_bandgap,</p>
<p>            'error': error</p>
<p>        }</p>

<p>        return state, reward, done, info</p>

<p>    def _action_to_composition(self, action):</p>
<p>        """è¡Œå‹•ã‚’çµ„æˆæ–‡å­—åˆ—ã«å¤‰æ›</p>

<p>        Args:</p>
<p>            action: [elem1_idx, elem2_idx, elem3_idx]</p>

<p>        Returns:</p>
<p>            çµ„æˆæ–‡å­—åˆ—ï¼ˆä¾‹: "TiO2"ï¼‰</p>
<p>        """</p>
<p>        elements = [self.element_pool[idx] for idx in action]</p>

<p>        <h1>é‡è¤‡é™¤å»</h1></p>
<p>        unique_elements = list(set(elements))</p>

<p>        <h1>ç°¡ç•¥åŒ–: ç­‰é‡æ··åˆ</h1></p>
<p>        if len(unique_elements) == 1:</p>
<p>            comp_str = unique_elements[0]</p>
<p>        elif len(unique_elements) == 2:</p>
<p>            comp_str = f"{unique_elements[0]}{unique_elements[1]}"</p>
<p>        else:</p>
<p>            comp_str = f"{unique_elements[0]}{unique_elements[1]}{unique_elements[2]}"</p>

<p>        return comp_str</p>

<p>    def _get_state(self):</p>
<p>        """ç¾åœ¨ã®çµ„æˆã‹ã‚‰è¨˜è¿°å­ã‚’ç”Ÿæˆ"""</p>
<p>        try:</p>
<p>            comp = Composition(self.current_composition)</p>
<p>            features = self.featurizer.featurize(comp)</p>
<p>            return np.array(features, dtype=np.float32)</p>
<p>        except:</p>
<p>            <h1>ç„¡åŠ¹ãªçµ„æˆã®å ´åˆã€ã‚¼ãƒ­ãƒ™ã‚¯ãƒˆãƒ«</h1></p>
<p>            return np.zeros(132, dtype=np.float32)</p>

<p>    def _predict_bandgap(self, composition):</p>
<p>        """ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’äºˆæ¸¬</p>

<p>        å®Ÿéš›ã«ã¯:</p>
<p>        - æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ï¼ˆäº‹å‰å­¦ç¿’æ¸ˆã¿ï¼‰</p>
<p>        - DFTè¨ˆç®—ï¼ˆpymatgen + VASPï¼‰</p>
<p>        - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢ï¼ˆMaterials Projectï¼‰</p>

<p>        ã“ã“ã§ã¯ç°¡æ˜“çš„ãªãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹</p>
<p>        """</p>
<p>        try:</p>
<p>            comp = Composition(composition)</p>

<p>            <h1>ç°¡æ˜“ãƒ«ãƒ¼ãƒ«: é…¸ç´ ã‚’å«ã‚€åŒ–åˆç‰©ã¯ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ãŒå¤§ãã„å‚¾å‘</h1></p>
<p>            if 'O' in comp:</p>
<p>                base_gap = 2.5</p>
<p>            elif 'S' in comp:</p>
<p>                base_gap = 1.8</p>
<p>            elif 'N' in comp:</p>
<p>                base_gap = 2.0</p>
<p>            else:</p>
<p>                base_gap = 1.0</p>

<p>            <h1>é‡‘å±å…ƒç´ ã®å½±éŸ¿</h1></p>
<p>            metals = ['Ti', 'Zr', 'Hf', 'V', 'Nb', 'Ta']</p>
<p>            for metal in metals:</p>
<p>                if metal in comp:</p>
<p>                    base_gap += 0.5</p>

<p>            <h1>ãƒ©ãƒ³ãƒ€ãƒ ãƒã‚¤ã‚ºï¼ˆå®Ÿé¨“èª¤å·®ï¼‰</h1></p>
<p>            noise = np.random.normal(0, 0.2)</p>
<p>            return max(0, base_gap + noise)</p>

<p>        except:</p>
<p>            return 0.0</p>

<p>    def render(self, mode='human'):</p>
<p>        print(f"Current composition: {self.current_composition}")</p>
<p>        if self.history:</p>
<p>            last = self.history[-1]</p>
<p>            print(f"Predicted bandgap: {last['bandgap']:.2f} eV")</p>
<p>            print(f"Target: {self.target_bandgap:.2f} eV")</p>
<p>            print(f"Reward: {last['reward']:.2f}")</p>


<p><h1>ç’°å¢ƒã®ãƒ†ã‚¹ãƒˆ</h1></p>
<p>env = BandgapDiscoveryEnv(target_bandgap=3.0)</p>

<p>state = env.reset()</p>
<p>print(f"åˆæœŸçŠ¶æ…‹: {state.shape}")</p>

<p>for step in range(10):</p>
<p>    action = env.action_space.sample()</p>
<p>    state, reward, done, info = env.step(action)</p>

<p>    print(f"\nStep {step+1}:")</p>
<p>    print(f"  çµ„æˆ: {info['composition']}")</p>
<p>    print(f"  äºˆæ¸¬ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: {info['predicted_bandgap']:.2f} eV")</p>
<p>    print(f"  å ±é…¬: {reward:.2f}")</p>

<p>    if done:</p>
<p>        print("ç›®æ¨™åˆ°é”ï¼")</p>
<p>        break</p>
<p></code></pre></p>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<p><pre><code class="language-">åˆæœŸçŠ¶æ…‹: (132,)</p>

<p>Step 1:</p>
<p>  çµ„æˆ: TiO</p>
<p>  äºˆæ¸¬ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: 3.12 eV</p>
<p>  å ±é…¬: -0.12</p>

<p>Step 2:</p>
<p>  çµ„æˆ: ZrO</p>
<p>  äºˆæ¸¬ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: 2.95 eV</p>
<p>  å ±é…¬: -0.05</p>
<p>ç›®æ¨™åˆ°é”ï¼</p>
<p></code></pre></p>

<p>---</p>

<p><h2>3.3 åŠ¹æœçš„ãªå ±é…¬é–¢æ•°ã®è¨­è¨ˆ</h2></p>

<p><h3>å ±é…¬è¨­è¨ˆã®åŸå‰‡</h3></p>

<p>å ±é…¬é–¢æ•°ã¯ã€<strong>ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒä½•ã‚’æœ€é©åŒ–ã™ã¹ãã‹ã‚’å®šç¾©</strong>ã—ã¾ã™ã€‚ä¸é©åˆ‡ãªå ±é…¬ã¯ã€æœ›ã¾ãªã„è¡Œå‹•ã‚„å­¦ç¿’å¤±æ•—ã‚’å¼•ãèµ·ã“ã—ã¾ã™ã€‚</p>

<p><h4>åŸå‰‡1: æ˜ç¢ºãªç›®æ¨™</h4></p>

<p><strong>æ‚ªã„ä¾‹</strong>:</p>
<p><pre><code class="language-python"><h1>æ›–æ˜§ãªå ±é…¬</h1></p>
<p>reward = 1 if 'good_material' else 0  <h1>"good"ã®å®šç¾©ãŒä¸æ˜ç¢º</h1></p>
<p></code></pre></p>

<p><strong>è‰¯ã„ä¾‹</strong>:</p>
<p><pre><code class="language-python"><h1>æ˜ç¢ºãªç›®æ¨™ï¼ˆãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ï¼‰</h1></p>
<p>target = 3.0</p>
<p>predicted = 2.8</p>
<p>reward = -abs(predicted - target)  <h1>ç›®æ¨™ã¨ã®è·é›¢</h1></p>
<p></code></pre></p>

<p><h4>åŸå‰‡2: ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°</h4></p>

<p>å ±é…¬ã®ç¯„å›²ã‚’é©åˆ‡ã«è¨­å®šï¼š</p>

<p><strong>æ‚ªã„ä¾‹</strong>:</p>
<p><pre><code class="language-python"><h1>å ±é…¬ãŒæ¥µç«¯ã«å¤§ãã„</h1></p>
<p>reward = 1e10 if success else -1e10  <h1>å­¦ç¿’ãŒä¸å®‰å®š</h1></p>
<p></code></pre></p>

<p><strong>è‰¯ã„ä¾‹</strong>:</p>
<p><pre><code class="language-python"><h1>[-1, 1]ç¨‹åº¦ã«æ­£è¦åŒ–</h1></p>
<p>reward = -error / max_error  <h1>error âˆˆ [0, max_error]</h1></p>
<p></code></pre></p>

<p><h4>åŸå‰‡3: ã‚·ã‚§ã‚¤ãƒ”ãƒ³ã‚°ï¼ˆä¸­é–“å ±é…¬ï¼‰</h4></p>

<p>ç–å ±é…¬ã‚’å¯†å ±é…¬ã«å¤‰æ›ï¼š</p>

<p><strong>ç–å ±é…¬ï¼ˆå­¦ç¿’ãŒå›°é›£ï¼‰</strong>:</p>
<p><pre><code class="language-python">reward = 1.0 if distance < 0.1 else 0.0</p>
<p></code></pre></p>

<p><strong>å¯†å ±é…¬ï¼ˆå­¦ç¿’ãŒå®¹æ˜“ï¼‰</strong>:</p>
<p><pre><code class="language-python"><h1>è·é›¢ã«å¿œã˜ãŸé€£ç¶šçš„ãªå ±é…¬</h1></p>
<p>reward = -distance</p>

<p><h1>ã•ã‚‰ã«éšå±¤çš„ãªå ±é…¬</h1></p>
<p>if distance < 0.5:</p>
<p>    reward += 5.0  <h1>è¿‘ã„</h1></p>
<p>if distance < 0.1:</p>
<p>    reward += 10.0  <h1>éå¸¸ã«è¿‘ã„</h1></p>
<p></code></pre></p>

<p><h4>åŸå‰‡4: å¤šç›®çš„æœ€é©åŒ–</h4></p>

<p>è¤‡æ•°ã®ç›®æ¨™ã‚’é‡ã¿ä»˜ã‘ï¼š</p>

<p><pre><code class="language-python"><h1>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã¨å®‰å®šæ€§ã®ä¸¡æ–¹ã‚’æœ€é©åŒ–</h1></p>
<p>bandgap_error = abs(predicted_bandgap - target_bandgap)</p>
<p>stability = formation_energy  <h1>è² ã®å€¤ãŒå®‰å®š</h1></p>

<p><h1>é‡ã¿ä»˜ãå ±é…¬</h1></p>
<p>w1, w2 = 0.7, 0.3</p>
<p>reward = -w1 <em> bandgap_error - w2 </em> max(0, stability)</p>
<p></code></pre></p>

<p><h3>å ±é…¬è¨­è¨ˆã®å®Ÿä¾‹</h3></p>

<p><h4>ä¾‹1: è§¦åª’æ´»æ€§æœ€å¤§åŒ–</h4></p>

<p><pre><code class="language-python">class CatalystOptimizationEnv(gym.Env):</p>
<p>    """è§¦åª’æ´»æ€§ã‚’æœ€å¤§åŒ–ã™ã‚‹ç’°å¢ƒ"""</p>

<p>    def _compute_reward(self, activity, selectivity, stability):</p>
<p>        """å¤šç›®çš„å ±é…¬</p>

<p>        Args:</p>
<p>            activity: è§¦åª’æ´»æ€§ï¼ˆé«˜ã„ã»ã©è‰¯ã„ï¼‰</p>
<p>            selectivity: é¸æŠæ€§ï¼ˆç›®çš„ç”Ÿæˆç‰©ã¸ã®é¸æŠæ€§ã€é«˜ã„ã»ã©è‰¯ã„ï¼‰</p>
<p>            stability: å®‰å®šæ€§ï¼ˆè² ã®å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã€ä½ã„ã»ã©å®‰å®šï¼‰</p>

<p>        Returns:</p>
<p>            ç·åˆå ±é…¬</p>
<p>        """</p>
<p>        <h1>å„æŒ‡æ¨™ã‚’æ­£è¦åŒ– [0, 1]</h1></p>
<p>        activity_norm = activity / 100.0  <h1>ä»®ã«æœ€å¤§100</h1></p>
<p>        selectivity_norm = selectivity  <h1>æ—¢ã« [0, 1]</h1></p>
<p>        stability_norm = -stability / 5.0  <h1>ä»®ã«æœ€å¤§-5 eV</h1></p>

<p>        <h1>é‡ã¿ä»˜ãå’Œï¼ˆæ´»æ€§ã‚’é‡è¦–ï¼‰</h1></p>
<p>        weights = {'activity': 0.5, 'selectivity': 0.3, 'stability': 0.2}</p>
<p>        reward = (weights['activity'] * activity_norm +</p>
<p>                  weights['selectivity'] * selectivity_norm +</p>
<p>                  weights['stability'] * stability_norm)</p>

<p>        <h1>ãƒšãƒŠãƒ«ãƒ†ã‚£: ä¸å®‰å®šãªææ–™</h1></p>
<p>        if stability > 0:  <h1>æ­£ã®å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆä¸å®‰å®šï¼‰</h1></p>
<p>            reward -= 1.0</p>

<p>        return reward</p>
<p></code></pre></p>

<p><h4>ä¾‹2: åˆæˆã‚³ã‚¹ãƒˆåˆ¶ç´„</h4></p>

<p><pre><code class="language-python">def reward_with_cost_constraint(self, performance, synthesis_cost, max_cost=1000):</p>
<p>    """ã‚³ã‚¹ãƒˆåˆ¶ç´„ä»˜ãå ±é…¬</p>

<p>    Args:</p>
<p>        performance: ææ–™æ€§èƒ½</p>
<p>        synthesis_cost: åˆæˆã‚³ã‚¹ãƒˆ [USD/kg]</p>
<p>        max_cost: ã‚³ã‚¹ãƒˆä¸Šé™</p>

<p>    Returns:</p>
<p>        å ±é…¬</p>
<p>    """</p>
<p>    <h1>æ€§èƒ½ã«åŸºã¥ãåŸºæœ¬å ±é…¬</h1></p>
<p>    base_reward = performance</p>

<p>    <h1>ã‚³ã‚¹ãƒˆåˆ¶ç´„é•åã®ãƒšãƒŠãƒ«ãƒ†ã‚£</h1></p>
<p>    if synthesis_cost > max_cost:</p>
<p>        penalty = (synthesis_cost - max_cost) / max_cost</p>
<p>        base_reward -= 10.0 * penalty</p>

<p>    <h1>ã‚³ã‚¹ãƒˆãŒä½ã„ã»ã©ãƒœãƒ¼ãƒŠã‚¹</h1></p>
<p>    cost_bonus = max(0, (max_cost - synthesis_cost) / max_cost)</p>
<p>    base_reward += 2.0 * cost_bonus</p>

<p>    return base_reward</p>
<p></code></pre></p>

<p>---</p>

<p><h2>3.4 DFTè¨ˆç®—ã¨ã®çµ±åˆ</h2></p>

<p><h3>Materials Projectã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—</h3></p>

<p>å®Ÿéš›ã®ææ–™ç‰¹æ€§ã‚’å–å¾—ã—ã€å ±é…¬ã«ä½¿ç”¨ï¼š</p>

<p><pre><code class="language-python">from mp_api.client import MPRester</p>
<p>import os</p>

<p>class MPIntegratedEnv(gym.Env):</p>
<p>    """Materials Projectçµ±åˆç’°å¢ƒ"""</p>

<p>    def __init__(self, mp_api_key=None):</p>
<p>        super(MPIntegratedEnv, self).__init__()</p>

<p>        <h1>Materials Project APIã‚­ãƒ¼</h1></p>
<p>        if mp_api_key is None:</p>
<p>            mp_api_key = os.getenv("MP_API_KEY")</p>

<p>        self.mpr = MPRester(mp_api_key)</p>

<p>        <h1>... (ç’°å¢ƒè¨­å®š) ...</h1></p>

<p>    def _get_bandgap_from_mp(self, composition):</p>
<p>        """Materials Projectã‹ã‚‰ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’å–å¾—</p>

<p>        Args:</p>
<p>            composition: çµ„æˆï¼ˆä¾‹: "TiO2"ï¼‰</p>

<p>        Returns:</p>
<p>            ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— [eV]ï¼ˆãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯Noneï¼‰</p>
<p>        """</p>
<p>        try:</p>
<p>            <h1>çµ„æˆã§æ¤œç´¢</h1></p>
<p>            docs = self.mpr.materials.summary.search(</p>
<p>                formula=composition,</p>
<p>                fields=["material_id", "band_gap", "formation_energy_per_atom"]</p>
<p>            )</p>

<p>            if docs:</p>
<p>                <h1>æœ€ã‚‚å®‰å®šãªæ§‹é€ ï¼ˆå½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒæœ€å°ï¼‰ã‚’é¸æŠ</h1></p>
<p>                stable_doc = min(docs, key=lambda x: x.formation_energy_per_atom)</p>
<p>                return stable_doc.band_gap</p>
<p>            else:</p>
<p>                return None</p>

<p>        except Exception as e:</p>
<p>            print(f"Materials Projectæ¤œç´¢ã‚¨ãƒ©ãƒ¼: {e}")</p>
<p>            return None</p>

<p>    def step(self, action):</p>
<p>        composition = self._action_to_composition(action)</p>

<p>        <h1>Materials Projectã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—</h1></p>
<p>        bandgap = self._get_bandgap_from_mp(composition)</p>

<p>        if bandgap is not None:</p>
<p>            <h1>å®Ÿãƒ‡ãƒ¼ã‚¿ã§å ±é…¬è¨ˆç®—</h1></p>
<p>            error = abs(bandgap - self.target_bandgap)</p>
<p>            reward = -error</p>
<p>        else:</p>
<p>            <h1>ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã€äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ or ãƒšãƒŠãƒ«ãƒ†ã‚£</h1></p>
<p>            reward = -10.0  <h1>æœªçŸ¥ã®ææ–™ã¸ã®ãƒšãƒŠãƒ«ãƒ†ã‚£</h1></p>

<p>        <h1>... (çŠ¶æ…‹ã€çµ‚äº†æ¡ä»¶ãªã©) ...</h1></p>

<p>        return state, reward, done, info</p>
<p></code></pre></p>

<p><strong>æ³¨æ„</strong>: Materials Projectã¸ã®å¤§é‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯é¿ã‘ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ´»ç”¨ã—ã¦ãã ã•ã„ã€‚</p>

<p><h3>ASEã«ã‚ˆã‚‹DFTè¨ˆç®—çµ±åˆï¼ˆé«˜åº¦ï¼‰</h3></p>

<p><pre><code class="language-python">from ase import Atoms</p>
<p>from ase.calculators.vasp import Vasp</p>
<p>from ase.optimize import BFGS</p>

<p>class DFTIntegratedEnv(gym.Env):</p>
<p>    """DFTè¨ˆç®—çµ±åˆç’°å¢ƒï¼ˆè¨ˆç®—ã‚³ã‚¹ãƒˆå¤§ï¼‰"""</p>

<p>    def _calculate_bandgap_dft(self, composition):</p>
<p>        """DFTè¨ˆç®—ã§ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’å–å¾—</p>

<p>        è­¦å‘Š: éå¸¸ã«æ™‚é–“ãŒã‹ã‹ã‚‹ï¼ˆ1ææ–™ã‚ãŸã‚Šæ•°æ™‚é–“ã€œæ•°æ—¥ï¼‰</p>
<p>        å®Ÿç”¨çš„ã«ã¯äº‹å‰è¨ˆç®—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ç”¨</p>

<p>        Args:</p>
<p>            composition: çµ„æˆ</p>

<p>        Returns:</p>
<p>            ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— [eV]</p>
<p>        """</p>
<p>        <h1>çµæ™¶æ§‹é€ ã‚’ç”Ÿæˆï¼ˆpymatgenãªã©ã§ï¼‰</h1></p>
<p>        structure = self._generate_structure(composition)</p>

<p>        <h1>ASE Atomsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›</h1></p>
<p>        atoms = Atoms(</p>
<p>            symbols=structure.species,</p>
<p>            positions=structure.cart_coords,</p>
<p>            cell=structure.lattice.matrix,</p>
<p>            pbc=True</p>
<p>        )</p>

<p>        <h1>VASPè¨ˆç®—è¨­å®š</h1></p>
<p>        calc = Vasp(</p>
<p>            xc='PBE',</p>
<p>            encut=520,</p>
<p>            kpts=(4, 4, 4),</p>
<p>            ismear=0,</p>
<p>            sigma=0.05,</p>
<p>            directory='vasp_calc'</p>
<p>        )</p>
<p>        atoms.calc = calc</p>

<p>        <h1>æ§‹é€ æœ€é©åŒ–</h1></p>
<p>        opt = BFGS(atoms)</p>
<p>        opt.run(fmax=0.05)</p>

<p>        <h1>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—è¨ˆç®—</h1></p>
<p>        <h1>... (VASPã®OUTCARè§£æ) ...</h1></p>

<p>        return bandgap</p>

<p>    def step(self, action):</p>
<p>        <h1>DFTè¨ˆç®—ã¯æ™‚é–“ãŒã‹ã‹ã‚‹ãŸã‚ã€</h1></p>
<p>        <h1>å®Ÿéš›ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå·¥å¤«ãŒå¿…è¦:</h1></p>
<p>        <h1>1. äº‹å‰è¨ˆç®—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ§‹ç¯‰</h1></p>
<p>        <h1>2. ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒ¢ãƒ‡ãƒ«ã§é«˜é€Ÿäºˆæ¸¬</h1></p>
<p>        <h1>3. ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã§é‡è¦ãªææ–™ã®ã¿DFTè¨ˆç®—</h1></p>
<p>        pass</p>
<p></code></pre></p>

<p><strong>å®Ÿç”¨çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</strong>:</p>
<ol>
<li><strong>äº‹å‰å­¦ç¿’</strong>: Materials Projectãªã©ã®ãƒ‡ãƒ¼ã‚¿ã§ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´</li>
<li><strong>å¼·åŒ–å­¦ç¿’</strong>: ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒ¢ãƒ‡ãƒ«ã§é«˜é€Ÿæ¢ç´¢</li>
<li><strong>æ¤œè¨¼</strong>: æœ‰æœ›ãªææ–™ã®ã¿DFTè¨ˆç®—ã§ç²¾å¯†è©•ä¾¡</li>
</ol>

<p>---</p>

<p><h2>3.5 å®Ÿé¨“è£…ç½®ã¨ã®çµ±åˆï¼ˆã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãƒ«ãƒ¼ãƒ—ï¼‰</h2></p>

<p><h3>REST APIã«ã‚ˆã‚‹è‡ªå‹•å®Ÿé¨“è£…ç½®åˆ¶å¾¡</h3></p>

<p><pre><code class="language-python">import requests</p>

<p>class RoboticLabEnv(gym.Env):</p>
<p>    """ãƒ­ãƒœãƒƒãƒˆå®Ÿé¨“è£…ç½®çµ±åˆç’°å¢ƒ"""</p>

<p>    def __init__(self, api_endpoint="http://lab-robot.example.com/api"):</p>
<p>        super(RoboticLabEnv, self).__init__()</p>
<p>        self.api_endpoint = api_endpoint</p>

<p>        <h1>... (ç’°å¢ƒè¨­å®š) ...</h1></p>

<p>    def _synthesize_and_measure(self, composition, temperature, time):</p>
<p>        """ææ–™ã‚’åˆæˆã—ã€ç‰¹æ€§ã‚’æ¸¬å®š</p>

<p>        Args:</p>
<p>            composition: çµ„æˆ</p>
<p>            temperature: åˆæˆæ¸©åº¦ [K]</p>
<p>            time: åˆæˆæ™‚é–“ [min]</p>

<p>        Returns:</p>
<p>            æ¸¬å®šçµæœï¼ˆãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã€XRDãƒ‘ã‚¿ãƒ¼ãƒ³ãªã©ï¼‰</p>
<p>        """</p>
<p>        <h1>ãƒ­ãƒœãƒƒãƒˆã«åˆæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ</h1></p>
<p>        payload = {</p>
<p>            'composition': composition,</p>
<p>            'temperature': temperature,</p>
<p>            'time': time,</p>
<p>            'measurement': ['bandgap', 'xrd']</p>
<p>        }</p>

<p>        response = requests.post(</p>
<p>            f"{self.api_endpoint}/synthesize",</p>
<p>            json=payload,</p>
<p>            headers={'Authorization': 'Bearer YOUR_API_KEY'}</p>
<p>        )</p>

<p>        if response.status_code == 200:</p>
<p>            result = response.json()</p>
<p>            return result['bandgap'], result['xrd_pattern']</p>
<p>        else:</p>
<p>            raise Exception(f"å®Ÿé¨“å¤±æ•—: {response.text}")</p>

<p>    def step(self, action):</p>
<p>        """è¡Œå‹• = åˆæˆæ¡ä»¶"""</p>
<p>        composition, temperature, time = self._decode_action(action)</p>

<p>        <h1>å®Ÿé¨“å®Ÿè¡Œï¼ˆæ•°åˆ†ã€œæ•°æ™‚é–“ï¼‰</h1></p>
<p>        bandgap, xrd = self._synthesize_and_measure(composition, temperature, time)</p>

<p>        <h1>å ±é…¬è¨ˆç®—</h1></p>
<p>        reward = -abs(bandgap - self.target_bandgap)</p>

<p>        <h1>çŠ¶æ…‹æ›´æ–°ï¼ˆå®Ÿé¨“å±¥æ­´ã‚’å«ã‚€ï¼‰</h1></p>
<p>        state = self._update_state(composition, temperature, time, bandgap, xrd)</p>

<p>        done = len(self.history) >= self.max_experiments</p>

<p>        return state, reward, done, {'bandgap': bandgap}</p>
<p></code></pre></p>

<p><strong>èª²é¡Œ</strong>:</p>
<ul>
<li><strong>å®Ÿé¨“ã‚³ã‚¹ãƒˆ</strong>: 1å›ã‚ãŸã‚Šæ•°åƒå††ã€œæ•°ä¸‡å††</li>
<li><strong>æ™‚é–“</strong>: åˆæˆãƒ»æ¸¬å®šã«æ•°æ™‚é–“ã€œæ•°æ—¥</li>
<li><strong>å®‰å…¨æ€§</strong>: ãƒ­ãƒœãƒƒãƒˆã®èª¤ä½œå‹•ã€å±é™ºç‰©è³ªã®æ‰±ã„</li>
</ul>

<p><strong>è§£æ±ºç­–</strong>:</p>
<ul>
<li><strong>ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å…ˆè¡Œ</strong>: ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒ¢ãƒ‡ãƒ«ã§äº‹å‰æ¢ç´¢</li>
<li><strong>ãƒ™ã‚¤ã‚ºæœ€é©åŒ–ä½µç”¨</strong>: åŠ¹ç‡çš„ãªå®Ÿé¨“ç‚¹é¸æŠ</li>
<li><strong>ãƒãƒƒãƒå®Ÿé¨“</strong>: ä¸¦åˆ—ã§è¤‡æ•°ææ–™ã‚’åˆæˆ</li>
</ul>

<p>---</p>

<p><h2>æ¼”ç¿’å•é¡Œ</h2></p>

<p><h3>å•é¡Œ1 (é›£æ˜“åº¦: easy)</h3></p>

<p>ä»¥ä¸‹ã®2ã¤ã®å ±é…¬é–¢æ•°ã®é•ã„ã‚’èª¬æ˜ã—ã€ã©ã¡ã‚‰ãŒå­¦ç¿’ã—ã‚„ã™ã„ã‹ç†ç”±ã¨ã¨ã‚‚ã«ç­”ãˆã¦ãã ã•ã„ã€‚</p>

<p><strong>å ±é…¬A</strong>:</p>
<p><pre><code class="language-python">reward = 10.0 if abs(bandgap - 3.0) < 0.1 else 0.0</p>
<p></code></pre></p>

<p><strong>å ±é…¬B</strong>:</p>
<p><pre><code class="language-python">reward = -abs(bandgap - 3.0)</p>
<p></code></pre></p>

<p><details></p>
<p><summary>ãƒ’ãƒ³ãƒˆ</summary></p>

<p>å ±é…¬Aã¯ç–å ±é…¬ã€å ±é…¬Bã¯å¯†å ±é…¬ã§ã™ã€‚å­¦ç¿’ã‚·ã‚°ãƒŠãƒ«ã®é »åº¦ã‚’è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

<p></details></p>

<p><details></p>
<p><summary>è§£ç­”ä¾‹</summary></p>

<p><strong>å ±é…¬Aã®ç‰¹å¾´</strong>:</p>
<ul>
<li><strong>ç–å ±é…¬</strong>: ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ãŒ2.9ã€œ3.1 eVã®ç¯„å›²ã«å…¥ã£ãŸã¨ãã®ã¿å ±é…¬10.0ã€ãã‚Œä»¥å¤–ã¯0.0</li>
<li><strong>å­¦ç¿’ãŒå›°é›£</strong>: ã»ã¨ã‚“ã©ã®æ¢ç´¢ã§å ±é…¬0ã€ã©ã®æ–¹å‘ã«é€²ã‚ã°è‰¯ã„ã‹ã‚ã‹ã‚‰ãªã„</li>
<li><strong>æ¢ç´¢ãŒéåŠ¹ç‡</strong>: ãƒ©ãƒ³ãƒ€ãƒ æ¢ç´¢ã«è¿‘ããªã‚‹</li>
</ul>

<p><strong>å ±é…¬Bã®ç‰¹å¾´</strong>:</p>
<ul>
<li><strong>å¯†å ±é…¬</strong>: ã™ã¹ã¦ã®è¡Œå‹•ã§å ±é…¬ãŒå¾—ã‚‰ã‚Œã‚‹ï¼ˆç›®æ¨™ã¨ã®è·é›¢ï¼‰</li>
<li><strong>å­¦ç¿’ãŒå®¹æ˜“</strong>: ç›®æ¨™ã«è¿‘ã¥ãã¨å ±é…¬ãŒæ”¹å–„ã™ã‚‹ãŸã‚ã€å‹¾é…ãŒæ˜ç¢º</li>
<li><strong>æ¢ç´¢ãŒåŠ¹ç‡çš„</strong>: å ±é…¬ã®å¤‰åŒ–ã‹ã‚‰å­¦ç¿’ã§ãã‚‹</li>
</ul>

<p><strong>çµè«–</strong>: <strong>å ±é…¬Bã®æ–¹ãŒå­¦ç¿’ã—ã‚„ã™ã„</strong></p>

<p>ãŸã ã—ã€å ±é…¬Bã«ã¯å±€æ‰€æœ€é©è§£ã«é™¥ã‚Šã‚„ã™ã„ã¨ã„ã†æ¬ ç‚¹ã‚‚ã‚ã‚Šã¾ã™ã€‚å®Ÿç”¨çš„ã«ã¯ã€å ±é…¬Bã‚’ãƒ™ãƒ¼ã‚¹ã«ã€å ±é…¬Aã®ã‚ˆã†ãªãƒœãƒ¼ãƒŠã‚¹ã‚’è¿½åŠ ã™ã‚‹ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰è¨­è¨ˆãŒæœ‰åŠ¹ã§ã™ã€‚</p>

<p><pre><code class="language-python"><h1>ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å ±é…¬</h1></p>
<p>reward = -abs(bandgap - 3.0)  <h1>å¯†å ±é…¬</h1></p>
<p>if abs(bandgap - 3.0) < 0.1:</p>
<p>    reward += 10.0  <h1>ãƒœãƒ¼ãƒŠã‚¹ï¼ˆç–å ±é…¬ã®è¦ç´ ï¼‰</h1></p>
<p></code></pre></p>

<p></details></p>

<p>---</p>

<p><h3>å•é¡Œ2 (é›£æ˜“åº¦: medium)</h3></p>

<p>ææ–™æ¢ç´¢ã«ãŠã„ã¦ã€ä»¥ä¸‹ã®3ã¤ã®çŠ¶æ…‹è¡¨ç¾ã‚’æ¯”è¼ƒã—ã€ãã‚Œãã‚Œã®é•·æ‰€ãƒ»çŸ­æ‰€ã‚’è¿°ã¹ã¦ãã ã•ã„ã€‚</p>

<ol>
<li><strong>çµ„æˆã®ã¿</strong>: <code>["Li2MnO3"]</code>ï¼ˆæ–‡å­—åˆ—ï¼‰</li>
<li><strong>å…ƒç´ å‰²åˆ</strong>: <code>[0.33, 0.17, 0.50]</code>ï¼ˆLi, Mn, Oã®å‰²åˆï¼‰</li>
<li><strong>Magpieè¨˜è¿°å­</strong>: 132æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ï¼ˆå¹³å‡åŸå­ç•ªå·ã€é›»æ°—é™°æ€§åº¦ãªã©ï¼‰</li>
</ol>

<p><details></p>
<p><summary>ãƒ’ãƒ³ãƒˆ</summary></p>

<p>ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯æ•°å€¤å…¥åŠ›ã‚’å¿…è¦ã¨ã—ã¾ã™ã€‚ã¾ãŸã€è¨˜è¿°å­ã®æ¬¡å…ƒæ•°ã¨å­¦ç¿’ã®è¤‡é›‘ã•ã®é–¢ä¿‚ã‚’è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

<p></details></p>

<p><details></p>
<p><summary>è§£ç­”ä¾‹</summary></p>

<p><strong>1. çµ„æˆæ–‡å­—åˆ—ã®é•·æ‰€ãƒ»çŸ­æ‰€</strong>:</p>

<p><strong>é•·æ‰€</strong>:</p>
<ul>
<li>äººé–“ãŒç†è§£ã—ã‚„ã™ã„</li>
<li>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢ã«ç›´æ¥ä½¿ç”¨å¯èƒ½</li>
</ul>

<p><strong>çŸ­æ‰€</strong>:</p>
<ul>
<li>ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ç›´æ¥å…¥åŠ›ã§ããªã„ï¼ˆæ•°å€¤å¤‰æ›ãŒå¿…è¦ï¼‰</li>
<li>é¡ä¼¼çµ„æˆã®é–¢ä¿‚æ€§ã‚’æ‰ãˆã«ãã„ï¼ˆ"TiO2"ã¨"ZrO2"ãŒä¼¼ã¦ã„ã‚‹ã“ã¨ã‚’å­¦ç¿’ã—ã«ãã„ï¼‰</li>
</ul>

<p><strong>2. å…ƒç´ å‰²åˆã®é•·æ‰€ãƒ»çŸ­æ‰€</strong>:</p>

<p><strong>é•·æ‰€</strong>:</p>
<ul>
<li>æ•°å€¤ãƒ™ã‚¯ãƒˆãƒ«ãªã®ã§NNã«å…¥åŠ›å¯èƒ½</li>
<li>ä½æ¬¡å…ƒï¼ˆ3æ¬¡å…ƒãªã©ï¼‰ã§æ‰±ã„ã‚„ã™ã„</li>
</ul>

<p><strong>çŸ­æ‰€</strong>:</p>
<ul>
<li>å…ƒç´ ã®åŒ–å­¦çš„æ€§è³ªã‚’åæ˜ ã—ãªã„ï¼ˆTiã¨ZrãŒä¼¼ã¦ã„ã‚‹ã“ã¨ã‚’è¡¨ç¾ã§ããªã„ï¼‰</li>
<li>å…ƒç´ ã®é †åºãŒä»»æ„ï¼ˆ[Li, Mn, O]ã¨[O, Mn, Li]ãŒç•°ãªã‚‹ãƒ™ã‚¯ãƒˆãƒ«ã«ãªã‚‹ï¼‰</li>
</ul>

<p><strong>3. Magpieè¨˜è¿°å­ã®é•·æ‰€ãƒ»çŸ­æ‰€</strong>:</p>

<p><strong>é•·æ‰€</strong>:</p>
<ul>
<li>å…ƒç´ ã®åŒ–å­¦çš„æ€§è³ªã‚’åæ˜ ï¼ˆé›»æ°—é™°æ€§åº¦ã€ã‚¤ã‚ªãƒ³åŠå¾„ãªã©ï¼‰</li>
<li>é¡ä¼¼çµ„æˆãŒä¼¼ãŸãƒ™ã‚¯ãƒˆãƒ«ã«ãªã‚‹</li>
<li>æ©Ÿæ¢°å­¦ç¿’ã§é«˜ã„äºˆæ¸¬æ€§èƒ½</li>
</ul>

<p><strong>çŸ­æ‰€</strong>:</p>
<ul>
<li>é«˜æ¬¡å…ƒï¼ˆ132æ¬¡å…ƒï¼‰ã§å­¦ç¿’ãŒè¤‡é›‘</li>
<li>è§£é‡ˆæ€§ãŒä½ã„ï¼ˆã©ã®æ¬¡å…ƒãŒä½•ã‚’è¡¨ã™ã‹ç›´æ„Ÿçš„ã§ãªã„ï¼‰</li>
</ul>

<p><strong>æ¨å¥¨</strong>:</p>
<ul>
<li><strong>åˆæœŸæ¢ç´¢</strong>: Magpieè¨˜è¿°å­ï¼ˆæ±ç”¨æ€§ãŒé«˜ã„ï¼‰</li>
<li><strong>ç‰¹å®šã‚¿ã‚¹ã‚¯</strong>: ã‚¿ã‚¹ã‚¯å°‚ç”¨ã®è¨˜è¿°å­ï¼ˆä¾‹: è§¦åª’ãªã‚‰dè»Œé“å æœ‰æ•°ï¼‰</li>
<li><strong>ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰</strong>: çµ„æˆ + ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</li>
</ul>

<p></details></p>

<p>---</p>

<p><h3>å•é¡Œ3 (é›£æ˜“åº¦: hard)</h3></p>

<p>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ¢ç´¢ç’°å¢ƒã«ãŠã„ã¦ã€ä»¥ä¸‹ã®æ”¹å–„ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ï¼š</p>

<ol>
<li><strong>å±¥æ­´ã‚’è€ƒæ…®ã—ãŸçŠ¶æ…‹</strong>: ã“ã‚Œã¾ã§è©¦ã—ãŸææ–™ã®æƒ…å ±ã‚’çŠ¶æ…‹ã«å«ã‚ã‚‹</li>
<li><strong>æ¢ç´¢ãƒœãƒ¼ãƒŠã‚¹</strong>: æœªçŸ¥ã®é ˜åŸŸã‚’æ¢ç´¢ã—ãŸå ´åˆã«è¿½åŠ å ±é…¬</li>
<li><strong>æ—©æœŸçµ‚äº†</strong>: 10ã‚¹ãƒ†ãƒƒãƒ—é€£ç¶šã§æ”¹å–„ãŒãªã„å ´åˆã€ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰çµ‚äº†</li>
</ol>

<p><details></p>
<p><summary>ãƒ’ãƒ³ãƒˆ</summary></p>

<p>å±¥æ­´ã¯è¾æ›¸å½¢å¼ã§ä¿å­˜ã—ã€çŠ¶æ…‹ã«ã¯ã€Œæœ€è‰¯ææ–™ã¨ã®è·é›¢ã€ãªã©ã‚’è¿½åŠ ã—ã¾ã™ã€‚æ¢ç´¢ãƒœãƒ¼ãƒŠã‚¹ã¯ã€éå»ã®ææ–™ã¨ã®é¡ä¼¼åº¦ã§è¨ˆç®—ã§ãã¾ã™ã€‚</p>

<p></details></p>

<p><details></p>
<p><summary>è§£ç­”ä¾‹</summary></p>

<p><pre><code class="language-python">import numpy as np</p>
<p>from scipy.spatial.distance import euclidean</p>

<p>class ImprovedBandgapEnv(gym.Env):</p>
<p>    """æ”¹å–„ç‰ˆãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ¢ç´¢ç’°å¢ƒ"""</p>

<p>    def __init__(self, target_bandgap=3.0):</p>
<p>        super(ImprovedBandgapEnv, self).__init__()</p>

<p>        self.target_bandgap = target_bandgap</p>

<p>        <h1>è¡Œå‹•ãƒ»çŠ¶æ…‹ç©ºé–“ï¼ˆç°¡ç•¥åŒ–ï¼‰</h1></p>
<p>        self.action_space = gym.spaces.Box(low=0, high=1, shape=(10,), dtype=np.float32)</p>
<p>        self.observation_space = gym.spaces.Box(low=-10, high=10, shape=(15,), dtype=np.float32)</p>

<p>        <h1>å±¥æ­´</h1></p>
<p>        self.history = []</p>
<p>        self.best_error = float('inf')</p>
<p>        self.no_improvement_count = 0</p>

<p>    def reset(self):</p>
<p>        self.history = []</p>
<p>        self.best_error = float('inf')</p>
<p>        self.no_improvement_count = 0</p>

<p>        initial_state = self._get_state(np.random.uniform(0, 1, 10))</p>
<p>        return initial_state</p>

<p>    def step(self, action):</p>
<p>        <h1>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—äºˆæ¸¬ï¼ˆç°¡æ˜“ãƒ¢ãƒ‡ãƒ«ï¼‰</h1></p>
<p>        predicted_bandgap = np.sum(action) * 3.0  <h1>ä»®ã®äºˆæ¸¬</h1></p>

<p>        <h1>èª¤å·®</h1></p>
<p>        error = abs(predicted_bandgap - self.target_bandgap)</p>

<p>        <h1>åŸºæœ¬å ±é…¬</h1></p>
<p>        reward = -error</p>

<p>        <h1>æ”¹å–„1: å±¥æ­´ã‚’è€ƒæ…®ã—ãŸçŠ¶æ…‹</h1></p>
<p>        state = self._get_state(action)</p>

<p>        <h1>æ”¹å–„2: æ¢ç´¢ãƒœãƒ¼ãƒŠã‚¹</h1></p>
<p>        exploration_bonus = self._compute_exploration_bonus(action)</p>
<p>        reward += 0.1 * exploration_bonus</p>

<p>        <h1>æ”¹å–„3: æ—©æœŸçµ‚äº†</h1></p>
<p>        if error < self.best_error:</p>
<p>            self.best_error = error</p>
<p>            self.no_improvement_count = 0</p>
<p>        else:</p>
<p>            self.no_improvement_count += 1</p>

<p>        done = error < 0.05 or self.no_improvement_count >= 10 or len(self.history) >= 100</p>

<p>        <h1>å±¥æ­´ã«è¿½åŠ </h1></p>
<p>        self.history.append({</p>
<p>            'action': action,</p>
<p>            'bandgap': predicted_bandgap,</p>
<p>            'error': error</p>
<p>        })</p>

<p>        info = {'bandgap': predicted_bandgap, 'exploration_bonus': exploration_bonus}</p>

<p>        return state, reward, done, info</p>

<p>    def _get_state(self, action):</p>
<p>        """å±¥æ­´ã‚’è€ƒæ…®ã—ãŸçŠ¶æ…‹</p>

<p>        çŠ¶æ…‹æ§‹æˆ:</p>
<p>        - ç¾åœ¨ã®è¡Œå‹•ï¼ˆ10æ¬¡å…ƒï¼‰</p>
<p>        - æœ€è‰¯ææ–™ã¨ã®è·é›¢ï¼ˆ1æ¬¡å…ƒï¼‰</p>
<p>        - å±¥æ­´ã‚µã‚¤ã‚ºï¼ˆ1æ¬¡å…ƒï¼‰</p>
<p>        - æ”¹å–„ãªã—é€£ç¶šå›æ•°ï¼ˆ1æ¬¡å…ƒï¼‰</p>
<p>        - å¹³å‡èª¤å·®ï¼ˆ1æ¬¡å…ƒï¼‰</p>
<p>        - æœ€è‰¯èª¤å·®ï¼ˆ1æ¬¡å…ƒï¼‰</p>
<p>        """</p>
<p>        state = np.zeros(15, dtype=np.float32)</p>

<p>        <h1>ç¾åœ¨ã®è¡Œå‹•</h1></p>
<p>        state[:10] = action</p>

<p>        <h1>æœ€è‰¯ææ–™ã¨ã®è·é›¢</h1></p>
<p>        if self.history:</p>
<p>            best_action = min(self.history, key=lambda x: x['error'])['action']</p>
<p>            state[10] = euclidean(action, best_action) / 10.0  <h1>æ­£è¦åŒ–</h1></p>
<p>        else:</p>
<p>            state[10] = 1.0</p>

<p>        <h1>å±¥æ­´ã‚µã‚¤ã‚º</h1></p>
<p>        state[11] = len(self.history) / 100.0  <h1>æ­£è¦åŒ–</h1></p>

<p>        <h1>æ”¹å–„ãªã—é€£ç¶šå›æ•°</h1></p>
<p>        state[12] = self.no_improvement_count / 10.0</p>

<p>        <h1>å¹³å‡èª¤å·®</h1></p>
<p>        if self.history:</p>
<p>            state[13] = np.mean([h['error'] for h in self.history])</p>
<p>        else:</p>
<p>            state[13] = 10.0</p>

<p>        <h1>æœ€è‰¯èª¤å·®</h1></p>
<p>        state[14] = self.best_error</p>

<p>        return state</p>

<p>    def _compute_exploration_bonus(self, action):</p>
<p>        """æ¢ç´¢ãƒœãƒ¼ãƒŠã‚¹</p>

<p>        éå»ã®è¡Œå‹•ã¨é›¢ã‚Œã¦ã„ã‚‹ã»ã©é«˜ã„ãƒœãƒ¼ãƒŠã‚¹</p>
<p>        """</p>
<p>        if not self.history:</p>
<p>            return 1.0  <h1>æœ€åˆã¯å¸¸ã«æ¢ç´¢</h1></p>

<p>        <h1>éå»ã®è¡Œå‹•ã¨ã®æœ€å°è·é›¢</h1></p>
<p>        min_distance = min(</p>
<p>            euclidean(action, h['action'])</p>
<p>            for h in self.history</p>
<p>        )</p>

<p>        <h1>è·é›¢ãŒå¤§ãã„ã»ã©ãƒœãƒ¼ãƒŠã‚¹ï¼ˆæœ€å¤§1.0ï¼‰</h1></p>
<p>        bonus = min(1.0, min_distance / 5.0)</p>

<p>        return bonus</p>


<p><h1>ãƒ†ã‚¹ãƒˆ</h1></p>
<p>env = ImprovedBandgapEnv()</p>
<p>state = env.reset()</p>

<p>for step in range(50):</p>
<p>    action = env.action_space.sample()</p>
<p>    state, reward, done, info = env.step(action)</p>

<p>    print(f"Step {step+1}: Bandgap={info['bandgap']:.2f}, "</p>
<p>          f"Reward={reward:.2f}, Exploration={info['exploration_bonus']:.2f}")</p>

<p>    if done:</p>
<p>        print(f"çµ‚äº†: æœ€è‰¯èª¤å·®={env.best_error:.4f}, "</p>
<p>              f"æ”¹å–„ãªã—é€£ç¶š={env.no_improvement_count}å›")</p>
<p>        break</p>
<p></code></pre></p>

<p><strong>ãƒã‚¤ãƒ³ãƒˆ</strong>:</p>
<ul>
<li>å±¥æ­´æƒ…å ±ã‚’çŠ¶æ…‹ã«å«ã‚ã‚‹ã“ã¨ã§ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒéå»ã®çµŒé¨“ã‚’æ´»ç”¨</li>
<li>æ¢ç´¢ãƒœãƒ¼ãƒŠã‚¹ã«ã‚ˆã‚Šã€æœªçŸ¥é ˜åŸŸã®æ¢ç´¢ã‚’ä¿ƒé€²</li>
<li>æ—©æœŸçµ‚äº†ã«ã‚ˆã‚Šã€ç„¡é§„ãªæ¢ç´¢ã‚’å‰Šæ¸›</li>
</ul>

<p></details></p>

<p>---</p>

<p><h2>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã¾ã¨ã‚</h2></p>

<ul>
<li><strong>OpenAI Gym</strong>ã¯å¼·åŒ–å­¦ç¿’ç’°å¢ƒã®æ¨™æº–ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</li>
<li><strong>çŠ¶æ…‹ç©ºé–“</strong>ã¯ææ–™è¨˜è¿°å­ã§è¨­è¨ˆï¼ˆçµ„æˆã€æ§‹é€ ã€ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰</li>
<li><strong>å ±é…¬é–¢æ•°</strong>ã¯æ˜ç¢ºãªç›®æ¨™ã€é©åˆ‡ãªã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã€ä¸­é–“å ±é…¬ãŒé‡è¦</li>
<li><strong>DFTçµ±åˆ</strong>ã¯ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒ¢ãƒ‡ãƒ«ã§é«˜é€ŸåŒ–ã—ã€é‡è¦ãªææ–™ã®ã¿ç²¾å¯†è¨ˆç®—</li>
<li><strong>å®Ÿé¨“è£…ç½®çµ±åˆ</strong>ã¯REST APIã§ã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãƒ«ãƒ¼ãƒ—æœ€é©åŒ–ã‚’å®Ÿç¾</li>
</ul>

<p>æ¬¡ç« ã§ã¯ã€åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹åˆ¶å¾¡ã‚„åˆæˆçµŒè·¯è¨­è¨ˆãªã©ã€å®Ÿä¸–ç•Œã§ã®å¿œç”¨äº‹ä¾‹ã‚’å­¦ã³ã¾ã™ã€‚</p>

<p>---</p>

<p><h2>å‚è€ƒæ–‡çŒ®</h2></p>

<ol>
<li>Brockman et al. "OpenAI Gym" <em>arXiv</em> (2016) - Gymç’°å¢ƒã®æ¨™æº–</li>
<li>Ward et al. "A general-purpose machine learning framework for predicting properties of inorganic materials" <em>npj Computational Materials</em> (2016) - Magpieè¨˜è¿°å­</li>
<li>Brockherde et al. "Bypassing the Kohn-Sham equations with machine learning" <em>Nature Communications</em> (2017) - DFTåŠ é€Ÿ</li>
<li>Ng et al. "Policy invariance under reward transformations" <em>ICML</em> (1999) - å ±é…¬ã‚·ã‚§ã‚¤ãƒ”ãƒ³ã‚°ç†è«–</li>
</ol>

<p>---</p>

<p><strong>æ¬¡ç« </strong>: <a href="chapter-4.html">ç¬¬4ç« : å®Ÿä¸–ç•Œå¿œç”¨ã¨ã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãƒ«ãƒ¼ãƒ—</a></p>


        
        <div class="navigation">
            <a href="chapter-4.html" class="nav-button">æ¬¡ç« : ç¬¬4ç«  â†’</a>
            <a href="index.html" class="nav-button">â† ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
            <a href="chapter-2.html" class="nav-button">â† å‰ç« : ç¬¬2ç« </a>
        </div>
    
    </main>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ç›£ä¿®</strong>: Dr. Yusuke Hashimoto(æ±åŒ—å¤§å­¦)</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-17</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mermaidCodeBlocks = document.querySelectorAll('pre.codehilite code.language-mermaid, pre code.language-mermaid');

            mermaidCodeBlocks.forEach(function(codeBlock) {
                const pre = codeBlock.parentElement;
                const mermaidCode = codeBlock.textContent;

                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode.trim();

                pre.parentNode.replaceChild(mermaidDiv, pre);
            });

            if (typeof mermaid !== 'undefined') {
                mermaid.initialize({
                    startOnLoad: true,
                    theme: 'default'
                });
                mermaid.init(undefined, document.querySelectorAll('.mermaid'));
            }
        });
    </script>
</body>
</html>