<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« ï¼šGNNã®åŸºç¤ç†è«– - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬2ç« ï¼šGNNã®åŸºç¤ç†è«–</h1>
            <p class="subtitle">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°ã‹ã‚‰ææ–™ç§‘å­¦ç‰¹åŒ–GNNã¾ã§</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 25-30åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 10å€‹</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 3å•</span>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="learning-objectives">
            <h2>å­¦ç¿’ç›®æ¨™</h2>
            <p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
            <ul>
                <li>ã‚°ãƒ©ãƒ•ã®æ•°å­¦çš„å®šç¾©ã¨è¡¨ç¾æ–¹æ³•ã‚’ç†è§£ã™ã‚‹</li>
                <li>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°ã®3ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆé›†ç´„â†’æ›´æ–°â†’å‡ºåŠ›ï¼‰ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>GCNã€GATã€GraphSAGEã®åŸç†ã¨é•ã„ã‚’ç†è§£ã™ã‚‹</li>
                <li>ææ–™ç§‘å­¦ç‰¹åŒ–GNNï¼ˆSchNetã€DimeNetï¼‰ã®ç‰¹å¾´ã‚’çŸ¥ã‚‹</li>
                <li>ã‚·ãƒ³ãƒ—ãƒ«ãªGNNã‚’PyTorchã§å®Ÿè£…ã§ãã‚‹</li>
                <li>ç­‰å¤‰GNNã®é‡è¦æ€§ã‚’ç†è§£ã™ã‚‹</li>
            </ul>
        </div>

        <h2>2.1 ã‚°ãƒ©ãƒ•ã®æ•°å­¦çš„å®šç¾©</h2>

        <h3>ã‚°ãƒ©ãƒ•ã®åŸºæœ¬è¦ç´ </h3>
        <blockquote>
            <p>ã‚°ãƒ©ãƒ• G = (V, E) ã¯ã€é ‚ç‚¹é›†åˆ V ã¨è¾ºé›†åˆ E âŠ† V Ã— V ã‹ã‚‰ãªã‚‹ã€‚</p>
        </blockquote>

        <p><strong>è¨˜æ³•</strong>:</p>
        <ul>
            <li>n = |V|: é ‚ç‚¹æ•°</li>
            <li>m = |E|: è¾ºæ•°</li>
            <li>ğ’©(v): é ‚ç‚¹ v ã®éš£æ¥é ‚ç‚¹é›†åˆ</li>
        </ul>

        <h3>éš£æ¥è¡Œåˆ—ï¼ˆAdjacency Matrixï¼‰</h3>
        <p><strong>Pythonã§ã®å®Ÿè£…</strong>:</p>
        <pre><code class="language-python">import numpy as np

# ä¾‹ï¼šä¸‰è§’å½¢ã‚°ãƒ©ãƒ•ï¼ˆ3é ‚ç‚¹ã€3è¾ºï¼‰
n = 3
A = np.array([
    [0, 1, 1],  # é ‚ç‚¹0: 1, 2ã«æ¥ç¶š
    [1, 0, 1],  # é ‚ç‚¹1: 0, 2ã«æ¥ç¶š
    [1, 1, 0]   # é ‚ç‚¹2: 0, 1ã«æ¥ç¶š
])

print("éš£æ¥è¡Œåˆ—:")
print(A)
print(f"\né ‚ç‚¹æ•°: {n}")
print(f"è¾ºæ•°: {A.sum() // 2}")  # ç„¡å‘ã‚°ãƒ©ãƒ•ã¯2ã§å‰²ã‚‹</code></pre>

        <h2>2.2 ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°ã®ä»•çµ„ã¿</h2>

        <h3>Message Passing Neural Network (MPNN)</h3>
        <p>GNNã®<strong>çµ±ä¸€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</strong>ã§ã™ï¼ˆGilmer et al., 2017ï¼‰ã€‚</p>

        <p><strong>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </strong>:</p>
        <pre><code class="language-mermaid">graph LR
    A[å…¥åŠ›: é ‚ç‚¹ç‰¹å¾´ X] --> B[ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆ]
    B --> C[ã‚¹ãƒ†ãƒƒãƒ—2: é›†ç´„ Aggregation]
    C --> D[ã‚¹ãƒ†ãƒƒãƒ—3: æ›´æ–° Update]
    D --> E{ç¹°ã‚Šè¿”ã—?}
    E -->|Yes| B
    E -->|No| F[å‡ºåŠ›: æ–°ã—ã„ç‰¹å¾´]

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#f3e5f5
    style D fill:#e8f5e9
    style F fill:#ffebee</code></pre>

        <h3>ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆï¼ˆMessageï¼‰</h3>
        <pre><code class="language-python">import torch
import torch.nn as nn

class MessageFunction(nn.Module):
    def __init__(self, in_dim, out_dim):
        super().__init__()
        self.W = nn.Linear(in_dim, out_dim)

    def forward(self, h_j):
        """
        éš£æ¥é ‚ç‚¹ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆ

        Parameters:
        -----------
        h_j : Tensor (num_neighbors, in_dim)
            éš£æ¥é ‚ç‚¹ã®ç‰¹å¾´é‡

        Returns:
        --------
        messages : Tensor (num_neighbors, out_dim)
            ç”Ÿæˆã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        """
        return self.W(h_j)</code></pre>

        <h3>ã‚¹ãƒ†ãƒƒãƒ—2: é›†ç´„ï¼ˆAggregationï¼‰</h3>
        <p><strong>ä»£è¡¨çš„ãªé›†ç´„é–¢æ•°</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>é›†ç´„æ–¹æ³•</th>
                    <th>æ•°å¼</th>
                    <th>ç‰¹å¾´</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Sum</strong></td>
                    <td>Î£ m_ij</td>
                    <td>é †åºä¸å¤‰ã€æ¬¡æ•°ã«æ•æ„Ÿ</td>
                </tr>
                <tr>
                    <td><strong>Mean</strong></td>
                    <td>(1/|ğ’©(i)|) Î£ m_ij</td>
                    <td>æ¬¡æ•°æ­£è¦åŒ–</td>
                </tr>
                <tr>
                    <td><strong>Max</strong></td>
                    <td>max m_ij</td>
                    <td>æœ€ã‚‚å¼·ã„ç‰¹å¾´ã‚’ä¿æŒ</td>
                </tr>
                <tr>
                    <td><strong>Attention</strong></td>
                    <td>Î£ Î±_ij m_ij</td>
                    <td>é‡è¦åº¦ã§é‡ã¿ä»˜ã‘</td>
                </tr>
            </tbody>
        </table>

        <h2>2.3 ä»£è¡¨çš„ãªGNNã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</h2>

        <h3>Graph Convolutional Network (GCN)</h3>
        <p><strong>è«–æ–‡</strong>: Kipf & Welling (2017), <em>ICLR</em></p>
        <p><strong>æ ¸å¿ƒã‚¢ã‚¤ãƒ‡ã‚¢</strong>: ã‚°ãƒ©ãƒ•ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ç•³ã¿è¾¼ã¿</p>

        <pre><code class="language-python">import torch
import torch.nn as nn
import torch.nn.functional as F

class GCNLayer(nn.Module):
    def __init__(self, in_features, out_features):
        super().__init__()
        self.linear = nn.Linear(in_features, out_features)

    def forward(self, X, A):
        """
        Parameters:
        -----------
        X : Tensor (num_nodes, in_features)
            é ‚ç‚¹ç‰¹å¾´è¡Œåˆ—
        A : Tensor (num_nodes, num_nodes)
            éš£æ¥è¡Œåˆ—

        Returns:
        --------
        H : Tensor (num_nodes, out_features)
            æ›´æ–°ã•ã‚ŒãŸç‰¹å¾´é‡
        """
        # è‡ªå·±ãƒ«ãƒ¼ãƒ—ã®è¿½åŠ 
        A_tilde = A + torch.eye(A.size(0), device=A.device)

        # æ¬¡æ•°è¡Œåˆ—
        D_tilde = torch.diag(A_tilde.sum(dim=1))

        # æ­£è¦åŒ–: D^(-1/2) * A * D^(-1/2)
        D_inv_sqrt = torch.diag(1.0 / torch.sqrt(D_tilde.diagonal()))
        A_norm = D_inv_sqrt @ A_tilde @ D_inv_sqrt

        # ã‚°ãƒ©ãƒ•ç•³ã¿è¾¼ã¿
        H = A_norm @ X
        H = self.linear(H)
        return F.relu(H)</code></pre>

        <p><strong>ç‰¹å¾´</strong>:</p>
        <ul>
            <li>âœ… ã‚·ãƒ³ãƒ—ãƒ«ã§é«˜é€Ÿ</li>
            <li>âœ… éå‰°å¹³æ»‘åŒ–ï¼ˆover-smoothingï¼‰ã«æ³¨æ„</li>
            <li>âœ… å›ºå®šçš„ãªé‡ã¿ï¼ˆå…¨éš£æ¥é ‚ç‚¹ãŒåŒã˜æ‰±ã„ï¼‰</li>
        </ul>

        <h3>Graph Attention Network (GAT)</h3>
        <p><strong>è«–æ–‡</strong>: VeliÄkoviÄ‡ et al. (2018), <em>ICLR</em></p>
        <p><strong>æ ¸å¿ƒã‚¢ã‚¤ãƒ‡ã‚¢</strong>: Attentionã§é‡è¦ãªéš£æ¥é ‚ç‚¹ã‚’é‡è¦–</p>

        <p><strong>ç‰¹å¾´</strong>:</p>
        <ul>
            <li>âœ… å‹•çš„ãªé‡ã¿ï¼ˆé‡è¦ãªéš£æ¥é ‚ç‚¹ã‚’è‡ªå‹•å­¦ç¿’ï¼‰</li>
            <li>âœ… è§£é‡ˆå¯èƒ½æ€§ï¼ˆAttentionä¿‚æ•°ã®å¯è¦–åŒ–ï¼‰</li>
            <li>âŒ è¨ˆç®—ã‚³ã‚¹ãƒˆãŒé«˜ã„ï¼ˆGCNã®ç´„2å€ï¼‰</li>
        </ul>

        <h3>GraphSAGEï¼ˆSAmple and aggreGatEï¼‰</h3>
        <p><strong>è«–æ–‡</strong>: Hamilton et al. (2017), <em>NeurIPS</em></p>
        <p><strong>æ ¸å¿ƒã‚¢ã‚¤ãƒ‡ã‚¢</strong>: ãƒŸãƒ‹ãƒãƒƒãƒå­¦ç¿’ã®ãŸã‚ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°</p>

        <p><strong>ç‰¹å¾´</strong>:</p>
        <ul>
            <li>âœ… ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ï¼ˆå¤§è¦æ¨¡ã‚°ãƒ©ãƒ•ã«å¯¾å¿œï¼‰</li>
            <li>âœ… ãƒŸãƒ‹ãƒãƒƒãƒè¨“ç·´ãŒå¯èƒ½</li>
            <li>âœ… å¸°ç´çš„å­¦ç¿’ï¼ˆæ–°ã—ã„é ‚ç‚¹ã¸ã®æ±åŒ–ï¼‰</li>
        </ul>

        <h3>3ã¤ã®GNNã®æ¯”è¼ƒ</h3>
        <pre><code class="language-mermaid">flowchart TD
    A[GNNé¸æŠ] --> B{ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º}
    B -->|å°è¦æ¨¡<br/>10ké ‚ç‚¹| C[GCN]
    B -->|ä¸­è¦æ¨¡<br/>10k-100k| D[GAT]
    B -->|å¤§è¦æ¨¡<br/>100k+| E[GraphSAGE]

    C --> F[ã‚·ãƒ³ãƒ—ãƒ«ã€é«˜é€Ÿ]
    D --> G[é«˜ç²¾åº¦ã€è§£é‡ˆæ€§]
    E --> H[ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«]

    style A fill:#e3f2fd
    style C fill:#fff3e0
    style D fill:#f3e5f5
    style E fill:#e8f5e9</code></pre>

        <table>
            <thead>
                <tr>
                    <th>æ‰‹æ³•</th>
                    <th>è¨ˆç®—é‡</th>
                    <th>ç²¾åº¦</th>
                    <th>ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£</th>
                    <th>è§£é‡ˆæ€§</th>
                    <th>æ¨å¥¨ç”¨é€”</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>GCN</strong></td>
                    <td>O(mÂ·dÂ²)</td>
                    <td>ä¸­</td>
                    <td>ä½</td>
                    <td>ä¸­</td>
                    <td>å°è¦æ¨¡ã€ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ”ãƒ³ã‚°</td>
                </tr>
                <tr>
                    <td><strong>GAT</strong></td>
                    <td>O(mÂ·dÂ²+nÂ·d)</td>
                    <td>é«˜</td>
                    <td>ä¸­</td>
                    <td>é«˜</td>
                    <td>ä¸­è¦æ¨¡ã€é«˜ç²¾åº¦è¦æ±‚</td>
                </tr>
                <tr>
                    <td><strong>GraphSAGE</strong></td>
                    <td>O(kÂ·sÂ·dÂ²)</td>
                    <td>ä¸­ã€œé«˜</td>
                    <td>é«˜</td>
                    <td>ä¸­</td>
                    <td>å¤§è¦æ¨¡ã€å®Ÿæ™‚é–“äºˆæ¸¬</td>
                </tr>
            </tbody>
        </table>

        <h2>2.4 ææ–™ç§‘å­¦ç‰¹åŒ–GNN</h2>

        <h3>SchNetï¼ˆContinuous-filter Convolutional NNï¼‰</h3>
        <p><strong>è«–æ–‡</strong>: SchÃ¼tt et al. (2017), <em>NeurIPS</em></p>
        <p><strong>å¯¾è±¡</strong>: åˆ†å­ãƒ»ææ–™ã®<strong>é‡å­åŒ–å­¦ç‰¹æ€§</strong>äºˆæ¸¬</p>

        <p><strong>æ ¸å¿ƒã‚¢ã‚¤ãƒ‡ã‚¢</strong>:</p>
        <ol>
            <li><strong>é€£ç¶šãƒ•ã‚£ãƒ«ã‚¿</strong>: é›¢æ•£ã‚°ãƒ©ãƒ•ã§ã¯ãªã3Dç©ºé–“ã§ã®ç•³ã¿è¾¼ã¿</li>
            <li><strong>è·é›¢ä¾å­˜</strong>: åŸå­é–“è·é›¢ã‚’æ˜ç¤ºçš„ã«ãƒ¢ãƒ‡ãƒ«åŒ–</li>
        </ol>

        <p><strong>ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</strong>:</p>
        <pre><code class="language-mermaid">graph LR
    A[åŸå­ç‰¹å¾´] --> B[åŸ‹ã‚è¾¼ã¿å±¤]
    B --> C[ç›¸äº’ä½œç”¨ãƒ–ãƒ­ãƒƒã‚¯ 1]
    C --> D[ç›¸äº’ä½œç”¨ãƒ–ãƒ­ãƒƒã‚¯ 2]
    D --> E[ç›¸äº’ä½œç”¨ãƒ–ãƒ­ãƒƒã‚¯ 3]
    E --> F[å‡ºåŠ›å±¤]

    G[åŸå­é–“è·é›¢] --> C
    G --> D
    G --> E

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#f3e5f5
    style D fill:#e8f5e9
    style E fill:#ffebee
    style F fill:#fff9c4
    style G fill:#e1bee7</code></pre>

        <p><strong>é©ç”¨ä¾‹</strong>:</p>
        <ul>
            <li>QM9ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆåˆ†å­ç‰¹æ€§äºˆæ¸¬ï¼‰</li>
            <li>MD17ï¼ˆåˆ†å­å‹•åŠ›å­¦ï¼‰</li>
            <li>OC20ï¼ˆè§¦åª’å¸ç€ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰</li>
        </ul>

        <p><strong>æ€§èƒ½</strong>:</p>
        <pre><code>QM9 HOMO-LUMO gap:
- DFTè¨ˆç®—: 24æ™‚é–“/åˆ†å­
- SchNet: 0.01ç§’/åˆ†å­ï¼ˆMAE=0.04 eVï¼‰</code></pre>

        <h3>DimeNetï¼ˆDirectional Message Passing NNï¼‰</h3>
        <p><strong>è«–æ–‡</strong>: Klicpera et al. (2020), <em>ICLR</em></p>
        <p><strong>æ‹¡å¼µ</strong>: <strong>çµåˆè§’</strong>ã‚‚è€ƒæ…®</p>

        <p><strong>æ ¸å¿ƒã‚¢ã‚¤ãƒ‡ã‚¢</strong>:</p>
        <ul>
            <li>è·é›¢ã ã‘ã§ãªã<strong>è§’åº¦æƒ…å ±</strong>ã‚‚åˆ©ç”¨</li>
            <li>3ä½“ç›¸äº’ä½œç”¨ï¼ˆtriplet interactionï¼‰</li>
        </ul>

        <pre><code class="language-mermaid">graph TD
    A[åŸå­ i] ---|d_ij| B[åŸå­ j]
    B ---|d_jk| C[åŸå­ k]
    A -.è§’åº¦Î¸_ijk.-> C

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#f3e5f5</code></pre>

        <p><strong>æ€§èƒ½</strong>:</p>
        <pre><code>QM9ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ:
- SchNet: MAE=0.041 eV
- DimeNet: MAE=0.033 eVï¼ˆ20%æ”¹å–„ï¼‰

è¨ˆç®—æ™‚é–“:
- SchNet: 0.01ç§’/åˆ†å­
- DimeNet: 0.05ç§’/åˆ†å­ï¼ˆ5å€é…ã„ï¼‰</code></pre>

        <h3>ææ–™ç§‘å­¦GNNã®æ¯”è¼ƒ</h3>
        <table>
            <thead>
                <tr>
                    <th>æ‰‹æ³•</th>
                    <th>è€ƒæ…®ã™ã‚‹æƒ…å ±</th>
                    <th>ç²¾åº¦</th>
                    <th>é€Ÿåº¦</th>
                    <th>æ¨å¥¨ç”¨é€”</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>SchNet</strong></td>
                    <td>è·é›¢</td>
                    <td>ä¸­</td>
                    <td>é€Ÿã„</td>
                    <td>åˆ†å­ç‰¹æ€§äºˆæ¸¬</td>
                </tr>
                <tr>
                    <td><strong>DimeNet</strong></td>
                    <td>è·é›¢ + è§’åº¦</td>
                    <td>é«˜</td>
                    <td>ä¸­</td>
                    <td>è§¦åª’ã€è¤‡é›‘ãªåˆ†å­</td>
                </tr>
                <tr>
                    <td><strong>GemNet</strong></td>
                    <td>è·é›¢ + è§’åº¦ + äºŒé¢è§’</td>
                    <td>æœ€é«˜</td>
                    <td>é…ã„</td>
                    <td>çµæ™¶ã€é«˜ç²¾åº¦è¦æ±‚</td>
                </tr>
            </tbody>
        </table>

        <h2>2.7 æœ¬ç« ã®ã¾ã¨ã‚</h2>

        <h3>å­¦ã‚“ã ã“ã¨</h3>
        <ol>
            <li><strong>ã‚°ãƒ©ãƒ•ã®æ•°å­¦çš„å®šç¾©</strong>
                <ul>
                    <li>éš£æ¥è¡Œåˆ—ã€æ¬¡æ•°è¡Œåˆ—ã€ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³è¡Œåˆ—</li>
                    <li>é ‚ç‚¹ç‰¹å¾´é‡ã¨è¾ºç‰¹å¾´é‡</li>
                </ul>
            </li>
            <li><strong>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°</strong>
                <ul>
                    <li>3ã‚¹ãƒ†ãƒƒãƒ—: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆ â†’ é›†ç´„ â†’ æ›´æ–°</li>
                    <li>é›†ç´„é–¢æ•°: Sumã€Meanã€Maxã€Attention</li>
                </ul>
            </li>
            <li><strong>ä»£è¡¨çš„GNNã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</strong>
                <ul>
                    <li>GCN: ã‚·ãƒ³ãƒ—ãƒ«ã€é«˜é€Ÿ</li>
                    <li>GAT: Attentionã€é«˜ç²¾åº¦</li>
                    <li>GraphSAGE: ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ã€ãƒŸãƒ‹ãƒãƒƒãƒ</li>
                </ul>
            </li>
            <li><strong>ææ–™ç§‘å­¦ç‰¹åŒ–GNN</strong>
                <ul>
                    <li>SchNet: è·é›¢ä¾å­˜ã€é€£ç¶šãƒ•ã‚£ãƒ«ã‚¿</li>
                    <li>DimeNet: è§’åº¦æƒ…å ±ã‚‚è€ƒæ…®</li>
                    <li>GemNet: äºŒé¢è§’ã¾ã§è€ƒæ…®</li>
                </ul>
            </li>
        </ol>

        <h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>
        <ul>
            <li>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°ã¯GNNã®<strong>çµ±ä¸€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</strong></li>
            <li>é›†ç´„é–¢æ•°ã®é¸æŠãŒæ€§èƒ½ã«å¤§ããå½±éŸ¿</li>
            <li>ææ–™ç§‘å­¦ã§ã¯<strong>å¹¾ä½•å­¦çš„æƒ…å ±</strong>ï¼ˆè·é›¢ã€è§’åº¦ï¼‰ãŒé‡è¦</li>
            <li>ç­‰å¤‰æ€§ã«ã‚ˆã‚Š<strong>ç‰©ç†æ³•å‰‡ã‚’ä¿è¨¼</strong></li>
            <li>éå‰°å¹³æ»‘åŒ–ã«æ³¨æ„ï¼ˆResidual Connectionã§å¯¾ç­–ï¼‰</li>
        </ul>

        <div class="navigation">
            <a href="chapter-1.html" class="nav-button">â† å‰ç« : ç¬¬1ç«  ãªãœGNNãŒå¿…è¦ã‹</a>
            <a href="chapter-3.html" class="nav-button">æ¬¡ç« : ç¬¬3ç«  PyTorch Geometricå®Ÿè·µ â†’</a>
            <a href="index.html" class="nav-button">â† ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
        </div>
    </main>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ç›£ä¿®</strong>: Dr. Yusuke Hashimotoï¼ˆæ±åŒ—å¤§å­¦ï¼‰</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-17</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mermaidCodeBlocks = document.querySelectorAll('pre.codehilite code.language-mermaid, pre code.language-mermaid');

            mermaidCodeBlocks.forEach(function(codeBlock) {
                const pre = codeBlock.parentElement;
                const mermaidCode = codeBlock.textContent;

                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode.trim();

                pre.parentNode.replaceChild(mermaidDiv, pre);
            });

            if (typeof mermaid !== 'undefined') {
                mermaid.initialize({
                    startOnLoad: true,
                    theme: 'default'
                });
                mermaid.init(undefined, document.querySelectorAll('.mermaid'));
            }
        });
    </script>
</body>
</html>
