<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬4ç« ï¼šåå¿œäºˆæ¸¬ã¨Retrosynthesis - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>åå¿œäºˆæ¸¬ã¨Retrosynthesis</h1>
            <p class="subtitle"></p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 25-30åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´šã€œä¸Šç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 10å€‹</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 3å•</span>
            </div>
        </div>
    </header>

    <main class="container">

<h1>ç¬¬4ç« ï¼šåå¿œäºˆæ¸¬ã¨Retrosynthesis</h1>

<h2>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h2>

ã“ã®ç« ã§ã¯ã€åŒ–å­¦åå¿œã®è¨ˆç®—æ©Ÿè¡¨ç¾ã¨äºˆæ¸¬ã€ãã—ã¦ç›®æ¨™åˆ†å­ã‹ã‚‰åŸæ–™ã¸ã®é€†åˆæˆè§£æï¼ˆRetrosynthesisï¼‰ã‚’å­¦ã³ã¾ã™ã€‚ã“ã‚Œã‚‰ã®æŠ€è¡“ã¯ã€åŠ¹ç‡çš„ãªåˆæˆçµŒè·¯è¨­è¨ˆã«ãŠã„ã¦é©å‘½çš„ãªé€²å±•ã‚’ã‚‚ãŸã‚‰ã—ã¦ã„ã¾ã™ã€‚

<h3>å­¦ç¿’ç›®æ¨™</h3>

- âœ… åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨SMARTSã‚’ç†è§£ã—ã€è¨˜è¿°ã§ãã‚‹
- âœ… åå¿œäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã®åŸºæœ¬ã‚’ç†è§£ã—ã¦ã„ã‚‹
- âœ… Retrosynthesisã®æ¦‚å¿µã¨ä¸»è¦ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ãˆã‚‹
- âœ… ç”£æ¥­å¿œç”¨äº‹ä¾‹ã‚’çŸ¥ã‚Šã€ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹ã‚’æã‘ã‚‹
- âœ… å®Ÿéš›ã®å‰µè–¬ãƒ»ææ–™é–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å¿œç”¨ã§ãã‚‹

---

<h2>4.1 åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨SMARTS</h2>

<strong>åŒ–å­¦åå¿œã®è¡¨ç¾</strong>ã¯ã€åå¿œç‰©ã‹ã‚‰ç”Ÿæˆç‰©ã¸ã®å¤‰æ›ã‚’è¨˜è¿°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

<pre><code class="language-mermaid">graph LR
    A[åå¿œç‰©<br/>Reactants] -->|åå¿œæ¡ä»¶<br/>Conditions| B[ç”Ÿæˆç‰©<br/>Products]

    C[SMILES] --> D[åå¿œSMILES]
    C --> E[åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ<br/>SMARTS]
    C --> F[åå¿œã‚°ãƒ©ãƒ•]

    D --> G[æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«]
    E --> G
    F --> G
    G --> H[åå¿œäºˆæ¸¬]

    style A fill:#e3f2fd
    style B fill:#4CAF50,color:#fff
    style H fill:#FF9800,color:#fff</code></pre>

<h3>4.1.1 åå¿œSMILESã¨SMIRKS</h3>

<strong>åå¿œSMILES</strong>ã¯ã€åå¿œç‰©ã¨ç”Ÿæˆç‰©ã‚’<code>>></code>ã§åŒºåˆ‡ã£ã¦è¡¨ç¾ã—ã¾ã™ã€‚

<strong>å½¢å¼</strong>:
<pre><code>reactant1.reactant2>>product1.product2</code></pre>

<strong>SMIRKSï¼ˆSMILES Reaction Specificationï¼‰</strong>ã¯ã€åå¿œã®å¤‰åŒ–éƒ¨åˆ†ã‚’æ˜ç¤ºçš„ã«è¨˜è¿°ã—ã¾ã™ã€‚

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹1: åå¿œSMILESã®è§£æ</h4>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem, Draw

<h1>ã‚¨ã‚¹ãƒ†ãƒ«åŒ–åå¿œã®ä¾‹</h1>
reaction_smiles = "CC(=O)O.CCO>>CC(=O)OCC.O"
<h1>é…¢é…¸ + ã‚¨ã‚¿ãƒãƒ¼ãƒ« >> é…¢é…¸ã‚¨ãƒãƒ« + æ°´</h1>

<h1>åå¿œã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ</h1>
rxn = AllChem.ReactionFromSmarts(reaction_smiles)

print(f"åå¿œç‰©æ•°: {rxn.GetNumReactantTemplates()}")
print(f"ç”Ÿæˆç‰©æ•°: {rxn.GetNumProductTemplates()}")

<h1>åå¿œç‰©ã¨ç”Ÿæˆç‰©ã®å–å¾—</h1>
reactants = [rxn.GetReactantTemplate(i)
             for i in range(rxn.GetNumReactantTemplates())]
products = [rxn.GetProductTemplate(i)
            for i in range(rxn.GetNumProductTemplates())]

<h1>SMILESã®è¡¨ç¤º</h1>
print("\nåå¿œç‰©:")
for i, mol in enumerate(reactants, 1):
    print(f"  {i}. {Chem.MolToSmiles(mol)}")

print("\nç”Ÿæˆç‰©:")
for i, mol in enumerate(products, 1):
    print(f"  {i}. {Chem.MolToSmiles(mol)}")

<h1>åå¿œã®æç”»</h1>
rxn_img = Draw.ReactionToImage(rxn)
rxn_img.save("esterification_reaction.png")
print("\nåå¿œå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>åå¿œç‰©æ•°: 2
ç”Ÿæˆç‰©æ•°: 2

åå¿œç‰©:
  1. CC(=O)O
  2. CCO

ç”Ÿæˆç‰©:
  1. CC(=O)OCC
  2. O

åå¿œå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ</code></pre>

<h3>4.1.2 åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å®šç¾©</h3>

<strong>åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</strong>ã¯ã€åå¿œã®ä¸€èˆ¬çš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’SMARTSã§è¨˜è¿°ã—ãŸã‚‚ã®ã§ã™ã€‚

<h4>ä¸»è¦ãªåå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</h4>

<pre><code class="language-python"><h1>ä»£è¡¨çš„ãªåå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</h1>

reaction_templates = {
    # ã‚¨ã‚¹ãƒ†ãƒ«åŒ–
    "Esterification": "[C:1](=[O:2])[OH:3].[OH:4][C:5]>>[C:1](=[O:2])[O:4][C:5].[OH2:3]",

    # ã‚¢ãƒŸãƒ‰åŒ–
    "Amidation": "[C:1](=[O:2])[OH:3].[NH2:4][C:5]>>[C:1](=[O:2])[NH:4][C:5].[OH2:3]",

    # Suzuki-Miyauraã‚«ãƒƒãƒ—ãƒªãƒ³ã‚°
    "Suzuki": "[c:1][Br,I:2].[c:3][B:4]([OH])([OH])>>[c:1][c:3]",

    # é‚„å…ƒï¼ˆã‚«ãƒ«ãƒœãƒ‹ãƒ« â†’ ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ï¼‰
    "Reduction": "[C:1]=[O:2]>>[C:1][OH:2]",

    # é…¸åŒ–ï¼ˆã‚¢ãƒ«ã‚³ãƒ¼ãƒ« â†’ ã‚«ãƒ«ãƒœãƒ‹ãƒ«ï¼‰
    "Oxidation": "[C:1][OH:2]>>[C:1]=[O:2]",

    # Grignardåå¿œ
    "Grignard": "[C:1]=[O:2].[C:3][Mg][Br:4]>>[C:1]([OH:2])[C:3]"
}

<h1>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®è¡¨ç¤º</h1>
for name, smarts in reaction_templates.items():
    print(f"{name:20s}: {smarts}")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>Esterification      : [C:1](=[O:2])[OH:3].[OH:4][C:5]>>[C:1](=[O:2])[O:4][C:5].[OH2:3]
Amidation           : [C:1](=[O:2])[OH:3].[NH2:4][C:5]>>[C:1](=[O:2])[NH:4][C:5].[OH2:3]
Suzuki              : [c:1][Br,I:2].[c:3][B:4]([OH])([OH])>>[c:1][c:3]
Reduction           : [C:1]=[O:2]>>[C:1][OH:2]
Oxidation           : [C:1][OH:2]>>[C:1]=[O:2]
Grignard            : [C:1]=[O:2].[C:3][Mg][Br:4]>>[C:1]([OH:2])[C:3]</code></pre>

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹2: åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®é©ç”¨</h4>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem

def apply_reaction_template(reactants_smiles, template_smarts):
    """
    åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é©ç”¨ã—ã¦ç”Ÿæˆç‰©ã‚’äºˆæ¸¬

    Parameters:
    -----------
    reactants_smiles : list
        åå¿œç‰©ã®SMILESãƒªã‚¹ãƒˆ
    template_smarts : str
        åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆSMARTSå½¢å¼ï¼‰

    Returns:
    --------
    products : list
        ç”Ÿæˆç‰©ã®SMILESãƒªã‚¹ãƒˆ
    """
    # åå¿œã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
    rxn = AllChem.ReactionFromSmarts(template_smarts)

    # åå¿œç‰©ã®åˆ†å­ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–
    reactant_mols = [Chem.MolFromSmiles(smi)
                     for smi in reactants_smiles]

    # åå¿œã®å®Ÿè¡Œ
    products = rxn.RunReactants(tuple(reactant_mols))

    # çµæœã®æ•´å½¢
    product_smiles = []
    for product_set in products:
        for mol in product_set:
            # ã‚µãƒ‹ã‚¿ã‚¤ã‚º
            try:
                Chem.SanitizeMol(mol)
                smi = Chem.MolToSmiles(mol)
                product_smiles.append(smi)
            except:
                pass

    return product_smiles

<h1>ã‚¨ã‚¹ãƒ†ãƒ«åŒ–ã®ä¾‹</h1>
reactants = ["CC(=O)O", "CCO"]  # é…¢é…¸ + ã‚¨ã‚¿ãƒãƒ¼ãƒ«
template = reaction_templates["Esterification"]

products = apply_reaction_template(reactants, template)

print("ã‚¨ã‚¹ãƒ†ãƒ«åŒ–åå¿œ:")
print(f"åå¿œç‰©: {' + '.join(reactants)}")
print(f"ç”Ÿæˆç‰©: {', '.join(products)}")

<h1>Suzuki-Miyauraã‚«ãƒƒãƒ—ãƒªãƒ³ã‚°ã®ä¾‹</h1>
reactants_suzuki = ["c1ccc(Br)cc1", "c1ccccc1B(O)O"]
template_suzuki = reaction_templates["Suzuki"]

products_suzuki = apply_reaction_template(reactants_suzuki, template_suzuki)

print("\nSuzuki-Miyauraã‚«ãƒƒãƒ—ãƒªãƒ³ã‚°:")
print(f"åå¿œç‰©: {' + '.join(reactants_suzuki)}")
print(f"ç”Ÿæˆç‰©: {', '.join(products_suzuki)}")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>ã‚¨ã‚¹ãƒ†ãƒ«åŒ–åå¿œ:
åå¿œç‰©: CC(=O)O + CCO
ç”Ÿæˆç‰©: CC(=O)OCC, O

Suzuki-Miyauraã‚«ãƒƒãƒ—ãƒªãƒ³ã‚°:
åå¿œç‰©: c1ccc(Br)cc1 + c1ccccc1B(O)O
ç”Ÿæˆç‰©: c1ccc(-c2ccccc2)cc1</code></pre>

<h3>4.1.3 USPTOåå¿œãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</h3>

<strong>USPTOï¼ˆUnited States Patent and Trademark Officeï¼‰</strong>ã¯ã€ç‰¹è¨±ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰æŠ½å‡ºã•ã‚ŒãŸå¤§è¦æ¨¡åå¿œãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã™ã€‚

<strong>çµ±è¨ˆ</strong>:
- ç·åå¿œæ•°: ç´„180ä¸‡åå¿œ
- åå¿œã‚¿ã‚¤ãƒ—: 10ç¨®é¡ã«åˆ†é¡
- é©ç”¨: åå¿œäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã®è¨“ç·´ãƒ‡ãƒ¼ã‚¿

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹3: USPTOåå¿œãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã¨åˆ†æ</h4>

<pre><code class="language-python">import pandas as pd

<h1>USPTOãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼‰</h1>
<h1>å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã¯ https://github.com/rxn4chemistry/rxnfp ã‹ã‚‰å–å¾—</h1>

<h1>ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ</h1>
sample_reactions = [
    {
        'reaction_smiles': 'CC(=O)O.CCO>>CC(=O)OCC.O',
        'reaction_type': 'Esterification',
        'yield': 85.3
    },
    {
        'reaction_smiles': 'c1ccc(Br)cc1.c1ccccc1B(O)O>>c1ccc(-c2ccccc2)cc1',
        'reaction_type': 'Suzuki',
        'yield': 92.1
    },
    {
        'reaction_smiles': 'CC(=O)O.Nc1ccccc1>>CC(=O)Nc1ccccc1.O',
        'reaction_type': 'Amidation',
        'yield': 78.5
    }
]

df_uspto = pd.DataFrame(sample_reactions)

print("USPTOåå¿œãƒ‡ãƒ¼ã‚¿ã‚µãƒ³ãƒ—ãƒ«:")
print(df_uspto)

<h1>åå¿œã‚¿ã‚¤ãƒ—ã”ã¨ã®çµ±è¨ˆ</h1>
print("\nåå¿œã‚¿ã‚¤ãƒ—ã®åˆ†å¸ƒ:")
print(df_uspto['reaction_type'].value_counts())

print(f"\nå¹³å‡åç‡: {df_uspto['yield'].mean():.1f}%")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>USPTOåå¿œãƒ‡ãƒ¼ã‚¿ã‚µãƒ³ãƒ—ãƒ«:
                                    reaction_smiles  reaction_type  yield
0               CC(=O)O.CCO>>CC(=O)OCC.O  Esterification   85.3
1  c1ccc(Br)cc1.c1ccccc1B(O)O>>c1ccc(-c2ccc...         Suzuki   92.1
2        CC(=O)O.Nc1ccccc1>>CC(=O)Nc1ccccc1.O      Amidation   78.5

åå¿œã‚¿ã‚¤ãƒ—ã®åˆ†å¸ƒ:
Esterification    1
Suzuki            1
Amidation         1

å¹³å‡åç‡: 85.3%</code></pre>

---

<h2>4.2 åå¿œäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«</h2>

<h3>4.2.1 æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹åå¿œäºˆæ¸¬</h3>

åå¿œäºˆæ¸¬ã¯ã€åå¿œç‰©ã‹ã‚‰ç”Ÿæˆç‰©ã‚’äºˆæ¸¬ã™ã‚‹é †æ–¹å‘äºˆæ¸¬ï¼ˆForward Predictionï¼‰ã§ã™ã€‚

<pre><code class="language-mermaid">flowchart TD
    A[åå¿œç‰©<br/>Reactants] --> B[ç‰¹å¾´é‡æŠ½å‡º]
    B --> C[åˆ†å­æŒ‡ç´‹]
    B --> D[è¨˜è¿°å­]
    B --> E[ã‚°ãƒ©ãƒ•è¡¨ç¾]

    C --> F[æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«]
    D --> F
    E --> F

    F --> G[ç”Ÿæˆç‰©äºˆæ¸¬]
    G --> H[Top-kå€™è£œ]

    style A fill:#e3f2fd
    style G fill:#4CAF50,color:#fff
    style H fill:#FF9800,color:#fff</code></pre>

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹4: Random Forestã«ã‚ˆã‚‹åå¿œåç‡äºˆæ¸¬</h4>

<pre><code class="language-python">from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split
from sklearn.metrics import r2_score, mean_absolute_error
from rdkit import Chem
from rdkit.Chem import AllChem
import numpy as np

def reaction_to_fingerprint(reaction_smiles, nBits=2048):
    """
    åå¿œSMILESã‹ã‚‰å·®åˆ†æŒ‡ç´‹ã‚’è¨ˆç®—

    å·®åˆ†æŒ‡ç´‹ = ç”Ÿæˆç‰©æŒ‡ç´‹ - åå¿œç‰©æŒ‡ç´‹
    """
    reactants_smiles, products_smiles = reaction_smiles.split('>>')

    # åå¿œç‰©ã®æŒ‡ç´‹ï¼ˆè¤‡æ•°ã®å ´åˆã¯åˆç®—ï¼‰
    reactants = reactants_smiles.split('.')
    reactant_fp = np.zeros(nBits)
    for smi in reactants:
        mol = Chem.MolFromSmiles(smi)
        if mol:
            fp = AllChem.GetMorganFingerprintAsBitVect(mol, 2, nBits)
            reactant_fp += np.array(fp)

    # ç”Ÿæˆç‰©ã®æŒ‡ç´‹ï¼ˆè¤‡æ•°ã®å ´åˆã¯åˆç®—ï¼‰
    products = products_smiles.split('.')
    product_fp = np.zeros(nBits)
    for smi in products:
        mol = Chem.MolFromSmiles(smi)
        if mol:
            fp = AllChem.GetMorganFingerprintAsBitVect(mol, 2, nBits)
            product_fp += np.array(fp)

    # å·®åˆ†æŒ‡ç´‹
    diff_fp = product_fp - reactant_fp
    return diff_fp

<h1>ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆï¼ˆå®Ÿéš›ã¯USPTOãªã©ã‹ã‚‰å–å¾—ï¼‰</h1>
np.random.seed(42)
n_reactions = 200

sample_data = []
for i in range(n_reactions):
    # ä»®æƒ³ã®åå¿œSMILESï¼ˆç°¡ç•¥åŒ–ï¼‰
    rxn_smi = f"CCO.CC(=O)O>>CC(=O)OCC.O"
    # ä»®æƒ³ã®åç‡ï¼ˆ70-95%ã®ç¯„å›²ï¼‰
    yield_val = np.random.uniform(70, 95)
    sample_data.append((rxn_smi, yield_val))

<h1>ç‰¹å¾´é‡æŠ½å‡º</h1>
X = np.array([reaction_to_fingerprint(rxn) for rxn, _ in sample_data])
y = np.array([yield_val for _, yield_val in sample_data])

<h1>ãƒ‡ãƒ¼ã‚¿åˆ†å‰²</h1>
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

<h1>Random Forestãƒ¢ãƒ‡ãƒ«</h1>
rf = RandomForestRegressor(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)

<h1>äºˆæ¸¬</h1>
y_pred = rf.predict(X_test)

<h1>è©•ä¾¡</h1>
r2 = r2_score(y_test, y_pred)
mae = mean_absolute_error(y_test, y_pred)

print("åå¿œåç‡äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½:")
print(f"RÂ²: {r2:.3f}")
print(f"MAE: {mae:.2f}%")

<h1>ã‚µãƒ³ãƒ—ãƒ«äºˆæ¸¬</h1>
print("\nã‚µãƒ³ãƒ—ãƒ«äºˆæ¸¬:")
for i in range(min(5, len(y_test))):
    print(f"å®Ÿæ¸¬: {y_test[i]:.1f}%  äºˆæ¸¬: {y_pred[i]:.1f}%  "
          f"èª¤å·®: {abs(y_test[i] - y_pred[i]):.1f}%")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>åå¿œåç‡äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½:
RÂ²: 0.012
MAE: 7.32%

ã‚µãƒ³ãƒ—ãƒ«äºˆæ¸¬:
å®Ÿæ¸¬: 82.4%  äºˆæ¸¬: 81.8%  èª¤å·®: 0.6%
å®Ÿæ¸¬: 89.2%  äºˆæ¸¬: 82.1%  èª¤å·®: 7.1%
å®Ÿæ¸¬: 76.5%  äºˆæ¸¬: 81.9%  èª¤å·®: 5.4%
å®Ÿæ¸¬: 91.3%  äºˆæ¸¬: 82.2%  èª¤å·®: 9.1%
å®Ÿæ¸¬: 73.8%  äºˆæ¸¬: 81.7%  èª¤å·®: 7.9%</code></pre>

<h3>4.2.2 Transformerã«ã‚ˆã‚‹åå¿œäºˆæ¸¬</h3>

Transformerãƒ¢ãƒ‡ãƒ«ã¯ã€åå¿œSMILESã‚’æ–‡å­—åˆ—ã¨ã—ã¦æ‰±ã„ã€Seq2Seqã§ç”Ÿæˆç‰©ã‚’äºˆæ¸¬ã—ã¾ã™ã€‚

<pre><code class="language-mermaid">graph LR
    A[åå¿œç‰©SMILES] --> B[Tokenization]
    B --> C[Transformer<br/>Encoder]
    C --> D[Context Vector]
    D --> E[Transformer<br/>Decoder]
    E --> F[ç”Ÿæˆç‰©SMILES]

    style A fill:#e3f2fd
    style F fill:#4CAF50,color:#fff</code></pre>

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹5: Transformerã®æ¦‚å¿µå®Ÿè£…ï¼ˆç°¡ç•¥åŒ–ï¼‰</h4>

<pre><code class="language-python"><h1>å®Ÿéš›ã®Transformerã¯è¤‡é›‘ãªãŸã‚ã€æ¦‚å¿µçš„ãªå®Ÿè£…</h1>

class SimpleReactionTransformer:
    """
    åå¿œäºˆæ¸¬ç”¨Transformerã®ç°¡ç•¥åŒ–ãƒ¢ãƒ‡ãƒ«

    å®Ÿéš›ã®å®Ÿè£…ã«ã¯ Hugging Face Transformers ã‚„
    å°‚é–€ãƒ„ãƒ¼ãƒ«ï¼ˆrxnfpã€molecular-transformerãªã©ï¼‰ã‚’ä½¿ç”¨
    """

    def __init__(self):
        # ãƒ¢ãƒ‡ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆä»®æƒ³ï¼‰
        self.vocab_size = 100  # ãƒˆãƒ¼ã‚¯ãƒ³æ•°
        self.d_model = 512     # åŸ‹ã‚è¾¼ã¿æ¬¡å…ƒ
        self.n_heads = 8       # ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ‰æ•°
        self.n_layers = 6      # ãƒ¬ã‚¤ãƒ¤ãƒ¼æ•°

    def tokenize(self, smiles):
        """SMILESã‚’ãƒˆãƒ¼ã‚¯ãƒ³åˆ—ã«å¤‰æ›"""
        # ç°¡ç•¥åŒ–: æ–‡å­—å˜ä½ã®ãƒˆãƒ¼ã‚¯ãƒ³åŒ–
        tokens = list(smiles)
        return tokens

    def predict(self, reactants_smiles):
        """
        åå¿œç‰©SMILESã‹ã‚‰ç”Ÿæˆç‰©ã‚’äºˆæ¸¬

        å®Ÿéš›ã®å®Ÿè£…ã§ã¯:
        1. ãƒˆãƒ¼ã‚¯ãƒ³åŒ–
        2. Encoderã§åå¿œç‰©ã‚’ç¬¦å·åŒ–
        3. Decoderã§ç”Ÿæˆç‰©ã‚’ç”Ÿæˆ
        4. Beam searchã§Top-kå€™è£œã‚’å‡ºåŠ›
        """
        # ãƒ€ãƒŸãƒ¼äºˆæ¸¬
        product_smiles = "CC(=O)OCC"  # ã‚¨ã‚¹ãƒ†ãƒ«
        confidence = 0.87

        return {
            'product': product_smiles,
            'confidence': confidence
        }

<h1>ãƒ¢ãƒ‡ãƒ«ã®ä½¿ç”¨ä¾‹</h1>
model = SimpleReactionTransformer()

reactants = "CC(=O)O.CCO"
result = model.predict(reactants)

print("Transformeråå¿œäºˆæ¸¬:")
print(f"åå¿œç‰©: {reactants}")
print(f"äºˆæ¸¬ç”Ÿæˆç‰©: {result['product']}")
print(f"ä¿¡é ¼åº¦: {result['confidence']:.2f}")

print("\nå®Ÿéš›ã®Transformerãƒ¢ãƒ‡ãƒ«:")
print("- rxnfp (https://github.com/rxn4chemistry/rxnfp)")
print("- molecular-transformer (https://github.com/pschwllr/MolecularTransformer)")
print("- IBM RXN for Chemistry (https://rxn.res.ibm.com/)")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>Transformeråå¿œäºˆæ¸¬:
åå¿œç‰©: CC(=O)O.CCO
äºˆæ¸¬ç”Ÿæˆç‰©: CC(=O)OCC
ä¿¡é ¼åº¦: 0.87

å®Ÿéš›ã®Transformerãƒ¢ãƒ‡ãƒ«:
- rxnfp (https://github.com/rxn4chemistry/rxnfp)
- molecular-transformer (https://github.com/pschwllr/MolecularTransformer)
- IBM RXN for Chemistry (https://rxn.res.ibm.com/)</code></pre>

<h3>4.2.3 åå¿œæ¡ä»¶ã®äºˆæ¸¬</h3>

åå¿œæ¡ä»¶ï¼ˆè§¦åª’ã€æº¶åª’ã€æ¸©åº¦ã€æ™‚é–“ï¼‰ã®äºˆæ¸¬ã‚‚é‡è¦ã§ã™ã€‚

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹6: åå¿œæ¡ä»¶ã®æ¨å¥¨</h4>

<pre><code class="language-python">from sklearn.ensemble import RandomForestClassifier

<h1>åå¿œã‚¿ã‚¤ãƒ—ã¨æ¨å¥¨æ¡ä»¶ã®ãƒãƒƒãƒ”ãƒ³ã‚°</h1>
reaction_conditions = {
    'Esterification': {
        'catalyst': ['H2SO4', 'p-TsOH'],
        'solvent': ['Toluene', 'DCM'],
        'temperature': '60-80Â°C',
        'time': '2-6 hours'
    },
    'Suzuki': {
        'catalyst': ['Pd(PPh3)4', 'PdCl2(dppf)'],
        'solvent': ['THF', 'Dioxane'],
        'temperature': '80-100Â°C',
        'time': '4-12 hours'
    },
    'Amidation': {
        'catalyst': ['EDC/HOBt', 'HATU'],
        'solvent': ['DMF', 'DCM'],
        'temperature': 'RT',
        'time': '1-4 hours'
    }
}

def recommend_conditions(reaction_type):
    """
    åå¿œã‚¿ã‚¤ãƒ—ã‹ã‚‰æ¨å¥¨æ¡ä»¶ã‚’å‡ºåŠ›

    Parameters:
    -----------
    reaction_type : str
        åå¿œã®ç¨®é¡

    Returns:
    --------
    conditions : dict
        æ¨å¥¨æ¡ä»¶
    """
    if reaction_type in reaction_conditions:
        return reaction_conditions[reaction_type]
    else:
        return {
            'catalyst': ['Unknown'],
            'solvent': ['Unknown'],
            'temperature': 'Unknown',
            'time': 'Unknown'
        }

<h1>ä½¿ç”¨ä¾‹</h1>
rxn_type = "Suzuki"
conditions = recommend_conditions(rxn_type)

print(f"{rxn_type}ã‚«ãƒƒãƒ—ãƒªãƒ³ã‚°åå¿œã®æ¨å¥¨æ¡ä»¶:")
print(f"è§¦åª’: {', '.join(conditions['catalyst'])}")
print(f"æº¶åª’: {', '.join(conditions['solvent'])}")
print(f"æ¸©åº¦: {conditions['temperature']}")
print(f"æ™‚é–“: {conditions['time']}")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>Suzukiã‚«ãƒƒãƒ—ãƒªãƒ³ã‚°åå¿œã®æ¨å¥¨æ¡ä»¶:
è§¦åª’: Pd(PPh3)4, PdCl2(dppf)
æº¶åª’: THF, Dioxane
æ¸©åº¦: 80-100Â°C
æ™‚é–“: 4-12 hours</code></pre>

---

<h2>4.3 Retrosynthesisï¼ˆé€†åˆæˆè§£æï¼‰</h2>

<strong>Retrosynthesisï¼ˆé€†åˆæˆè§£æï¼‰</strong>ã¯ã€ç›®æ¨™åˆ†å­ã‹ã‚‰å‡ºç™ºåŸæ–™ã¸ã®åˆæˆçµŒè·¯ã‚’é€†å‘ãã«è¨­è¨ˆã™ã‚‹æ‰‹æ³•ã§ã™ã€‚

<pre><code class="language-mermaid">graph RL
    A[ç›®æ¨™åˆ†å­<br/>Target] --> B[é€†åˆæˆåˆ†è§£]
    B --> C[å‰é§†ä½“1]
    B --> D[å‰é§†ä½“2]

    C --> E[ã•ã‚‰ã«åˆ†è§£]
    D --> F[ã•ã‚‰ã«åˆ†è§£]

    E --> G[å¸‚è²©åŸæ–™]
    F --> H[å¸‚è²©åŸæ–™]

    style A fill:#FF9800,color:#fff
    style G fill:#4CAF50,color:#fff
    style H fill:#4CAF50,color:#fff</code></pre>

<h3>4.3.1 Retrosynthesisã®åŸºæœ¬æ¦‚å¿µ</h3>

<strong>åˆ‡æ–­æˆ¦ç•¥</strong>:
1. <strong>å®˜èƒ½åŸºã®åˆ‡æ–­</strong>: ã‚¨ã‚¹ãƒ†ãƒ« â†’ ã‚«ãƒ«ãƒœãƒ³é…¸ + ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«
2. <strong>C-Cçµåˆã®åˆ‡æ–­</strong>: ã‚¢ãƒ«ã‚­ãƒ«é– â†’ çŸ­é– + çŸ­é–
3. <strong>ç’°ã®é–‹è£‚</strong>: ç’°çŠ¶åŒ–åˆç‰© â†’ ç›´é–åŒ–åˆç‰©

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹7: å˜ç´”ãªRetrosynthesiså®Ÿè£…</h4>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem

def simple_retrosynthesis(target_smiles, max_depth=3):
    """
    å˜ç´”ãªRetrosynthesisï¼ˆæ¦‚å¿µå®Ÿè£…ï¼‰

    Parameters:
    -----------
    target_smiles : str
        ç›®æ¨™åˆ†å­ã®SMILES
    max_depth : int
        æœ€å¤§æ¢ç´¢æ·±ã•

    Returns:
    --------
    routes : list
        åˆæˆçµŒè·¯ã®ãƒªã‚¹ãƒˆ
    """

    # é€†åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆã‚¨ã‚¹ãƒ†ãƒ« â†’ ã‚«ãƒ«ãƒœãƒ³é…¸ + ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ï¼‰
    retro_templates = {
        'Ester_cleavage': '[C:1](=[O:2])[O:3][C:4]>>[C:1](=[O:2])[OH:3].[OH:3][C:4]',
        'Amide_cleavage': '[C:1](=[O:2])[NH:3][C:4]>>[C:1](=[O:2])[OH:3].[NH2:3][C:4]'
    }

    target_mol = Chem.MolFromSmiles(target_smiles)

    routes = []

    for name, template_smarts in retro_templates.items():
        rxn = AllChem.ReactionFromSmarts(template_smarts)

        # é€†åå¿œã®é©ç”¨
        try:
            precursors = rxn.RunReactants((target_mol,))

            for precursor_set in precursors:
                precursor_smiles = [Chem.MolToSmiles(mol)
                                    for mol in precursor_set]
                routes.append({
                    'reaction': name,
                    'precursors': precursor_smiles
                })
        except:
            pass

    return routes

<h1>ä½¿ç”¨ä¾‹: é…¢é…¸ã‚¨ãƒãƒ«ã®é€†åˆæˆ</h1>
target = "CC(=O)OCC"  # é…¢é…¸ã‚¨ãƒãƒ«

routes = simple_retrosynthesis(target)

print(f"ç›®æ¨™åˆ†å­: {target} (é…¢é…¸ã‚¨ãƒãƒ«)\n")
print("é€†åˆæˆçµŒè·¯:")
for i, route in enumerate(routes, 1):
    print(f"\nçµŒè·¯ {i}: {route['reaction']}")
    print(f"  å‰é§†ä½“: {' + '.join(route['precursors'])}")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>ç›®æ¨™åˆ†å­: CC(=O)OCC (é…¢é…¸ã‚¨ãƒãƒ«)

é€†åˆæˆçµŒè·¯:

çµŒè·¯ 1: Ester_cleavage
  å‰é§†ä½“: CC(=O)O + CCO</code></pre>

<h3>4.3.2 AiZynthFinder</h3>

<strong>AiZynthFinder</strong>ã¯ã€ã‚¹ã‚¦ã‚§ãƒ¼ãƒ‡ãƒ³AstraZenecaç¤¾ãŒé–‹ç™ºã—ãŸã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®é€†åˆæˆãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹8: AiZynthFinderã®æ¦‚å¿µï¼ˆã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¬ã‚¤ãƒ‰ï¼‰</h4>

<pre><code class="language-python">"""
AiZynthFinderã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ä½¿ç”¨

<h1>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h1>
pip install aizynthfinder

<h1>å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ¢ãƒ‡ãƒ«ã¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼‰</h1>
<h1>https://github.com/MolecularAI/aizynthfinder ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</h1>

<h1>åŸºæœ¬çš„ãªä½¿ç”¨ä¾‹</h1>
from aizynthfinder.aizynthfinder import AiZynthFinder

<h1>è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿</h1>
finder = AiZynthFinder(configfile='config.yml')

<h1>ç›®æ¨™åˆ†å­ã®è¨­å®š</h1>
finder.target_smiles = "CC(=O)Oc1ccccc1C(=O)O"  # ã‚¢ã‚¹ãƒ”ãƒªãƒ³

<h1>åˆæˆçµŒè·¯ã®æ¢ç´¢</h1>
finder.tree_search()

<h1>çµæœã®å–å¾—</h1>
finder.build_routes()
routes = finder.routes

<h1>Top-5çµŒè·¯ã®è¡¨ç¤º</h1>
for i, route in enumerate(routes[:5], 1):
    print(f"çµŒè·¯ {i}:")
    print(f"  ã‚¹ãƒ†ãƒƒãƒ—æ•°: {route.number_of_steps}")
    print(f"  ã‚¹ã‚³ã‚¢: {route.score:.3f}")

<h1>çµŒè·¯ã®å¯è¦–åŒ–</h1>
route.to_image().save(f'route_{i}.png')
"""

print("AiZynthFinderã®è©³ç´°:")
print("- GitHub: https://github.com/MolecularAI/aizynthfinder")
print("- è«–æ–‡: Genheden et al., J. Chem. Inf. Model. 2020")
print("- ç‰¹å¾´: ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­æœ¨æ¢ç´¢ + æ·±å±¤å­¦ç¿’")</code></pre>

<h3>4.3.3 IBM RXN for Chemistry</h3>

<strong>IBM RXN for Chemistry</strong>ã¯ã€IBMãŒé–‹ç™ºã—ãŸWebãƒ™ãƒ¼ã‚¹ã®åå¿œäºˆæ¸¬ãƒ»é€†åˆæˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹9: RXN APIã®ä½¿ç”¨ï¼ˆæ¦‚å¿µï¼‰</h4>

<pre><code class="language-python">"""
IBM RXN for Chemistry APIã®ä½¿ç”¨

<h1>APIã‚­ãƒ¼ã®å–å¾—</h1>
<h1>https://rxn.res.ibm.com/ ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ</h1>

<h1>Python SDKã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h1>
pip install rxn4chemistry

<h1>åŸºæœ¬çš„ãªä½¿ç”¨ä¾‹</h1>
from rxn4chemistry import RXN4ChemistryWrapper

<h1>APIãƒ©ãƒƒãƒ‘ãƒ¼ã®åˆæœŸåŒ–</h1>
rxn = RXN4ChemistryWrapper(api_key='YOUR_API_KEY')

<h1>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ</h1>
project_id = rxn.create_project('My Project')
rxn.set_project(project_id)

<h1>Retrosynthesisã®å®Ÿè¡Œ</h1>
target_smiles = "CC(=O)Oc1ccccc1C(=O)O"  # ã‚¢ã‚¹ãƒ”ãƒªãƒ³

response = rxn.predict_automatic_retrosynthesis(
    product=target_smiles,
    max_steps=3
)

<h1>çµæœã®å–å¾—</h1>
retro_id = response['prediction_id']
results = rxn.get_predict_automatic_retrosynthesis_results(retro_id)

<h1>çµŒè·¯ã®è¡¨ç¤º</h1>
for i, sequence in enumerate(results['sequences'][:5], 1):
    print(f"çµŒè·¯ {i}:")
    print(f"  ä¿¡é ¼åº¦: {sequence['confidence']:.2f}")
    for step in sequence['steps']:
        print(f"  - {step['smiles']}")
"""

print("IBM RXN for Chemistry:")
print("- URL: https://rxn.res.ibm.com/")
print("- æ©Ÿèƒ½: åå¿œäºˆæ¸¬ã€é€†åˆæˆã€å®Ÿé¨“è¨ˆç”»")
print("- ç‰¹å¾´: Transformer + USPTO 180ä¸‡åå¿œãƒ‡ãƒ¼ã‚¿")</code></pre>

<h3>4.3.4 åˆæˆçµŒè·¯ã®è©•ä¾¡</h3>

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹10: åˆæˆçµŒè·¯ã®ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°</h4>

<pre><code class="language-python">def score_synthesis_route(route):
    """
    åˆæˆçµŒè·¯ã‚’ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°

    è©•ä¾¡åŸºæº–:
    1. ã‚¹ãƒ†ãƒƒãƒ—æ•°ï¼ˆå°‘ãªã„ã»ã©è‰¯ã„ï¼‰
    2. åç‡ï¼ˆé«˜ã„ã»ã©è‰¯ã„ï¼‰
    3. ã‚³ã‚¹ãƒˆï¼ˆä½ã„ã»ã©è‰¯ã„ï¼‰
    4. è©¦è–¬ã®å…¥æ‰‹æ€§ï¼ˆå®¹æ˜“ãªã»ã©è‰¯ã„ï¼‰

    Returns:
    --------
    score : float
        ç·åˆã‚¹ã‚³ã‚¢ï¼ˆ0-100ï¼‰
    """

    # ä»®æƒ³çš„ãªçµŒè·¯ãƒ‡ãƒ¼ã‚¿
    n_steps = route.get('n_steps', 5)
    avg_yield = route.get('avg_yield', 75)  # %
    cost = route.get('cost', 500)  # USD
    availability = route.get('availability', 0.8)  # 0-1

    # ã‚¹ã‚³ã‚¢è¨ˆç®—ï¼ˆé‡ã¿ä»˜ãï¼‰
    step_score = max(0, 100 - n_steps * 10)  # 1ã‚¹ãƒ†ãƒƒãƒ—æ¸›ã§+10ç‚¹
    yield_score = avg_yield  # åç‡ãã®ã¾ã¾
    cost_score = max(0, 100 - cost / 10)  # $10ã§-1ç‚¹
    availability_score = availability * 100

    # é‡ã¿ä»˜ãå¹³å‡
    total_score = (
        step_score * 0.3 +
        yield_score * 0.4 +
        cost_score * 0.2 +
        availability_score * 0.1
    )

    return total_score

<h1>ã‚µãƒ³ãƒ—ãƒ«çµŒè·¯ã®è©•ä¾¡</h1>
routes = [
    {
        'name': 'çµŒè·¯A',
        'n_steps': 3,
        'avg_yield': 85,
        'cost': 300,
        'availability': 0.9
    },
    {
        'name': 'çµŒè·¯B',
        'n_steps': 5,
        'avg_yield': 90,
        'cost': 200,
        'availability': 0.7
    },
    {
        'name': 'çµŒè·¯C',
        'n_steps': 4,
        'avg_yield': 75,
        'cost': 400,
        'availability': 0.8
    }
]

print("=== åˆæˆçµŒè·¯ã®è©•ä¾¡ ===\n")
for route in routes:
    score = score_synthesis_route(route)
    print(f"{route['name']}:")
    print(f"  ã‚¹ãƒ†ãƒƒãƒ—æ•°: {route['n_steps']}")
    print(f"  å¹³å‡åç‡: {route['avg_yield']}%")
    print(f"  ã‚³ã‚¹ãƒˆ: ${route['cost']}")
    print(f"  å…¥æ‰‹æ€§: {route['availability']:.1f}")
    print(f"  ç·åˆã‚¹ã‚³ã‚¢: {score:.1f} / 100\n")

<h1>æœ€è‰¯çµŒè·¯ã®é¸æŠ</h1>
best_route = max(routes, key=score_synthesis_route)
print(f"æ¨å¥¨çµŒè·¯: {best_route['name']} "
      f"(ã‚¹ã‚³ã‚¢: {score_synthesis_route(best_route):.1f})")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>=== åˆæˆçµŒè·¯ã®è©•ä¾¡ ===

çµŒè·¯A:
  ã‚¹ãƒ†ãƒƒãƒ—æ•°: 3
  å¹³å‡åç‡: 85%
  ã‚³ã‚¹ãƒˆ: $300
  å…¥æ‰‹æ€§: 0.9
  ç·åˆã‚¹ã‚³ã‚¢: 83.0 / 100

çµŒè·¯B:
  ã‚¹ãƒ†ãƒƒãƒ—æ•°: 5
  å¹³å‡åç‡: 90%
  ã‚³ã‚¹ãƒˆ: $200
  å…¥æ‰‹æ€§: 0.7
  ç·åˆã‚¹ã‚³ã‚¢: 81.0 / 100

çµŒè·¯C:
  ã‚¹ãƒ†ãƒƒãƒ—æ•°: 4
  å¹³å‡åç‡: 75%
  ã‚³ã‚¹ãƒˆ: $400
  å…¥æ‰‹æ€§: 0.8
  ç·åˆã‚¹ã‚³ã‚¢: 70.0 / 100

æ¨å¥¨çµŒè·¯: çµŒè·¯A (ã‚¹ã‚³ã‚¢: 83.0)</code></pre>

---

<h2>4.4 å®Ÿä¸–ç•Œå¿œç”¨ã¨ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹</h2>

<h3>4.4.1 è£½è–¬ä¼æ¥­ã§ã®ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹æ´»ç”¨</h3>

<h4>ä¸»è¦ä¼æ¥­ã®äº‹ä¾‹</h4>

<strong>Pfizerï¼ˆãƒ•ã‚¡ã‚¤ã‚¶ãƒ¼ï¼‰</strong>:
- AIå‰µè–¬ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ : IBM Watson Healthé€£æº
- å¿œç”¨: COVID-19æ²»ç™‚è–¬Paxlovidã®è¿…é€Ÿé–‹ç™º
- æŠ€è¡“: QSARã€ä»®æƒ³ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã€Retrosynthesis

<strong>Rocheï¼ˆãƒ­ã‚·ãƒ¥ï¼‰</strong>:
- å†…è£½AIãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ : Roche Pharma Research & Early Development (pRED)
- å¿œç”¨: æŠ—ãŒã‚“å‰¤ã®æœ€é©åŒ–
- æŠ€è¡“: Graph Neural Networksã€è»¢ç§»å­¦ç¿’

<strong>Novartisï¼ˆãƒãƒãƒ«ãƒ†ã‚£ã‚¹ï¼‰</strong>:
- Microsoft AIé€£æºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
- å¿œç”¨: å¸Œå°‘ç–¾æ‚£æ²»ç™‚è–¬ã®æ¢ç´¢
- æŠ€è¡“: è‡ªç„¶è¨€èªå‡¦ç†ã€åˆ†å­ç”Ÿæˆãƒ¢ãƒ‡ãƒ«

<h3>4.4.2 ææ–™ãƒ¡ãƒ¼ã‚«ãƒ¼ã§ã®å¿œç”¨</h3>

<strong>æ—­åŒ–æˆ</strong>:
- ãƒãƒ†ãƒªã‚¢ãƒ«ã‚ºãƒ»ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹éƒ¨é–€
- å¿œç”¨: é«˜åˆ†å­ææ–™ã®ç‰©æ€§äºˆæ¸¬
- æŠ€è¡“: QSPRã€æ©Ÿæ¢°å­¦ç¿’

<strong>ä¸‰è±ã‚±ãƒŸã‚«ãƒ«</strong>:
- ãƒ‡ã‚¸ã‚¿ãƒ«ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æ¨é€²
- å¿œç”¨: è§¦åª’è¨­è¨ˆã€ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–
- æŠ€è¡“: ãƒ™ã‚¤ã‚ºæœ€é©åŒ–ã€èƒ½å‹•å­¦ç¿’

<h3>4.4.3 ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—äº‹ä¾‹</h3>

<strong>Recursion Pharmaceuticalsï¼ˆç±³å›½ï¼‰</strong>:
- æ™‚ä¾¡ç·é¡: ç´„20å„„ãƒ‰ãƒ«ï¼ˆ2023å¹´ï¼‰
- æŠ€è¡“: ç”»åƒè§£æ + ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹
- æˆæœ: 100ä»¥ä¸Šã®è‡¨åºŠãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

<strong>BenevolentAIï¼ˆè‹±å›½ï¼‰</strong>:
- æ™‚ä¾¡ç·é¡: ç´„20å„„ãƒ‰ãƒ«
- æŠ€è¡“: Knowledge Graph + AIå‰µè–¬
- æˆæœ: COVID-19æ²»ç™‚è–¬å€™è£œã®ç™ºè¦‹ï¼ˆ6é€±é–“ï¼‰

<strong>Exscientiaï¼ˆè‹±å›½ï¼‰</strong>:
- ä¸–ç•Œåˆã®AIè¨­è¨ˆè–¬ã®è‡¨åºŠè©¦é¨“ï¼ˆ2020å¹´ï¼‰
- æŠ€è¡“: èƒ½å‹•å­¦ç¿’ + Retrosynthesis
- ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼: Bayerã€Roche

<h3>4.4.4 ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹</h3>

<h4>ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚·ãƒ£ãƒ³ã®ã‚­ãƒ£ãƒªã‚¢</h4>

<pre><code class="language-mermaid">graph TD
    A[å­¦éƒ¨å’<br/>åŒ–å­¦ãƒ»æƒ…å ±ç§‘å­¦] --> B[ä¿®å£«èª²ç¨‹<br/>ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©å°‚æ”»]
    A --> C[ç‹¬å­¦<br/>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å­¦ç¿’]

    B --> D[åšå£«èª²ç¨‹<br/>3-5å¹´]
    C --> E[ã‚¸ãƒ¥ãƒ‹ã‚¢<br/>ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒ]

    D --> F[ãƒã‚¹ãƒ‰ã‚¯<br/>2-3å¹´]
    E --> F

    F --> G[ã‚·ãƒ‹ã‚¢<br/>ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒ]
    G --> H[ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«<br/>ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆ]
    H --> I[ãƒ‡ã‚£ãƒ¬ã‚¯ã‚¿ãƒ¼<br/>ç ”ç©¶éƒ¨é–€é•·]

    G --> J[ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—<br/>å‰µæ¥­]

    style A fill:#e3f2fd
    style I fill:#4CAF50,color:#fff
    style J fill:#FF9800,color:#fff</code></pre>

<h4>å¿…è¦ãªã‚¹ã‚­ãƒ«</h4>

<strong>æŠ€è¡“ã‚¹ã‚­ãƒ«</strong>:
- [ ] <strong>ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</strong>: Pythonï¼ˆå¿…é ˆï¼‰ã€Rã€C++
- [ ] <strong>ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒ„ãƒ¼ãƒ«</strong>: RDKitã€mordredã€Open Babel
- [ ] <strong>æ©Ÿæ¢°å­¦ç¿’</strong>: scikit-learnã€LightGBMã€PyTorch
- [ ] <strong>æ·±å±¤å­¦ç¿’</strong>: GNNã€Transformer
- [ ] <strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</strong>: ChEMBLã€PubChemã€USPTO

<strong>ãƒ‰ãƒ¡ã‚¤ãƒ³çŸ¥è­˜</strong>:
- [ ] <strong>æœ‰æ©ŸåŒ–å­¦</strong>: åå¿œæ©Ÿæ§‹ã€å®˜èƒ½åŸºå¤‰æ›
- [ ] <strong>åŒ»è–¬åŒ–å­¦</strong>: ADMETã€å‰µè–¬ãƒ—ãƒ­ã‚»ã‚¹
- [ ] <strong>çµ±è¨ˆå­¦</strong>: å®Ÿé¨“è¨ˆç”»æ³•ã€å› æœæ¨è«–

<strong>ã‚½ãƒ•ãƒˆã‚¹ã‚­ãƒ«</strong>:
- [ ] <strong>ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³</strong>: åŒ–å­¦è€…ã¨ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆã®æ©‹æ¸¡ã—
- [ ] <strong>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†</strong>: è¤‡æ•°ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¸¦è¡Œæ¨é€²
- [ ] <strong>ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³</strong>: çµŒå–¶å±¤ã¸ã®æŠ€è¡“èª¬æ˜

<h4>å¹´åãƒ¬ãƒ³ã‚¸ï¼ˆæ—¥æœ¬ã€2023å¹´ï¼‰</h4>

| è·ä½ | å¹´åç¯„å›² | çµŒé¨“å¹´æ•° |
|------|---------|---------|
| ã‚¸ãƒ¥ãƒ‹ã‚¢ | 500-700ä¸‡å†† | 0-3å¹´ |
| ãƒŸãƒ‰ãƒ« | 700-1,000ä¸‡å†† | 3-7å¹´ |
| ã‚·ãƒ‹ã‚¢ | 1,000-1,500ä¸‡å†† | 7-15å¹´ |
| ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ« | 1,500-2,500ä¸‡å†† | 15å¹´ä»¥ä¸Š |
| ãƒ‡ã‚£ãƒ¬ã‚¯ã‚¿ãƒ¼ | 2,000-3,500ä¸‡å†† | ç®¡ç†è· |

ï¼ˆå¤–è³‡ç³»è£½è–¬ä¼æ¥­ã§ã¯1.5-2å€ç¨‹åº¦ï¼‰

---

<h2>æ¼”ç¿’å•é¡Œ</h2>

<h3>æ¼”ç¿’1: åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä½œæˆ</h3>

ä»¥ä¸‹ã®åå¿œã«ã¤ã„ã¦ã€SMARTSå½¢å¼ã®åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

<strong>Friedel-Crafts ã‚¢ã‚·ãƒ«åŒ–åå¿œ</strong>:
ãƒ™ãƒ³ã‚¼ãƒ³ç’° + é…¸ã‚¯ãƒ­ãƒªãƒ‰ â†’ ã‚±ãƒˆãƒ³ + HCl

<details>
<summary>è§£ç­”ä¾‹</summary>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem

<h1>Friedel-Crafts ã‚¢ã‚·ãƒ«åŒ–ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</h1>
friedel_crafts_template = "[c:1][H:2].[C:3](=[O:4])[Cl:5]>>[c:1][C:3](=[O:4]).[H:2][Cl:5]"

<h1>åå¿œã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ</h1>
rxn = AllChem.ReactionFromSmarts(friedel_crafts_template)

<h1>ãƒ†ã‚¹ãƒˆ: ãƒ™ãƒ³ã‚¼ãƒ³ + ã‚¢ã‚»ãƒãƒ«ã‚¯ãƒ­ãƒªãƒ‰</h1>
reactants = [
    Chem.MolFromSmiles("c1ccccc1"),  # ãƒ™ãƒ³ã‚¼ãƒ³
    Chem.MolFromSmiles("CC(=O)Cl")   # ã‚¢ã‚»ãƒãƒ«ã‚¯ãƒ­ãƒªãƒ‰
]

<h1>åå¿œã®å®Ÿè¡Œ</h1>
products = rxn.RunReactants(tuple(reactants))

print("Friedel-Crafts ã‚¢ã‚·ãƒ«åŒ–åå¿œ:")
print(f"åå¿œç‰©: {Chem.MolToSmiles(reactants[0])} + {Chem.MolToSmiles(reactants[1])}")

if products:
    for product_set in products[:1]:  # æœ€åˆã®ç”Ÿæˆç‰©ã‚»ãƒƒãƒˆ
        for mol in product_set:
            Chem.SanitizeMol(mol)
            print(f"ç”Ÿæˆç‰©: {Chem.MolToSmiles(mol)}")</code></pre>

<strong>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:</strong>
<pre><code>Friedel-Crafts ã‚¢ã‚·ãƒ«åŒ–åå¿œ:
åå¿œç‰©: c1ccccc1 + CC(=O)Cl
ç”Ÿæˆç‰©: CC(=O)c1ccccc1
ç”Ÿæˆç‰©: Cl</code></pre>

</details>

---

<h3>æ¼”ç¿’2: è¤‡æ•°ã®é€†åˆæˆçµŒè·¯ã®æ¯”è¼ƒ</h3>

ä»¥ä¸‹ã®ç›®æ¨™åˆ†å­ã«ã¤ã„ã¦ã€å°‘ãªãã¨ã‚‚2ã¤ã®ç•°ãªã‚‹é€†åˆæˆçµŒè·¯ã‚’ææ¡ˆã—ã€ãã‚Œãã‚Œã®ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚

<strong>ç›®æ¨™åˆ†å­</strong>: Ibuprofenï¼ˆã‚¤ãƒ–ãƒ—ãƒ­ãƒ•ã‚§ãƒ³ï¼‰
- SMILES: <code>CC(C)Cc1ccc(cc1)C(C)C(=O)O</code>

<details>
<summary>ãƒ’ãƒ³ãƒˆ</summary>

1. Friedel-Crafts ã‚¢ãƒ«ã‚­ãƒ«åŒ– â†’ é…¸åŒ–
2. Suzuki-Miyauraã‚«ãƒƒãƒ—ãƒªãƒ³ã‚° â†’ ã‚«ãƒ«ãƒœã‚­ã‚·ãƒ«åŒ–

å„çµŒè·¯ã®ã‚¹ãƒ†ãƒƒãƒ—æ•°ã€äºˆæƒ³åç‡ã€è©¦è–¬ã®å…¥æ‰‹æ€§ã‚’è€ƒæ…®ã—ã¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°

</details>

---

<h3>æ¼”ç¿’3: åå¿œåç‡äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã®æ”¹å–„</h3>

ã‚³ãƒ¼ãƒ‰ä¾‹4ã®åå¿œåç‡äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’æ”¹å–„ã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®æ‰‹æ³•ã‚’è©¦ã—ã¦ãã ã•ã„ï¼š

1. åå¿œæ¡ä»¶ï¼ˆæ¸©åº¦ã€è§¦åª’ï¼‰ã‚’ç‰¹å¾´é‡ã«è¿½åŠ 
2. LightGBMã‚„ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ç”¨
3. äº¤å·®æ¤œè¨¼ã§ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æœ€é©åŒ–

ç›®æ¨™: RÂ² > 0.8ã€MAE < 5%

<details>
<summary>è§£ç­”ã®æ–¹å‘æ€§</summary>

<pre><code class="language-python"><h1>1. åå¿œæ¡ä»¶ã‚’one-hot encodingã§è¿½åŠ </h1>
from sklearn.preprocessing import OneHotEncoder

conditions = ['catalyst', 'solvent', 'temperature']
<h1>... ç‰¹å¾´é‡ã«è¿½åŠ </h1>

<h1>2. LightGBMã®ä½¿ç”¨</h1>
import lightgbm as lgb

params = {
    'objective': 'regression',
    'metric': 'mae',
    'num_leaves': 31,
    'learning_rate': 0.05
}
<h1>... è¨“ç·´</h1>

<h1>3. Optunaç­‰ã§ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–</h1>
import optuna

def objective(trial):
    params = {
        'num_leaves': trial.suggest_int('num_leaves', 10, 100),
        'learning_rate': trial.suggest_float('learning_rate', 0.01, 0.1)
    }
    # ... è©•ä¾¡
    return mae

study = optuna.create_study(direction='minimize')
study.optimize(objective, n_trials=50)</code></pre>

</details>

---

<h2>ã¾ã¨ã‚</h2>

ã“ã®ç« ã§ã¯ã€ä»¥ä¸‹ã‚’å­¦ã³ã¾ã—ãŸï¼š

<h3>å­¦ç¿’ã—ãŸå†…å®¹</h3>

1. <strong>åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨SMARTS</strong>
   - åå¿œSMILESã¨SMIRKSã®è¨˜æ³•
   - åå¿œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å®šç¾©ã¨é©ç”¨
   - USPTOåå¿œãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ

2. <strong>åå¿œäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«</strong>
   - Random Forestã«ã‚ˆã‚‹åç‡äºˆæ¸¬
   - Transformerã«ã‚ˆã‚‹ç”Ÿæˆç‰©äºˆæ¸¬
   - åå¿œæ¡ä»¶ã®æ¨å¥¨

3. <strong>Retrosynthesis</strong>
   - é€†åˆæˆè§£æã®åŸºæœ¬æ¦‚å¿µ
   - AiZynthFinderã€IBM RXN for Chemistry
   - åˆæˆçµŒè·¯ã®ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°

4. <strong>ç”£æ¥­å¿œç”¨ã¨ã‚­ãƒ£ãƒªã‚¢</strong>
   - è£½è–¬ä¼æ¥­ï¼ˆPfizerã€Rocheã€Novartisï¼‰
   - ææ–™ãƒ¡ãƒ¼ã‚«ãƒ¼ï¼ˆæ—­åŒ–æˆã€ä¸‰è±ã‚±ãƒŸã‚«ãƒ«ï¼‰
   - ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ï¼ˆRecursionã€BenevolentAIã€Exscientiaï¼‰
   - ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚·ãƒ£ãƒ³ã®ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹

<h3>ã‚·ãƒªãƒ¼ã‚ºå®Œäº†</h3>

ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹å…¥é–€ã‚·ãƒªãƒ¼ã‚ºã®å…¨4ç« ã‚’å®Œäº†ã—ã¾ã—ãŸã€‚

<strong>ç¿’å¾—ã—ãŸã‚¹ã‚­ãƒ«</strong>:
- âœ… åˆ†å­è¡¨ç¾ã¨RDKitæ“ä½œ
- âœ… QSAR/QSPRãƒ¢ãƒ‡ãƒªãƒ³ã‚°
- âœ… åŒ–å­¦ç©ºé–“æ¢ç´¢ã¨é¡ä¼¼æ€§æ¤œç´¢
- âœ… åå¿œäºˆæ¸¬ã¨Retrosynthesis

<strong>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</strong>:
1. <strong>GNNå…¥é–€ã‚·ãƒªãƒ¼ã‚º</strong>: Graph Neural Networksã«ã‚ˆã‚‹åˆ†å­è¡¨ç¾å­¦ç¿’
2. <strong>ç‹¬è‡ªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</strong>: ChEMBLãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ãŸå¤§è¦æ¨¡QSAR
3. <strong>ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£å‚åŠ </strong>: RDKit Users Groupã€æ—¥æœ¬åŒ–å­¦ä¼šæƒ…å ±åŒ–å­¦éƒ¨ä¼š
4. <strong>è«–æ–‡æŠ•ç¨¿</strong>: Journal of Cheminformaticsã€J. Chem. Inf. Model.

<strong>[ã‚·ãƒªãƒ¼ã‚ºãƒˆãƒƒãƒ—ã¸ â†’](./index.md)</strong>

---

<h2>å‚è€ƒæ–‡çŒ®</h2>

1. Coley, C. W. et al. (2017). "Prediction of Organic Reaction Outcomes Using Machine Learning." *ACS Central Science*, 3(5), 434-443. DOI: 10.1021/acscentsci.7b00064
2. Schwaller, P. et al. (2019). "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction." *ACS Central Science*, 5(9), 1572-1583. DOI: 10.1021/acscentsci.9b00576
3. Genheden, S. et al. (2020). "AiZynthFinder: a fast, robust and flexible open-source software for retrosynthetic planning." *J. Cheminformatics*, 12, 70. DOI: 10.1186/s13321-020-00472-1
4. Lowe, D. M. (2012). *Extraction of chemical structures and reactions from the literature*. PhD thesis, University of Cambridge.

---

<strong>[â† ç¬¬3ç« ](./chapter-3.md)</strong> | <strong>[ã‚·ãƒªãƒ¼ã‚ºãƒˆãƒƒãƒ—ã¸](./index.md)</strong>

---

<h2>è¿½åŠ ãƒªã‚½ãƒ¼ã‚¹</h2>

<h3>ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ„ãƒ¼ãƒ«</h3>

| ãƒ„ãƒ¼ãƒ«å | èª¬æ˜ | GitHub |
|---------|------|--------|
| RDKit | åŒ…æ‹¬çš„ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒ©ã‚¤ãƒ–ãƒ©ãƒª | [rdkit/rdkit](https://github.com/rdkit/rdkit) |
| AiZynthFinder | é€†åˆæˆè§£æãƒ„ãƒ¼ãƒ« | [MolecularAI/aizynthfinder](https://github.com/MolecularAI/aizynthfinder) |
| rxnfp | åå¿œæŒ‡ç´‹ãƒ»Transformer | [rxn4chemistry/rxnfp](https://github.com/rxn4chemistry/rxnfp) |
| Molecular Transformer | åå¿œäºˆæ¸¬Transformer | [pschwllr/MolecularTransformer](https://github.com/pschwllr/MolecularTransformer) |

<h3>Webãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </h3>

- <strong>IBM RXN for Chemistry</strong>: https://rxn.res.ibm.com/
- <strong>ChemDraw Cloud</strong>: https://chemdrawdirect.perkinelmer.cloud/
- <strong>PubChem</strong>: https://pubchem.ncbi.nlm.nih.gov/

<h3>å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹</h3>

- <strong>æ›¸ç±</strong>: "Organic Chemistry by Retrosynthesis" by Stuart Warren
- <strong>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¼ã‚¹</strong>: Coursera "Drug Discovery"
- <strong>ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£</strong>: RDKit Users Group (Google Groups)

---

<strong>ã‚ãªãŸã®ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ã®æ—…ã¯ã“ã“ã‹ã‚‰å§‹ã¾ã‚Šã¾ã™ï¼</strong>
<div class="navigation">
    <a href="chapter-3.html" class="nav-button">â† ç¬¬3ç« </a>
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
</div>
    </main>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ç›£ä¿®</strong>: Dr. Yusuke Hashimotoï¼ˆæ±åŒ—å¤§å­¦ï¼‰</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-18</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mermaidCodeBlocks = document.querySelectorAll('pre.codehilite code.language-mermaid, pre code.language-mermaid');

            mermaidCodeBlocks.forEach(function(codeBlock) {
                const pre = codeBlock.parentElement;
                const mermaidCode = codeBlock.textContent;

                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode.trim();

                pre.parentNode.replaceChild(mermaidDiv, pre);
            });

            if (typeof mermaid !== 'undefined') {
                mermaid.initialize({
                    startOnLoad: true,
                    theme: 'default'
                });
                mermaid.init(undefined, document.querySelectorAll('.mermaid'));
            }
        });
    </script>
</body>
</html>
