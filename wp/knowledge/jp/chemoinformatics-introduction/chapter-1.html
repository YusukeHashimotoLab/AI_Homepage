<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1ç« ï¼šåˆ†å­è¡¨ç¾ã¨RDKitåŸºç¤ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>åˆ†å­è¡¨ç¾ã¨RDKitåŸºç¤</h1>
            <p class="subtitle"></p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 25-30åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: å…¥é–€</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 10å€‹</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 4å•</span>
            </div>
        </div>
    </header>

    <main class="container">

<h1>ç¬¬1ç« ï¼šåˆ†å­è¡¨ç¾ã¨RDKitåŸºç¤</h1>

<h2>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h2>

ã“ã®ç« ã§ã¯ã€ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ã®åŸºç¤ã¨ã—ã¦ã€åˆ†å­ã®è¨ˆç®—æ©Ÿè¡¨ç¾ã¨RDKitã«ã‚ˆã‚‹åˆ†å­æ“ä½œã®åŸºæœ¬ã‚’å­¦ã³ã¾ã™ã€‚

<h3>å­¦ç¿’ç›®æ¨™</h3>

- âœ… ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ã®å®šç¾©ã¨å¿œç”¨åˆ†é‡ã‚’èª¬æ˜ã§ãã‚‹
- âœ… SMILESã€InChIã€åˆ†å­ã‚°ãƒ©ãƒ•ãªã©ä¸»è¦ãªåˆ†å­è¡¨ç¾æ³•ã‚’ç†è§£ã—ã¦ã„ã‚‹
- âœ… RDKitã§åˆ†å­ã‚’èª­ã¿è¾¼ã¿ã€æç”»ã€ç·¨é›†ã§ãã‚‹
- âœ… éƒ¨åˆ†æ§‹é€ æ¤œç´¢ï¼ˆSMARTSï¼‰ã‚’å®Ÿè¡Œã§ãã‚‹
- âœ… åŒ»è–¬å“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰åˆ†å­æƒ…å ±ã‚’å–å¾—ãƒ»å‡¦ç†ã§ãã‚‹

---

<h2>1.1 ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ã¨ã¯ä½•ã‹</h2>

<h3>å®šç¾©</h3>

<strong>ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ï¼ˆChemoinformaticsï¼‰</strong>ã¯ã€åŒ–å­¦ã¨ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ã‚’èåˆã—ãŸå­¦å•åˆ†é‡ã§ã‚ã‚Šã€è¨ˆç®—æ©Ÿã‚’ç”¨ã„ã¦åŒ–å­¦æƒ…å ±ã‚’ç®¡ç†ãƒ»åˆ†æãƒ»äºˆæ¸¬ã™ã‚‹æŠ€è¡“ã®ç·ç§°ã§ã™ã€‚

<div class="mermaid">graph TD
    A[ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹] --> B[åŒ–å­¦]
    A --> C[æƒ…å ±ç§‘å­¦]
    A --> D[ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹]
    A --> E[æ©Ÿæ¢°å­¦ç¿’]

    B --> F[æœ‰æ©ŸåŒ–å­¦]
    B --> G[åŒ»è–¬åŒ–å­¦]
    B --> H[ææ–™åŒ–å­¦]

    C --> I[åˆ†å­è¡¨ç¾]
    C --> J[ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹]
    C --> K[ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ]

    style A fill:#4CAF50,color:#fff</div>

<h3>å¿œç”¨åˆ†é‡</h3>

ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ã¯ã€ä»¥ä¸‹ã®åˆ†é‡ã§åºƒãæ´»ç”¨ã•ã‚Œã¦ã„ã¾ã™ï¼š

1. <strong>å‰µè–¬ï¼ˆDrug Discoveryï¼‰</strong>
   - æ–°è–¬å€™è£œåˆ†å­ã®è¨­è¨ˆã¨æœ€é©åŒ–
   - ä»®æƒ³ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã«ã‚ˆã‚‹å€™è£œåŒ–åˆç‰©ã®çµã‚Šè¾¼ã¿
   - ADMETï¼ˆå¸åãƒ»åˆ†å¸ƒãƒ»ä»£è¬ãƒ»æ’æ³„ãƒ»æ¯’æ€§ï¼‰äºˆæ¸¬
   - å‰¯ä½œç”¨äºˆæ¸¬ã¨è–¬ç‰©ç›¸äº’ä½œç”¨è§£æ

2. <strong>æœ‰æ©Ÿææ–™é–‹ç™º</strong>
   - æœ‰æ©ŸåŠå°ä½“ææ–™ã®è¨­è¨ˆ
   - æœ‰æ©ŸELææ–™ã®ç™ºå…‰ç‰¹æ€§äºˆæ¸¬
   - å°é›»æ€§é«˜åˆ†å­ã®è¨­è¨ˆ
   - è‰²ç´ å¢—æ„Ÿå¤ªé™½é›»æ± ã®ææ–™æ¢ç´¢

3. <strong>è§¦åª’è¨­è¨ˆ</strong>
   - æœ‰æ©Ÿè§¦åª’ã®æ´»æ€§äºˆæ¸¬
   - é…ä½å­è¨­è¨ˆã¨æœ€é©åŒ–
   - åå¿œæ¡ä»¶ã®æœ€é©åŒ–
   - é¸æŠæ€§ã®äºˆæ¸¬

4. <strong>é«˜åˆ†å­è¨­è¨ˆ</strong>
   - ãƒãƒªãƒãƒ¼ç‰©æ€§äºˆæ¸¬
   - ãƒ¢ãƒãƒãƒ¼çµ„æˆã®æœ€é©åŒ–
   - ç†±çš„æ€§è³ªã®äºˆæ¸¬
   - æ©Ÿæ¢°çš„æ€§è³ªã®äºˆæ¸¬

<h3>ãƒãƒ†ãƒªã‚¢ãƒ«ã‚ºãƒ»ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ï¼ˆMIï¼‰ã¨ã®é•ã„</h3>

| é …ç›® | ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ï¼ˆCIï¼‰ | ãƒãƒ†ãƒªã‚¢ãƒ«ã‚ºãƒ»ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ï¼ˆMIï¼‰ |
|------|------------------------|------------------------------|
| <strong>å¯¾è±¡</strong> | åˆ†å­ï¼ˆæœ‰æ©ŸåŒ–åˆç‰©ã€åŒ»è–¬å“ï¼‰ | ææ–™å…¨èˆ¬ï¼ˆç„¡æ©Ÿææ–™ã€åˆé‡‘ã€ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ï¼‰ |
| <strong>è¡¨ç¾æ³•</strong> | SMILESã€InChIã€åˆ†å­ã‚°ãƒ©ãƒ• | çµæ™¶æ§‹é€ ã€çµ„æˆã€å¾®ç´°æ§‹é€  |
| <strong>è¨˜è¿°å­</strong> | åˆ†å­è¨˜è¿°å­ã€æŒ‡ç´‹ | çµ„æˆè¨˜è¿°å­ã€æ§‹é€ è¨˜è¿°å­ |
| <strong>å¿œç”¨</strong> | å‰µè–¬ã€æœ‰æ©Ÿææ–™ã€è§¦åª’ | åˆé‡‘ã€ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ã€é›»æ± ææ–™ |
| <strong>ç›¸è£œæ€§</strong> | æœ‰æ©Ÿææ–™é–‹ç™ºã§ã¯ä¸¡è€…ãŒèåˆ | æœ‰æ©Ÿ-ç„¡æ©Ÿãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ææ–™ |

<h3>æ­´å²çš„èƒŒæ™¯</h3>

<div class="mermaid">timeline
    title ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ã®æ­´å²
    1960å¹´ä»£ : åˆæœŸã®åˆ†å­è¡¨ç¾æ³•ï¼ˆWLNï¼‰
    1970å¹´ä»£ : SMILESè¨˜æ³•ã®é–‹ç™ºï¼ˆDavid Weiningerï¼‰
    1980å¹´ä»£ : 3D QSARæ‰‹æ³•ã®ç¢ºç«‹
    1990å¹´ä»£ : ãƒã‚¤ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆHTSï¼‰ã®æ™®åŠ
    2000å¹´ä»£ : å¤§è¦æ¨¡åŒ–å­¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆPubChemã€ChEMBLï¼‰
    2010å¹´ä»£ : æ©Ÿæ¢°å­¦ç¿’ã®æœ¬æ ¼å°å…¥
    2020å¹´ä»£ : æ·±å±¤å­¦ç¿’ãƒ»GNNãƒ»Transformerã®å¿œç”¨</div>

<strong>1970å¹´ä»£ - SMILESèª•ç”Ÿ</strong>:
David WeiningerãŒé–‹ç™ºã—ãŸSMILESï¼ˆSimplified Molecular Input Line Entry Systemï¼‰ã¯ã€åˆ†å­ã‚’æ–‡å­—åˆ—ã§è¡¨ç¾ã™ã‚‹é©æ–°çš„æ‰‹æ³•ã¨ã—ã¦ã€ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ã®åŸºç›¤ã¨ãªã‚Šã¾ã—ãŸã€‚

<strong>2000å¹´ä»£ - ãƒ‡ãƒ¼ã‚¿çˆ†ç™º</strong>:
PubChemï¼ˆ2004å¹´ï¼‰ã€ChEMBLï¼ˆ2009å¹´ï¼‰ãªã©å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç™»å ´ã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿é§†å‹•å‹ã®åˆ†å­è¨­è¨ˆãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚

<strong>2020å¹´ä»£ - AIé©å‘½</strong>:
Graph Neural Networksï¼ˆGNNï¼‰ã€Transformerãªã©æ·±å±¤å­¦ç¿’æ‰‹æ³•ã®å°å…¥ã«ã‚ˆã‚Šã€å¾“æ¥ä¸å¯èƒ½ã ã£ãŸè¤‡é›‘ãªæ§‹é€ -æ´»æ€§ç›¸é–¢ã®äºˆæ¸¬ãŒå¯èƒ½ã«ãªã£ã¦ã„ã¾ã™ã€‚

---

<h2>1.2 åˆ†å­è¡¨ç¾æ³•ã®åŸºç¤</h2>

è¨ˆç®—æ©Ÿã§åˆ†å­ã‚’æ‰±ã†ã«ã¯ã€é©åˆ‡ãªè¡¨ç¾æ³•ãŒå¿…è¦ã§ã™ã€‚ã“ã“ã§ã¯ä¸»è¦ãª4ã¤ã®è¡¨ç¾æ³•ã‚’å­¦ã³ã¾ã™ã€‚

<h3>1.2.1 SMILESè¨˜æ³•</h3>

<strong>SMILESï¼ˆSimplified Molecular Input Line Entry Systemï¼‰</strong>ã¯ã€åˆ†å­æ§‹é€ ã‚’æ–‡å­—åˆ—ã§è¡¨ç¾ã™ã‚‹ç·šå½¢è¨˜æ³•ã§ã™ã€‚

<h4>åŸºæœ¬ãƒ«ãƒ¼ãƒ«</h4>

| è¨˜å· | æ„å‘³ | ä¾‹ |
|------|------|-----|
| C, N, O, S, P | åŸå­ | Cï¼ˆç‚­ç´ ï¼‰ã€Nï¼ˆçª’ç´ ï¼‰ |
| - | å˜çµåˆï¼ˆé€šå¸¸çœç•¥ï¼‰ | C-C â†’ CC |
| = | äºŒé‡çµåˆ | C=C |
| # | ä¸‰é‡çµåˆ | C#C |
| ( ) | åˆ†å² | CC(C)C |
| [ ] | åŸå­ã®è©³ç´°æŒ‡å®š | [CH3] |
| @ | ç«‹ä½“åŒ–å­¦ | C[C@H](O)N |

<h4>å…·ä½“ä¾‹</h4>

<pre><code class="language-python"><h1>ä»£è¡¨çš„ãªåˆ†å­ã®SMILES</h1>

åˆ†å­å         SMILES          èª¬æ˜
----------------------------------------------
ãƒ¡ã‚¿ãƒ³         C               æœ€ã‚‚å˜ç´”ãªç‚­åŒ–æ°´ç´ 
ã‚¨ã‚¿ãƒãƒ¼ãƒ«     CCO             C-C-O ã®ç›´é–æ§‹é€ 
é…¢é…¸           CC(=O)O         ã‚«ãƒ«ãƒœãƒ³é…¸ï¼ˆåˆ†å²ã‚ã‚Šï¼‰
ãƒ™ãƒ³ã‚¼ãƒ³       c1ccccc1        èŠ³é¦™ç’°ï¼ˆå°æ–‡å­—ã¯èŠ³é¦™æ—ï¼‰
ãƒˆãƒ«ã‚¨ãƒ³       Cc1ccccc1       ãƒ™ãƒ³ã‚¼ãƒ³ã«ãƒ¡ãƒãƒ«åŸº
ã‚¢ã‚¹ãƒ”ãƒªãƒ³     CC(=O)Oc1ccccc1C(=O)O  è§£ç†±é®ç—›å‰¤
ã‚«ãƒ•ã‚§ã‚¤ãƒ³     CN1C=NC2=C1C(=O)N(C(=O)N2C)C  è¦šé†’ä½œç”¨</code></pre>

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹1: SMILESã‹ã‚‰åˆ†å­ã‚’ä½œæˆ</h4>

<pre><code class="language-python"><h1>RDKitã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆåˆå›ã®ã¿ï¼‰</h1>
<h1>conda install -c conda-forge rdkit</h1>
<h1>pip install rdkit  # pipçµŒç”±ã‚‚å¯èƒ½</h1>

from rdkit import Chem
from rdkit.Chem import Draw

<h1>SMILESã‹ã‚‰åˆ†å­ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ</h1>
smiles = "CCO"  # ã‚¨ã‚¿ãƒãƒ¼ãƒ«
mol = Chem.MolFromSmiles(smiles)

<h1>åˆ†å­ã®åŸºæœ¬æƒ…å ±</h1>
print(f"åˆ†å­å¼: {Chem.rdMolDescriptors.CalcMolFormula(mol)}")
print(f"åˆ†å­é‡: {Chem.rdMolDescriptors.CalcExactMolWt(mol):.2f}")
print(f"åŸå­æ•°: {mol.GetNumAtoms()}")
print(f"çµåˆæ•°: {mol.GetNumBonds()}")

<h1>åˆ†å­ã®æç”»</h1>
img = Draw.MolToImage(mol, size=(300, 300))
img.save("ethanol.png")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>åˆ†å­å¼: C2H6O
åˆ†å­é‡: 46.04
åŸå­æ•°: 3
çµåˆæ•°: 2</code></pre>

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹2: è¤‡æ•°åˆ†å­ã®ä¸€æ‹¬æç”»</h4>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import Draw

<h1>ä¸»è¦ãªåŒ»è–¬å“ã®SMILES</h1>
drugs = {
    "Aspirin": "CC(=O)Oc1ccccc1C(=O)O",
    "Ibuprofen": "CC(C)Cc1ccc(cc1)C(C)C(=O)O",
    "Caffeine": "CN1C=NC2=C1C(=O)N(C(=O)N2C)C",
    "Paracetamol": "CC(=O)Nc1ccc(O)cc1"
}

<h1>åˆ†å­ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªã‚¹ãƒˆã‚’ä½œæˆ</h1>
mols = [Chem.MolFromSmiles(smi) for smi in drugs.values()]
legends = list(drugs.keys())

<h1>ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤º</h1>
img = Draw.MolsToGridImage(
    mols,
    molsPerRow=2,
    subImgSize=(300, 300),
    legends=legends
)
img.save("common_drugs.png")</code></pre>

<h3>1.2.2 InChI/InChIKey</h3>

<strong>InChIï¼ˆInternational Chemical Identifierï¼‰</strong>ã¯ã€IUPACãŒæ¨™æº–åŒ–ã—ãŸåˆ†å­è­˜åˆ¥å­ã§ã™ã€‚

<h4>InChI vs SMILES</h4>

| é …ç›® | SMILES | InChI |
|------|--------|-------|
| <strong>ä¸€æ„æ€§</strong> | åŒã˜åˆ†å­ã«è¤‡æ•°ã®SMILES | åŒã˜åˆ†å­ã«1ã¤ã®InChI |
| <strong>äººé–“ã®èª­ã¿ã‚„ã™ã•</strong> | æ¯”è¼ƒçš„èª­ã¿ã‚„ã™ã„ | èª­ã¿ã«ãã„ |
| <strong>æ¨™æº–åŒ–</strong> | éæ¨™æº– | IUPACæ¨™æº– |
| <strong>ç”¨é€”</strong> | åˆ†å­å…¥åŠ›ã€å¯è¦–åŒ– | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢ã€è­˜åˆ¥ |

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹3: InChIã¨InChIKeyã®ç”Ÿæˆ</h4>

<pre><code class="language-python">from rdkit import Chem

<h1>SMILESã‹ã‚‰åˆ†å­ã‚’ä½œæˆ</h1>
smiles = "CC(=O)Oc1ccccc1C(=O)O"  # ã‚¢ã‚¹ãƒ”ãƒªãƒ³
mol = Chem.MolFromSmiles(smiles)

<h1>InChIã‚’ç”Ÿæˆ</h1>
inchi = Chem.MolToInchi(mol)
print(f"InChI: {inchi}")

<h1>InChIKeyï¼ˆå›ºå®šé•·27æ–‡å­—ã®ãƒãƒƒã‚·ãƒ¥å€¤ï¼‰</h1>
inchi_key = Chem.MolToInchiKey(mol)
print(f"InChIKey: {inchi_key}")

<h1>InChIã‹ã‚‰SMILESã¸å¤‰æ›</h1>
mol_from_inchi = Chem.MolFromInchi(inchi)
smiles_regenerated = Chem.MolToSmiles(mol_from_inchi)
print(f"å†ç”ŸæˆSMILES: {smiles_regenerated}")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>InChI: InChI=1S/C9H8O4/c1-6(10)13-8-5-3-2-4-7(8)9(11)12/h2-5H,1H3,(H,11,12)
InChIKey: BSYNRYMUTXBXSQ-UHFFFAOYSA-N
å†ç”ŸæˆSMILES: CC(=O)Oc1ccccc1C(=O)O</code></pre>

<h3>1.2.3 åˆ†å­ã‚°ãƒ©ãƒ•</h3>

åˆ†å­ã¯<strong>ã‚°ãƒ©ãƒ•æ§‹é€ </strong>ã¨ã—ã¦è¡¨ç¾ã§ãã¾ã™ï¼š
- <strong>ãƒãƒ¼ãƒ‰ï¼ˆé ‚ç‚¹ï¼‰</strong>: åŸå­
- <strong>ã‚¨ãƒƒã‚¸ï¼ˆè¾ºï¼‰</strong>: åŒ–å­¦çµåˆ

<div class="mermaid">graph LR
    C1((C)) ---|å˜çµåˆ| C2((C))
    C2 ---|å˜çµåˆ| O((O))

    style C1 fill:#4CAF50,color:#fff
    style C2 fill:#4CAF50,color:#fff
    style O fill:#F44336,color:#fff</div>

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹4: åˆ†å­ã‚°ãƒ©ãƒ•ã®è§£æ</h4>

<pre><code class="language-python">from rdkit import Chem
import networkx as nx

<h1>SMILESã‹ã‚‰åˆ†å­ã‚’ä½œæˆ</h1>
smiles = "CCO"  # ã‚¨ã‚¿ãƒãƒ¼ãƒ«
mol = Chem.MolFromSmiles(smiles)

<h1>NetworkXã‚°ãƒ©ãƒ•ã«å¤‰æ›</h1>
G = nx.Graph()

<h1>ãƒãƒ¼ãƒ‰ï¼ˆåŸå­ï¼‰ã‚’è¿½åŠ </h1>
for atom in mol.GetAtoms():
    G.add_node(
        atom.GetIdx(),
        symbol=atom.GetSymbol(),
        degree=atom.GetDegree()
    )

<h1>ã‚¨ãƒƒã‚¸ï¼ˆçµåˆï¼‰ã‚’è¿½åŠ </h1>
for bond in mol.GetBonds():
    G.add_edge(
        bond.GetBeginAtomIdx(),
        bond.GetEndAtomIdx(),
        bond_type=str(bond.GetBondType())
    )

<h1>ã‚°ãƒ©ãƒ•ã®åŸºæœ¬æƒ…å ±</h1>
print(f"ãƒãƒ¼ãƒ‰æ•°ï¼ˆåŸå­æ•°ï¼‰: {G.number_of_nodes()}")
print(f"ã‚¨ãƒƒã‚¸æ•°ï¼ˆçµåˆæ•°ï¼‰: {G.number_of_edges()}")
print(f"æ¬¡æ•°ä¸­å¿ƒæ€§: {nx.degree_centrality(G)}")

<h1>å„åŸå­ã®æƒ…å ±</h1>
for idx, data in G.nodes(data=True):
    print(f"åŸå­ {idx}: {data['symbol']}, æ¬¡æ•° {data['degree']}")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>ãƒãƒ¼ãƒ‰æ•°ï¼ˆåŸå­æ•°ï¼‰: 3
ã‚¨ãƒƒã‚¸æ•°ï¼ˆçµåˆæ•°ï¼‰: 2
æ¬¡æ•°ä¸­å¿ƒæ€§: {0: 0.5, 1: 1.0, 2: 0.5}
åŸå­ 0: C, æ¬¡æ•° 1
åŸå­ 1: C, æ¬¡æ•° 2
åŸå­ 2: O, æ¬¡æ•° 1</code></pre>

<h3>1.2.4 3Dæ§‹é€ ã¨ç«‹ä½“åŒ–å­¦</h3>

åˆ†å­ã®3Dæ§‹é€ ã¯ã€ç”Ÿç‰©æ´»æ€§ã‚„ç‰©æ€§ã«å¤§ããå½±éŸ¿ã—ã¾ã™ã€‚

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹5: 3Dæ§‹é€ ã®ç”Ÿæˆã¨å¯è¦–åŒ–</h4>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem
from rdkit.Chem import PyMol

<h1>SMILESã‹ã‚‰åˆ†å­ã‚’ä½œæˆ</h1>
smiles = "CC(C)Cc1ccc(cc1)C(C)C(=O)O"  # ã‚¤ãƒ–ãƒ—ãƒ­ãƒ•ã‚§ãƒ³
mol = Chem.MolFromSmiles(smiles)

<h1>3Dåº§æ¨™ã‚’ç”Ÿæˆï¼ˆETKDGæ³•ï¼‰</h1>
AllChem.EmbedMolecule(mol, randomSeed=42)

<h1>åˆ†å­åŠ›å ´ã§æœ€é©åŒ–ï¼ˆMMFF94ï¼‰</h1>
AllChem.MMFFOptimizeMolecule(mol)

<h1>3Dæ§‹é€ ã®ä¿å­˜ï¼ˆmol2å½¢å¼ï¼‰</h1>
writer = Chem.rdmolfiles.MolToMol2Block(mol)
with open("ibuprofen_3d.mol2", "w") as f:
    f.write(writer)

print("3Dæ§‹é€ ã‚’ç”Ÿæˆã—ã¾ã—ãŸ")

<h1>åŸå­åº§æ¨™ã®å–å¾—</h1>
conf = mol.GetConformer()
for i, atom in enumerate(mol.GetAtoms()):
    pos = conf.GetAtomPosition(i)
    print(
        f"{atom.GetSymbol()} {i}: "
        f"({pos.x:.3f}, {pos.y:.3f}, {pos.z:.3f})"
    )</code></pre>

<strong>Column: ç«‹ä½“åŒ–å­¦ã®é‡è¦æ€§</strong>

é¡åƒç•°æ€§ä½“ï¼ˆã‚¨ãƒŠãƒ³ãƒã‚ªãƒãƒ¼ï¼‰ã¯ã€åŒã˜åˆ†å­å¼ãƒ»æ§‹é€ å¼ã‚’æŒã¤ãŒã€3Dæ§‹é€ ãŒé¡åƒé–¢ä¿‚ã«ã‚ã‚Šã¾ã™ã€‚

<strong>ä¾‹ï¼šã‚µãƒªãƒ‰ãƒã‚¤ãƒ‰äº‹ä»¶</strong>
- (R)-ã‚µãƒªãƒ‰ãƒã‚¤ãƒ‰ï¼šé®é™ä½œç”¨ï¼ˆæœ‰åŠ¹ï¼‰
- (S)-ã‚µãƒªãƒ‰ãƒã‚¤ãƒ‰ï¼šå‚¬å¥‡å½¢æ€§ï¼ˆæœ‰å®³ï¼‰

ç«‹ä½“åŒ–å­¦ã®æ­£ç¢ºãªè¡¨ç¾ã¯ã€å‰µè–¬ã«ãŠã„ã¦ç”Ÿæ­»ã‚’åˆ†ã‘ã‚‹é‡è¦æ€§ã‚’æŒã¡ã¾ã™ã€‚

---

<h2>1.3 RDKitã®åŸºæœ¬æ“ä½œ</h2>

RDKitï¼ˆ<strong>R</strong>apidly <strong>D</strong>eveloping <strong>Kit</strong>ï¼‰ã¯ã€ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ã®ãŸã‚ã®æœ€ã‚‚åºƒãä½¿ã‚ã‚Œã¦ã„ã‚‹Pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚

<h3>ç’°å¢ƒæ§‹ç¯‰</h3>

<h4>Option 1: Anacondaï¼ˆæ¨å¥¨ï¼‰</h4>

<pre><code class="language-bash"><h1>ä»®æƒ³ç’°å¢ƒã®ä½œæˆ</h1>
conda create -n cheminf python=3.11

<h1>ç’°å¢ƒã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³</h1>
conda activate cheminf

<h1>RDKitã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h1>
conda install -c conda-forge rdkit

<h1>è¿½åŠ ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</h1>
conda install -c conda-forge mordred pandas matplotlib \
  seaborn scikit-learn</code></pre>

<h4>Option 2: Google Colabï¼ˆã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦ï¼‰</h4>

<pre><code class="language-python"><h1>Google Colabã§ã¯ä»¥ä¸‹ã‚’å®Ÿè¡Œ</h1>
!pip install rdkit mordred</code></pre>

<h3>1.3.1 åˆ†å­ã®èª­ã¿è¾¼ã¿ã¨æç”»</h3>

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹6: å¤šæ§˜ãªå…¥åŠ›å½¢å¼ã‹ã‚‰ã®èª­ã¿è¾¼ã¿</h4>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import Draw

<h1>æ–¹æ³•1: SMILESã‹ã‚‰</h1>
mol1 = Chem.MolFromSmiles("c1ccccc1")

<h1>æ–¹æ³•2: InChIã‹ã‚‰</h1>
mol2 = Chem.MolFromInchi(
    "InChI=1S/C6H6/c1-2-4-6-5-3-1/h1-6H"
)

<h1>æ–¹æ³•3: MOLãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰</h1>
<h1>mol3 = Chem.MolFromMolFile("benzene.mol")</h1>

<h1>æ–¹æ³•4: SMARTSï¼ˆéƒ¨åˆ†æ§‹é€ ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰ã‹ã‚‰</h1>
pattern = Chem.MolFromSmarts("c1ccccc1")

<h1>æç”»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®è¨­å®š</h1>
from rdkit.Chem.Draw import IPythonConsole
IPythonConsole.ipython_useSVG = True  # SVGå½¢å¼ã§é«˜ç”»è³ª

<h1>åŸå­ç•ªå·ã‚’è¡¨ç¤º</h1>
for atom in mol1.GetAtoms():
    atom.SetProp("atomLabel", str(atom.GetIdx()))

img = Draw.MolToImage(mol1, size=(400, 400))
img.save("benzene_labeled.png")</code></pre>

<h3>1.3.2 éƒ¨åˆ†æ§‹é€ æ¤œç´¢ï¼ˆSMARTSï¼‰</h3>

<strong>SMARTSï¼ˆSMILES ARbitrary Target Specificationï¼‰</strong>ã¯ã€éƒ¨åˆ†æ§‹é€ ã‚’æŸ”è»Ÿã«è¨˜è¿°ã™ã‚‹ãŸã‚ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°è¨€èªã§ã™ã€‚

<h4>ä¸»è¦ãªSMARTSãƒ‘ã‚¿ãƒ¼ãƒ³</h4>

| ãƒ‘ã‚¿ãƒ¼ãƒ³ | èª¬æ˜ | ä¾‹ |
|---------|------|-----|
| <code>[#6]</code> | ç‚­ç´ åŸå­ | ä»»æ„ã®ç‚­ç´  |
| <code>[OH]</code> | ãƒ’ãƒ‰ãƒ­ã‚­ã‚·ãƒ«åŸº | ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ã€ãƒ•ã‚§ãƒãƒ¼ãƒ« |
| <code>C(=O)O</code> | ã‚«ãƒ«ãƒœã‚­ã‚·ãƒ«åŸº | ã‚«ãƒ«ãƒœãƒ³é…¸ |
| <code>c1ccccc1</code> | ãƒ™ãƒ³ã‚¼ãƒ³ç’° | èŠ³é¦™ç’° |
| <code>[$([NX3;H2])]</code> | 1ç´šã‚¢ãƒŸãƒ³ | RNHâ‚‚ |

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹7: éƒ¨åˆ†æ§‹é€ æ¤œç´¢</h4>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import Draw

<h1>æ¤œç´¢å¯¾è±¡ã®åˆ†å­ãƒªã‚¹ãƒˆ</h1>
molecules = {
    "Aspirin": "CC(=O)Oc1ccccc1C(=O)O",
    "Ibuprofen": "CC(C)Cc1ccc(cc1)C(C)C(=O)O",
    "Paracetamol": "CC(=O)Nc1ccc(O)cc1",
    "Benzene": "c1ccccc1"
}

<h1>æ¤œç´¢ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆã‚«ãƒ«ãƒœãƒ³é…¸ï¼‰</h1>
pattern = Chem.MolFromSmarts("C(=O)[OH]")

<h1>å„åˆ†å­ã§ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°</h1>
for name, smiles in molecules.items():
    mol = Chem.MolFromSmiles(smiles)
    if mol.HasSubstructMatch(pattern):
        # ãƒãƒƒãƒã—ãŸåŸå­ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
        matches = mol.GetSubstructMatches(pattern)
        print(f"{name}: ã‚«ãƒ«ãƒœãƒ³é…¸ã‚’å«ã‚€ï¼ˆãƒãƒƒãƒ: {matches}ï¼‰")
    else:
        print(f"{name}: ã‚«ãƒ«ãƒœãƒ³é…¸ã‚’å«ã¾ãªã„")

<h1>ãƒãƒƒãƒç®‡æ‰€ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤º</h1>
mol_highlight = Chem.MolFromSmiles(molecules["Aspirin"])
matches = mol_highlight.GetSubstructMatches(pattern)
img = Draw.MolToImage(
    mol_highlight,
    highlightAtoms=[atom for match in matches for atom in match]
)
img.save("aspirin_highlighted.png")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>Aspirin: ã‚«ãƒ«ãƒœãƒ³é…¸ã‚’å«ã‚€ï¼ˆãƒãƒƒãƒ: ((7, 8, 9),)ï¼‰
Ibuprofen: ã‚«ãƒ«ãƒœãƒ³é…¸ã‚’å«ã‚€ï¼ˆãƒãƒƒãƒ: ((12, 13, 14),)ï¼‰
Paracetamol: ã‚«ãƒ«ãƒœãƒ³é…¸ã‚’å«ã¾ãªã„
Benzene: ã‚«ãƒ«ãƒœãƒ³é…¸ã‚’å«ã¾ãªã„</code></pre>

<h3>1.3.3 åˆ†å­ã®ç·¨é›†ã¨å¤‰æ›</h3>

<h4>ã‚³ãƒ¼ãƒ‰ä¾‹8: å®˜èƒ½åŸºã®è¿½åŠ ã¨å‰Šé™¤</h4>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem

<h1>ãƒ™ãƒ³ã‚¼ãƒ³ã‹ã‚‰å§‹ã‚ã‚‹</h1>
mol = Chem.MolFromSmiles("c1ccccc1")

<h1>ç·¨é›†å¯èƒ½ãªåˆ†å­ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›</h1>
mol_edit = Chem.RWMol(mol)

<h1>æ–°ã—ã„åŸå­ï¼ˆé…¸ç´ ï¼‰ã‚’è¿½åŠ </h1>
new_atom_idx = mol_edit.AddAtom(Chem.Atom(8))  # 8 = é…¸ç´ 

<h1>æ—¢å­˜ã®ç‚­ç´ ï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹0ï¼‰ã¨æ–°ã—ã„é…¸ç´ ã‚’çµåˆ</h1>
mol_edit.AddBond(0, new_atom_idx, Chem.BondType.SINGLE)

<h1>æ°´ç´ ã‚’è¿½åŠ ã—ã¦åˆ†å­ã‚’å®Œæˆ</h1>
final_mol = mol_edit.GetMol()
final_mol = Chem.AddHs(final_mol)

<h1>SMILES ã‚’å–å¾—</h1>
smiles_final = Chem.MolToSmiles(Chem.RemoveHs(final_mol))
print(f"ç”Ÿæˆã•ã‚ŒãŸåˆ†å­: {smiles_final}")
<h1>å‡ºåŠ›: c1ccccc1O ï¼ˆãƒ•ã‚§ãƒãƒ¼ãƒ«ï¼‰</h1>

<h1>æç”»</h1>
img = Draw.MolToImage(Chem.RemoveHs(final_mol))
img.save("phenol.png")</code></pre>

---

<h2>1.4 ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ï¼šåŒ»è–¬å“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢</h2>

å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰åŒ»è–¬å“æƒ…å ±ã‚’å–å¾—ã—ã€åˆ†å­æ§‹é€ ã‚’åˆ†æã—ã¾ã™ã€‚

<h3>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç¨®é¡</h3>

| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | èª¬æ˜ | ãƒ‡ãƒ¼ã‚¿æ•° | ã‚¢ã‚¯ã‚»ã‚¹ |
|------------|------|---------|---------|
| <strong>ChEMBL</strong> | ç”Ÿç‰©æ´»æ€§åˆ†å­ãƒ‡ãƒ¼ã‚¿ | 210ä¸‡+ | [ebi.ac.uk/chembl](https://www.ebi.ac.uk/chembl/) |
| <strong>PubChem</strong> | åŒ–åˆç‰©ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | 1å„„1åƒä¸‡+ | [pubchem.ncbi.nlm.nih.gov](https://pubchem.ncbi.nlm.nih.gov/) |
| <strong>DrugBank</strong> | æ‰¿èªåŒ»è–¬å“ãƒ‡ãƒ¼ã‚¿ | 14,000+ | [drugbank.com](https://go.drugbank.com/) |
| <strong>ZINC</strong> | å¸‚è²©åŒ–åˆç‰© | 10å„„+ | [zinc15.docking.org](https://zinc15.docking.org/) |

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹9: ChEMBLã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—</h3>

<pre><code class="language-python"><h1>chembl_webresource_clientã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h1>
<h1>pip install chembl_webresource_client</h1>

from chembl_webresource_client.new_client import new_client
from rdkit import Chem
from rdkit.Chem import Descriptors
import pandas as pd

<h1>ã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼ˆæ¨™çš„ã‚¿ãƒ³ãƒ‘ã‚¯è³ªï¼‰ã®æ¤œç´¢</h1>
target = new_client.target
target_query = target.search('EGFR')  # ä¸Šçš®æˆé•·å› å­å—å®¹ä½“
targets = list(target_query)

<h1>æœ€åˆã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆIDã‚’å–å¾—</h1>
chembl_id = targets[0]['target_chembl_id']
print(f"ã‚¿ãƒ¼ã‚²ãƒƒãƒˆID: {chembl_id}")

<h1>è©²å½“ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«å¯¾ã™ã‚‹ã‚¢ãƒƒã‚»ã‚¤ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—</h1>
activity = new_client.activity
activities = activity.filter(
    target_chembl_id=chembl_id,
    type="IC50",
    relation="="
).filter(assay_type="B")

<h1>ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«å¤‰æ›</h1>
df = pd.DataFrame.from_dict(activities)

<h1>SMILESåˆ—ãŒå­˜åœ¨ã™ã‚‹å ´åˆ</h1>
if 'canonical_smiles' in df.columns:
    # æœ‰åŠ¹ãªSMILESã®ã¿ã‚’ä¿æŒ
    df['mol'] = df['canonical_smiles'].apply(
        Chem.MolFromSmiles
    )
    df = df[df['mol'].notna()]

    # åˆ†å­è¨˜è¿°å­ã‚’è¨ˆç®—
    df['MW'] = df['mol'].apply(
        Descriptors.MolWt
    )
    df['LogP'] = df['mol'].apply(
        Descriptors.MolLogP
    )

    print(f"\nå–å¾—ã—ãŸåŒ–åˆç‰©æ•°: {len(df)}")
    print(df[['canonical_smiles', 'MW', 'LogP']].head())</code></pre>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹10: SMILESæ¤œè¨¼ã¨ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³</h3>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import Descriptors

def validate_and_sanitize_smiles(smiles_list):
    """
    SMILESãƒªã‚¹ãƒˆã‚’æ¤œè¨¼ã—ã€ã‚µãƒ‹ã‚¿ã‚¤ã‚ºã™ã‚‹

    Parameters:
    -----------
    smiles_list : list
        SMILESã®ãƒªã‚¹ãƒˆ

    Returns:
    --------
    valid_smiles : list
        æœ‰åŠ¹ãªSMILESã®ãƒªã‚¹ãƒˆ
    invalid_smiles : list
        ç„¡åŠ¹ãªSMILESã®ãƒªã‚¹ãƒˆ
    """
    valid_smiles = []
    invalid_smiles = []

    for smi in smiles_list:
        try:
            # SMILESã‹ã‚‰åˆ†å­ã‚’ä½œæˆ
            mol = Chem.MolFromSmiles(smi)

            if mol is None:
                invalid_smiles.append(smi)
                continue

            # ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆåŒ–å­¦çš„å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯ï¼‰
            Chem.SanitizeMol(mol)

            # æ¨™æº–åŒ–ã•ã‚ŒãŸSMILESã‚’å–å¾—
            canonical = Chem.MolToSmiles(mol)
            valid_smiles.append(canonical)

        except Exception as e:
            print(f"ã‚¨ãƒ©ãƒ¼: {smi} - {e}")
            invalid_smiles.append(smi)

    return valid_smiles, invalid_smiles

<h1>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿</h1>
test_smiles = [
    "CCO",                      # æœ‰åŠ¹
    "c1ccccc1",                 # æœ‰åŠ¹
    "CC(=O)Oc1ccccc1C(=O)O",   # æœ‰åŠ¹ï¼ˆã‚¢ã‚¹ãƒ”ãƒªãƒ³ï¼‰
    "C1CC",                     # ç„¡åŠ¹ï¼ˆé–‹ç’°ï¼‰
    "INVALID",                  # ç„¡åŠ¹
    "CC(C)(C)c1ccc(O)cc1"      # æœ‰åŠ¹ï¼ˆBHTï¼‰
]

valid, invalid = validate_and_sanitize_smiles(test_smiles)

print(f"æœ‰åŠ¹: {len(valid)} ä»¶")
print(f"ç„¡åŠ¹: {len(invalid)} ä»¶")
print("\næœ‰åŠ¹ãªSMILES:")
for smi in valid:
    mol = Chem.MolFromSmiles(smi)
    print(f"  {smi} - MW: {Descriptors.MolWt(mol):.2f}")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>æœ‰åŠ¹: 4 ä»¶
ç„¡åŠ¹: 2 ä»¶

æœ‰åŠ¹ãªSMILES:
  CCO - MW: 46.07
  c1ccccc1 - MW: 78.11
  CC(=O)Oc1ccccc1C(=O)O - MW: 180.16
  CC(C)(C)c1ccc(O)cc1 - MW: 150.22</code></pre>

---

<h2>æ¼”ç¿’å•é¡Œ</h2>

<h3>æ¼”ç¿’1: åŸºæœ¬çš„ãªåˆ†å­æ“ä½œ</h3>

ä»¥ä¸‹ã®åˆ†å­ã®SMILESã‚’ä½œæˆã—ã€RDKitã§æç”»ã—ã¦ãã ã•ã„ï¼š
1. ãƒ—ãƒ­ãƒ‘ãƒãƒ¼ãƒ«ï¼ˆCâ‚ƒHâ‚‡OHï¼‰
2. ãƒˆãƒ«ã‚¨ãƒ³ï¼ˆãƒ¡ãƒãƒ«ãƒ™ãƒ³ã‚¼ãƒ³ï¼‰
3. ã‚¢ã‚»ãƒˆã‚¢ãƒŸãƒãƒ•ã‚§ãƒ³ï¼ˆãƒ‘ãƒ©ã‚»ã‚¿ãƒ¢ãƒ¼ãƒ«ï¼‰

<details>
<summary>è§£ç­”ä¾‹</summary>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import Draw

smiles_dict = {
    "Propanol": "CCCO",
    "Toluene": "Cc1ccccc1",
    "Acetaminophen": "CC(=O)Nc1ccc(O)cc1"
}

mols = [Chem.MolFromSmiles(smi) for smi in smiles_dict.values()]
legends = list(smiles_dict.keys())

img = Draw.MolsToGridImage(
    mols,
    molsPerRow=3,
    subImgSize=(300, 300),
    legends=legends
)
img.save("exercise1.png")</code></pre>
</details>

<h3>æ¼”ç¿’2: éƒ¨åˆ†æ§‹é€ æ¤œç´¢</h3>

ä»¥ä¸‹ã®å®˜èƒ½åŸºã‚’å«ã‚€åˆ†å­ã‚’ã€ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‹ã‚‰æ¤œç´¢ã—ã¦ãã ã•ã„ï¼š
- ãƒ’ãƒ‰ãƒ­ã‚­ã‚·ãƒ«åŸºï¼ˆ-OHï¼‰
- ã‚¢ãƒŸãƒåŸºï¼ˆ-NHâ‚‚ï¼‰
- ãƒ‹ãƒˆãƒ­åŸºï¼ˆ-NOâ‚‚ï¼‰

<details>
<summary>è§£ç­”ä¾‹</summary>

<pre><code class="language-python">from rdkit import Chem

<h1>ã‚µãƒ³ãƒ—ãƒ«åˆ†å­</h1>
molecules = {
    "Ethanol": "CCO",
    "Aniline": "c1ccccc1N",
    "Nitrobenzene": "c1ccc(cc1)[N+](=O)[O-]",
    "Phenol": "c1ccc(cc1)O",
    "Benzoic acid": "c1ccc(cc1)C(=O)O"
}

<h1>æ¤œç´¢ãƒ‘ã‚¿ãƒ¼ãƒ³</h1>
patterns = {
    "Hydroxyl": "[OH]",
    "Amino": "[NH2]",
    "Nitro": "[N+](=O)[O-]"
}

<h1>æ¤œç´¢å®Ÿè¡Œ</h1>
for func_group, smarts in patterns.items():
    pattern = Chem.MolFromSmarts(smarts)
    print(f"\n{func_group}åŸºã‚’å«ã‚€åˆ†å­:")

    for name, smiles in molecules.items():
        mol = Chem.MolFromSmiles(smiles)
        if mol.HasSubstructMatch(pattern):
            print(f"  - {name}")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>HydroxylåŸºã‚’å«ã‚€åˆ†å­:
  - Ethanol
  - Phenol
  - Benzoic acid

AminoåŸºã‚’å«ã‚€åˆ†å­:
  - Aniline

NitroåŸºã‚’å«ã‚€åˆ†å­:
  - Nitrobenzene</code></pre>
</details>

<h3>æ¼”ç¿’3: åˆ†å­è¨˜è¿°å­ã®è¨ˆç®—</h3>

RDKitã‚’ä½¿ç”¨ã—ã¦ã€ä»¥ä¸‹ã®åˆ†å­è¨˜è¿°å­ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ï¼š
- åˆ†å­é‡ï¼ˆMolecular Weightï¼‰
- logPï¼ˆè„‚æº¶æ€§ï¼‰
- TPSAï¼ˆæ¥µæ€§è¡¨é¢ç©ï¼‰
- å›è»¢å¯èƒ½çµåˆæ•°

<details>
<summary>è§£ç­”ä¾‹</summary>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import Descriptors
import pandas as pd

<h1>ã‚µãƒ³ãƒ—ãƒ«åŒ»è–¬å“</h1>
drugs = {
    "Aspirin": "CC(=O)Oc1ccccc1C(=O)O",
    "Ibuprofen": "CC(C)Cc1ccc(cc1)C(C)C(=O)O",
    "Paracetamol": "CC(=O)Nc1ccc(O)cc1"
}

<h1>è¨˜è¿°å­è¨ˆç®—</h1>
data = []
for name, smiles in drugs.items():
    mol = Chem.MolFromSmiles(smiles)
    data.append({
        'Name': name,
        'MW': Descriptors.MolWt(mol),
        'LogP': Descriptors.MolLogP(mol),
        'TPSA': Descriptors.TPSA(mol),
        'RotBonds': Descriptors.NumRotatableBonds(mol)
    })

df = pd.DataFrame(data)
print(df.to_string(index=False))</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>        Name      MW  LogP  TPSA  RotBonds
     Aspirin  180.16  1.19 63.60         3
   Ibuprofen  206.28  3.50 37.30         4
 Paracetamol  151.16  0.46 49.33         1</code></pre>
</details>

<h3>æ¼”ç¿’4: PubChemã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—</h3>

PubChemã®REST APIã‚’ä½¿ç”¨ã—ã¦ã€ç‰¹å®šã®åŒ–åˆç‰©ï¼ˆä¾‹: ã‚«ãƒ•ã‚§ã‚¤ãƒ³ï¼‰ã®æƒ…å ±ã‚’å–å¾—ã—ã€æ§‹é€ ã‚’æç”»ã—ã¦ãã ã•ã„ã€‚

<details>
<summary>è§£ç­”ä¾‹</summary>

<pre><code class="language-python">import requests
from rdkit import Chem
from rdkit.Chem import Draw

<h1>PubChemã®REST APIï¼ˆåŒ–åˆç‰©åã‹ã‚‰æ¤œç´¢ï¼‰</h1>
compound_name = "caffeine"
url = f"https://pubchem.ncbi.nlm.nih.gov/rest/pug/" \
      f"compound/name/{compound_name}/property/" \
      f"CanonicalSMILES,MolecularWeight,IUPACName/JSON"

response = requests.get(url)
data = response.json()

<h1>ãƒ‡ãƒ¼ã‚¿ã®å–å¾—</h1>
properties = data['PropertyTable']['Properties'][0]
smiles = properties['CanonicalSMILES']
mw = properties['MolecularWeight']
iupac = properties.get('IUPACName', 'N/A')

print(f"åŒ–åˆç‰©å: {compound_name}")
print(f"IUPACå: {iupac}")
print(f"SMILES: {smiles}")
print(f"åˆ†å­é‡: {mw}")

<h1>æ§‹é€ æç”»</h1>
mol = Chem.MolFromSmiles(smiles)
img = Draw.MolToImage(mol, size=(400, 400))
img.save(f"{compound_name}_structure.png")</code></pre>

<strong>å‡ºåŠ›ä¾‹:</strong>
<pre><code>åŒ–åˆç‰©å: caffeine
IUPACå: 1,3,7-trimethylpurine-2,6-dione
SMILES: CN1C=NC2=C1C(=O)N(C(=O)N2C)C
åˆ†å­é‡: 194.19</code></pre>
</details>

---

<h2>ã¾ã¨ã‚</h2>

ã“ã®ç« ã§ã¯ã€ä»¥ä¸‹ã‚’å­¦ã³ã¾ã—ãŸï¼š

<h3>å­¦ç¿’ã—ãŸå†…å®¹</h3>

1. <strong>ã‚±ãƒ¢ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ã®å®šç¾©</strong>
   - åŒ–å­¦Ã—ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ã®èåˆåˆ†é‡
   - å‰µè–¬ã€æœ‰æ©Ÿææ–™ã€è§¦åª’ã€é«˜åˆ†å­ã¸ã®å¿œç”¨

2. <strong>åˆ†å­è¡¨ç¾æ³•</strong>
   - SMILES: ç·šå½¢æ–‡å­—åˆ—è¡¨ç¾
   - InChI/InChIKey: æ¨™æº–åŒ–ã•ã‚ŒãŸè­˜åˆ¥å­
   - åˆ†å­ã‚°ãƒ©ãƒ•: ãƒãƒ¼ãƒ‰ã¨ã‚¨ãƒƒã‚¸
   - 3Dæ§‹é€ : ç«‹ä½“åŒ–å­¦ã®é‡è¦æ€§

3. <strong>RDKitã®åŸºæœ¬æ“ä½œ</strong>
   - åˆ†å­ã®èª­ã¿è¾¼ã¿ã¨æç”»
   - éƒ¨åˆ†æ§‹é€ æ¤œç´¢ï¼ˆSMARTSï¼‰
   - åˆ†å­ã®ç·¨é›†ã¨å¤‰æ›

4. <strong>å®Ÿè·µï¼šåŒ»è–¬å“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢</strong>
   - ChEMBL/PubChemã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—
   - SMILESæ¤œè¨¼ã¨ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³

<h3>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>

ç¬¬2ç« ã§ã¯ã€åˆ†å­è¨˜è¿°å­ã®è¨ˆç®—ã¨QSAR/QSPRãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã‚’å­¦ã³ã¾ã™ã€‚

<strong>[ç¬¬2ç« ï¼šQSAR/QSPRå…¥é–€ - ç‰©æ€§äºˆæ¸¬ã®åŸºç¤ â†’](./chapter-2.md)</strong>

---

<h2>å‚è€ƒæ–‡çŒ®</h2>

1. Weininger, D. (1988). "SMILES, a chemical language and information system." *Journal of Chemical Information and Computer Sciences*, 28(1), 31-36. DOI: 10.1021/ci00057a005
2. Heller, S. et al. (2015). "InChI, the IUPAC International Chemical Identifier." *Journal of Cheminformatics*, 7, 23. DOI: 10.1186/s13321-015-0068-4
3. Landrum, G. (2024). "RDKit: Open-source cheminformatics." [rdkit.org](https://www.rdkit.org/)
4. Gaulton, A. et al. (2017). "The ChEMBL database in 2017." *Nucleic Acids Research*, 45(D1), D945-D954. DOI: 10.1093/nar/gkw1074

---

<strong>[â† ã‚·ãƒªãƒ¼ã‚ºãƒˆãƒƒãƒ—ã¸](./index.md)</strong> | <strong>[ç¬¬2ç« ã¸ â†’](./chapter-2.md)</strong>
<div class="navigation">
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="chapter-2.html" class="nav-button">ç¬¬2ç«  â†’</a>
</div>
    </main>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ç›£ä¿®</strong>: Dr. Yusuke Hashimotoï¼ˆæ±åŒ—å¤§å­¦ï¼‰</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-17</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mermaidCodeBlocks = document.querySelectorAll('pre.codehilite code.language-mermaid, pre code.language-mermaid');

            mermaidCodeBlocks.forEach(function(codeBlock) {
                const pre = codeBlock.parentElement;
                const mermaidCode = codeBlock.textContent;

                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode.trim();

                pre.parentNode.replaceChild(mermaidDiv, pre);
            });

            if (typeof mermaid !== 'undefined') {
                mermaid.initialize({
                    startOnLoad: true,
                    theme: 'default'
                });
                mermaid.init(undefined, document.querySelectorAll('.mermaid'));
            }
        });
    </script>
</body>
</html>
