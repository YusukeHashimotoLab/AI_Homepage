<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« ï¼šåˆ†å­ãƒ‰ãƒƒã‚­ãƒ³ã‚°ã¨ç›¸äº’ä½œç”¨è§£æ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬3ç« ï¼šåˆ†å­ãƒ‰ãƒƒã‚­ãƒ³ã‚°ã¨ç›¸äº’ä½œç”¨è§£æ</h1>
            <p class="subtitle">ã‚¿ãƒ³ãƒ‘ã‚¯è³ª-ãƒªã‚¬ãƒ³ãƒ‰çµåˆã®äºˆæ¸¬</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 25-30åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 9å€‹</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 3å•</span>
            </div>
        </div>
    </header>

    <main class="container">

<h1>ç¬¬3ç« ï¼šåˆ†å­ãƒ‰ãƒƒã‚­ãƒ³ã‚°ã¨ç›¸äº’ä½œç”¨è§£æ</h1>

<strong>ã‚¿ãƒ³ãƒ‘ã‚¯è³ª-ãƒªã‚¬ãƒ³ãƒ‰çµåˆã®äºˆæ¸¬</strong>

<h2>å­¦ç¿’ç›®æ¨™</h2>

- âœ… åˆ†å­ãƒ‰ãƒƒã‚­ãƒ³ã‚°ã®åŸç†ã¨ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°é–¢æ•°ã‚’ç†è§£ã™ã‚‹
- âœ… AutoDock Vinaã§åˆ†å­ãƒ‰ãƒƒã‚­ãƒ³ã‚°ã‚’å®Ÿè¡Œã§ãã‚‹
- âœ… çµåˆè¦ªå’Œæ€§ã‚’è©•ä¾¡ã—ã€å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã¨æ¯”è¼ƒã§ãã‚‹
- âœ… PyMOLã§çµåˆéƒ¨ä½ã¨ç›¸äº’ä½œç”¨ã‚’å¯è¦–åŒ–ã§ãã‚‹
- âœ… æ©Ÿæ¢°å­¦ç¿’ã§çµåˆäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã§ãã‚‹

<strong>èª­äº†æ™‚é–“</strong>: 25-30åˆ† | <strong>ã‚³ãƒ¼ãƒ‰ä¾‹</strong>: 9å€‹ | <strong>æ¼”ç¿’å•é¡Œ</strong>: 3å•

---

<h2>3.1 åˆ†å­ãƒ‰ãƒƒã‚­ãƒ³ã‚°ã®åŸºç¤</h2>

<h3>åˆ†å­ãƒ‰ãƒƒã‚­ãƒ³ã‚°ã¨ã¯</h3>

<strong>åˆ†å­ãƒ‰ãƒƒã‚­ãƒ³ã‚°</strong>ã¯ã€ãƒªã‚¬ãƒ³ãƒ‰ï¼ˆå°åˆ†å­ï¼‰ã¨ã‚¿ãƒ³ãƒ‘ã‚¯è³ªï¼ˆå—å®¹ä½“ï¼‰ã®çµåˆæ§˜å¼ã‚’äºˆæ¸¬ã™ã‚‹è¨ˆç®—æ‰‹æ³•ã§ã™ã€‚

<div class="mermaid">graph LR
    A[ã‚¿ãƒ³ãƒ‘ã‚¯è³ªæ§‹é€ ] --> C[ãƒ‰ãƒƒã‚­ãƒ³ã‚°<br/>ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³]
    B[ãƒªã‚¬ãƒ³ãƒ‰æ§‹é€ ] --> C
    C --> D[çµåˆãƒãƒ¼ã‚º]
    C --> E[çµåˆè¦ªå’Œæ€§]
    D --> F[è–¬å‰¤è¨­è¨ˆ]
    E --> F

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#4CAF50,color:#fff
    style D fill:#f3e5f5
    style E fill:#ffebee
    style F fill:#fff9c4</div>

<strong>ç”¨é€”</strong>:
- å‰µè–¬ï¼ˆãƒ’ãƒƒãƒˆåŒ–åˆç‰©ã®ç™ºè¦‹ï¼‰
- ãƒã‚¤ã‚ªã‚»ãƒ³ã‚µãƒ¼è¨­è¨ˆï¼ˆãƒªã‚¬ãƒ³ãƒ‰é¸æŠï¼‰
- DDSè¨­è¨ˆï¼ˆæ¨™çš„ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã¨ã®çµåˆï¼‰

---

<h3>ãƒ‰ãƒƒã‚­ãƒ³ã‚°ã®2ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>

<strong>1. ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ï¼ˆSamplingï¼‰</strong>
- ãƒªã‚¬ãƒ³ãƒ‰ã®å¯èƒ½ãªçµåˆãƒãƒ¼ã‚ºã‚’æ¢ç´¢
- æ‰‹æ³•: éºä¼çš„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­ã€ç³»çµ±çš„æ¢ç´¢

<strong>2. ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ï¼ˆScoringï¼‰</strong>
- å„ãƒãƒ¼ã‚ºã®çµåˆè¦ªå’Œæ€§ã‚’è©•ä¾¡
- ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°é–¢æ•°: åŠ›å ´ãƒ™ãƒ¼ã‚¹ã€çµŒé¨“çš„ã€çŸ¥è­˜ãƒ™ãƒ¼ã‚¹

---

<h3>AutoDock Vinaã®æ¦‚è¦</h3>

<strong>AutoDock Vina</strong>ã¯ã€æœ€ã‚‚åºƒãä½¿ã‚ã‚Œã‚‹åˆ†å­ãƒ‰ãƒƒã‚­ãƒ³ã‚°ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã™ã€‚

<strong>ç‰¹å¾´</strong>:
- é«˜é€Ÿï¼ˆå¾“æ¥ã®AutoDockã®100å€ï¼‰
- é«˜ç²¾åº¦ï¼ˆå®Ÿé¨“å€¤ã¨ã®RMSD < 2 Ã…ï¼‰
- ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹

<strong>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</strong>:
<pre><code class="language-bash"><h1>Condaã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h1>
conda install -c conda-forge vina

<h1>ã¾ãŸã¯å…¬å¼ã‚µã‚¤ãƒˆã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</h1>
<h1>http://vina.scripps.edu/</h1></code></pre>

---

<h3>Example 1: ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã¨ãƒªã‚¬ãƒ³ãƒ‰ã®æº–å‚™</h3>

<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem, Descriptors
from Bio.PDB import PDBParser
import os

<h1>ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®æº–å‚™ï¼ˆPDBãƒ•ã‚¡ã‚¤ãƒ«ï¼‰</h1>
def prepare_protein(pdb_file, output_pdbqt):
    """
    ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã‚’ãƒ‰ãƒƒã‚­ãƒ³ã‚°ç”¨ã«æº–å‚™

    Parameters:
    -----------
    pdb_file : str
        å…¥åŠ›PDBãƒ•ã‚¡ã‚¤ãƒ«
    output_pdbqt : str
        å‡ºåŠ›PDBQTãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆAutoDockå½¢å¼ï¼‰
    """
    # Open Babelã‚’ä½¿ç”¨ã—ã¦PDB â†’ PDBQTå¤‰æ›
    # PDBQT: é›»è·ã¨åŸå­ã‚¿ã‚¤ãƒ—ã‚’å«ã‚€æ‹¡å¼µPDBå½¢å¼
    cmd = f"obabel {pdb_file} -O {output_pdbqt} -xr"
    os.system(cmd)

    print(f"ã‚¿ãƒ³ãƒ‘ã‚¯è³ªæº–å‚™å®Œäº†: {output_pdbqt}")

<h1>ãƒªã‚¬ãƒ³ãƒ‰ã®æº–å‚™ï¼ˆSMILESï¼‰</h1>
def prepare_ligand_from_smiles(smiles, output_pdbqt):
    """
    SMILESã‹ã‚‰ãƒªã‚¬ãƒ³ãƒ‰ã‚’æº–å‚™

    Parameters:
    -----------
    smiles : str
        ãƒªã‚¬ãƒ³ãƒ‰ã®SMILESè¡¨è¨˜
    output_pdbqt : str
        å‡ºåŠ›PDBQTãƒ•ã‚¡ã‚¤ãƒ«
    """
    # åˆ†å­ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆ
    mol = Chem.MolFromSmiles(smiles)

    # æ°´ç´ è¿½åŠ 
    mol = Chem.AddHs(mol)

    # 3Dåº§æ¨™ç”Ÿæˆ
    AllChem.EmbedMolecule(mol, randomSeed=42)
    AllChem.MMFFOptimizeMolecule(mol)

    # PDBå½¢å¼ã§ä¿å­˜
    temp_pdb = "ligand_temp.pdb"
    Chem.MolToPDBFile(mol, temp_pdb)

    # PDB â†’ PDBQTå¤‰æ›
    cmd = f"obabel {temp_pdb} -O {output_pdbqt} -xh"
    os.system(cmd)

    # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
    os.remove(temp_pdb)

    print(f"ãƒªã‚¬ãƒ³ãƒ‰æº–å‚™å®Œäº†: {output_pdbqt}")

    # åˆ†å­æƒ…å ±è¡¨ç¤º
    mw = Descriptors.MolWt(mol)
    logp = Descriptors.MolLogP(mol)
    print(f"  åˆ†å­é‡: {mw:.1f}")
    print(f"  LogP: {logp:.2f}")

<h1>ä½¿ç”¨ä¾‹</h1>
<h1>ã‚¢ã‚¹ãƒ”ãƒªãƒ³ï¼ˆé®ç—›å‰¤ï¼‰</h1>
aspirin_smiles = "CC(=O)Oc1ccccc1C(=O)O"
prepare_ligand_from_smiles(aspirin_smiles, "aspirin.pdbqt")</code></pre>

---

<h3>Example 2: AutoDock Vinaã®å®Ÿè¡Œ</h3>

<pre><code class="language-python">import subprocess
import os

def run_autodock_vina(
    receptor_pdbqt,
    ligand_pdbqt,
    center_x, center_y, center_z,
    size_x=20, size_y=20, size_z=20,
    output_pdbqt="output.pdbqt",
    exhaustiveness=8
):
    """
    AutoDock Vinaã‚’å®Ÿè¡Œ

    Parameters:
    -----------
    receptor_pdbqt : str
        ã‚¿ãƒ³ãƒ‘ã‚¯è³ªPDBQTãƒ•ã‚¡ã‚¤ãƒ«
    ligand_pdbqt : str
        ãƒªã‚¬ãƒ³ãƒ‰PDBQTãƒ•ã‚¡ã‚¤ãƒ«
    center_x, center_y, center_z : float
        æ¢ç´¢ãƒœãƒƒã‚¯ã‚¹ã®ä¸­å¿ƒåº§æ¨™ï¼ˆÃ…ï¼‰
    size_x, size_y, size_z : float
        æ¢ç´¢ãƒœãƒƒã‚¯ã‚¹ã®ã‚µã‚¤ã‚ºï¼ˆÃ…ï¼‰
    output_pdbqt : str
        å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«
    exhaustiveness : int
        æ¢ç´¢ã®å¾¹åº•åº¦ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ8ã€ç²¾åº¦é‡è¦–ãªã‚‰16-32ï¼‰
    """

    # Vinaã‚³ãƒãƒ³ãƒ‰
    cmd = [
        "vina",
        "--receptor", receptor_pdbqt,
        "--ligand", ligand_pdbqt,
        "--center_x", str(center_x),
        "--center_y", str(center_y),
        "--center_z", str(center_z),
        "--size_x", str(size_x),
        "--size_y", str(size_y),
        "--size_z", str(size_z),
        "--out", output_pdbqt,
        "--exhaustiveness", str(exhaustiveness)
    ]

    print("=== AutoDock Vinaå®Ÿè¡Œä¸­ ===")
    print(" ".join(cmd))

    # å®Ÿè¡Œ
    result = subprocess.run(
        cmd,
        capture_output=True,
        text=True
    )

    # çµæœè¡¨ç¤º
    print(result.stdout)

    # çµåˆè¦ªå’Œæ€§ã‚’æŠ½å‡º
    affinities = []
    for line in result.stdout.split('\n'):
        if line.strip().startswith('1') or \
           line.strip().startswith('2') or \
           line.strip().startswith('3'):
            parts = line.split()
            if len(parts) >= 2:
                try:
                    affinity = float(parts[1])
                    affinities.append(affinity)
                except ValueError:
                    pass

    if affinities:
        print(f"\n=== çµåˆè¦ªå’Œæ€§ ===")
        print(f"æœ€è‰¯ã‚¹ã‚³ã‚¢: {affinities[0]:.1f} kcal/mol")
        print(f"ä¸Šä½3ã¤: {affinities[:3]}")

    return affinities

<h1>ä½¿ç”¨ä¾‹ï¼ˆæ¶ç©ºã®åº§æ¨™ï¼‰</h1>
<h1>å®Ÿéš›ã®ä½¿ç”¨ã§ã¯ã€çµåˆéƒ¨ä½ã®åº§æ¨™ã‚’æŒ‡å®š</h1>
"""
affinities = run_autodock_vina(
    receptor_pdbqt="protein.pdbqt",
    ligand_pdbqt="ligand.pdbqt",
    center_x=10.5,
    center_y=20.3,
    center_z=15.8,
    size_x=20,
    size_y=20,
    size_z=20,
    output_pdbqt="docking_result.pdbqt"
)
"""</code></pre>

<strong>å‡ºåŠ›ä¾‹</strong>:
<pre><code>=== AutoDock Vinaå®Ÿè¡Œä¸­ ===
vina --receptor protein.pdbqt --ligand ligand.pdbqt ...

Performing docking...
mode |   affinity | dist from best mode
     | (kcal/mol) | rmsd l.b.| rmsd u.b.
-----+------------+----------+----------
   1      -8.5       0.000       0.000
   2      -8.2       1.823       3.145
   3      -7.9       2.456       4.021

=== çµåˆè¦ªå’Œæ€§ ===
æœ€è‰¯ã‚¹ã‚³ã‚¢: -8.5 kcal/mol
ä¸Šä½3ã¤: [-8.5, -8.2, -7.9]</code></pre>

---

<h2>3.2 ç›¸äº’ä½œç”¨ã®å¯è¦–åŒ–ã¨è§£æ</h2>

<h3>PyMOLã«ã‚ˆã‚‹å¯è¦–åŒ–</h3>

<strong>Example 3: PyMOLã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ç”Ÿæˆ</strong>

<pre><code class="language-python">def generate_pymol_script(
    protein_pdb,
    ligand_pdbqt,
    output_script="visualize.pml"
):
    """
    PyMOLå¯è¦–åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”Ÿæˆ

    Parameters:
    -----------
    protein_pdb : str
        ã‚¿ãƒ³ãƒ‘ã‚¯è³ªPDBãƒ•ã‚¡ã‚¤ãƒ«
    ligand_pdbqt : str
        ãƒ‰ãƒƒã‚­ãƒ³ã‚°çµæœï¼ˆPDBQTï¼‰
    output_script : str
        å‡ºåŠ›PyMOLã‚¹ã‚¯ãƒªãƒ—ãƒˆ
    """
    script = f"""
<h1>PyMOLå¯è¦–åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h1>

<h1>ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿</h1>
load {protein_pdb}, protein
load {ligand_pdbqt}, ligand

<h1>ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®è¡¨ç¤ºè¨­å®š</h1>
hide everything, protein
show cartoon, protein
color cyan, protein

<h1>çµåˆéƒ¨ä½ã®è¡¨ç¤ºï¼ˆãƒªã‚¬ãƒ³ãƒ‰ã‹ã‚‰5Ã…ä»¥å†…ï¼‰</h1>
select binding_site, protein within 5 of ligand
show sticks, binding_site
color green, binding_site

<h1>ãƒªã‚¬ãƒ³ãƒ‰ã®è¡¨ç¤º</h1>
hide everything, ligand
show sticks, ligand
color yellow, ligand
util.cbay ligand

<h1>æ°´ç´ çµåˆã®è¡¨ç¤º</h1>
distance hbonds, ligand, binding_site, mode=2
color red, hbonds

<h1>è¦–ç‚¹è¨­å®š</h1>
zoom ligand, 5
set stick_radius, 0.3
set sphere_scale, 0.25

<h1>èƒŒæ™¯ã‚’ç™½ã«</h1>
bg_color white

<h1>ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°è¨­å®š</h1>
set ray_shadows, 0
set antialias, 2

<h1>ç”»åƒä¿å­˜</h1>
ray 1200, 1200
png binding_site.png, dpi=300

print("å¯è¦–åŒ–å®Œäº†: binding_site.png")
"""

    with open(output_script, 'w') as f:
        f.write(script)

    print(f"PyMOLã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆ: {output_script}")
    print("å®Ÿè¡Œæ–¹æ³•: pymol visualize.pml")

<h1>ä½¿ç”¨ä¾‹</h1>
generate_pymol_script(
    "protein.pdb",
    "docking_result.pdbqt",
    "visualize.pml"
)</code></pre>

---

<h3>ç›¸äº’ä½œç”¨ã®å®šé‡è§£æ</h3>

<strong>Example 4: æ°´ç´ çµåˆã®æ¤œå‡º</strong>

<pre><code class="language-python">from Bio.PDB import PDBParser, NeighborSearch
import numpy as np

def detect_hydrogen_bonds(
    protein_structure,
    ligand_structure,
    distance_cutoff=3.5,  # Ã…
    angle_cutoff=120  # degrees
):
    """
    æ°´ç´ çµåˆã‚’æ¤œå‡º

    Parameters:
    -----------
    protein_structure : Bio.PDB.Structure
        ã‚¿ãƒ³ãƒ‘ã‚¯è³ªæ§‹é€ 
    ligand_structure : Bio.PDB.Structure
        ãƒªã‚¬ãƒ³ãƒ‰æ§‹é€ 
    distance_cutoff : float
        è·é›¢ã®é–¾å€¤ï¼ˆÃ…ï¼‰
    angle_cutoff : float
        è§’åº¦ã®é–¾å€¤ï¼ˆåº¦ï¼‰

    Returns:
    --------
    list: æ°´ç´ çµåˆã®ãƒªã‚¹ãƒˆ
    """
    # ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®å…¨åŸå­
    protein_atoms = [
        atom for atom in protein_structure.get_atoms()
    ]

    # ãƒªã‚¬ãƒ³ãƒ‰ã®å…¨åŸå­
    ligand_atoms = [
        atom for atom in ligand_structure.get_atoms()
    ]

    # è¿‘å‚æ¢ç´¢
    ns = NeighborSearch(protein_atoms)

    hbonds = []

    # ãƒªã‚¬ãƒ³ãƒ‰ã®å„åŸå­ã«ã¤ã„ã¦
    for ligand_atom in ligand_atoms:
        # ãƒ‰ãƒŠãƒ¼/ã‚¢ã‚¯ã‚»ãƒ—ã‚¿ãƒ¼åˆ¤å®šï¼ˆç°¡æ˜“ç‰ˆï¼‰
        if ligand_atom.element not in ['N', 'O']:
            continue

        # è¿‘å‚ã®ã‚¿ãƒ³ãƒ‘ã‚¯è³ªåŸå­
        nearby_atoms = ns.search(
            ligand_atom.get_coord(),
            distance_cutoff
        )

        for protein_atom in nearby_atoms:
            if protein_atom.element not in ['N', 'O']:
                continue

            # è·é›¢è¨ˆç®—
            distance = ligand_atom - protein_atom

            if distance <= distance_cutoff:
                hbonds.append({
                    'ligand_atom': ligand_atom.get_full_id(),
                    'protein_atom': protein_atom.get_full_id(),
                    'distance': distance
                })

    return hbonds

<h1>ä½¿ç”¨ä¾‹ï¼ˆæ¶ç©ºã®æ§‹é€ ï¼‰</h1>
"""
parser = PDBParser(QUIET=True)
protein = parser.get_structure('protein', 'protein.pdb')
ligand = parser.get_structure('ligand', 'ligand.pdb')

hbonds = detect_hydrogen_bonds(protein, ligand)

print(f"=== æ°´ç´ çµåˆ ===")
print(f"æ¤œå‡ºæ•°: {len(hbonds)}")

for i, hb in enumerate(hbonds[:5], 1):
    print(f"\næ°´ç´ çµåˆ {i}:")
    print(f"  è·é›¢: {hb['distance']:.2f} Ã…")
    print(f"  ãƒªã‚¬ãƒ³ãƒ‰åŸå­: {hb['ligand_atom']}")
    print(f"  ã‚¿ãƒ³ãƒ‘ã‚¯è³ªåŸå­: {hb['protein_atom']}")
"""</code></pre>

---

<h3>ç–æ°´æ€§ç›¸äº’ä½œç”¨ã®è§£æ</h3>

<strong>Example 5: ç–æ°´æ€§æ¥è§¦ã®æ¤œå‡º</strong>

<pre><code class="language-python">def detect_hydrophobic_contacts(
    protein_structure,
    ligand_structure,
    distance_cutoff=4.5  # Ã…
):
    """
    ç–æ°´æ€§ç›¸äº’ä½œç”¨ã‚’æ¤œå‡º

    Parameters:
    -----------
    protein_structure : Bio.PDB.Structure
    ligand_structure : Bio.PDB.Structure
    distance_cutoff : float
        ç–æ°´æ€§ç›¸äº’ä½œç”¨ã®é–¾å€¤ï¼ˆÃ…ï¼‰

    Returns:
    --------
    list: ç–æ°´æ€§æ¥è§¦ã®ãƒªã‚¹ãƒˆ
    """
    # ç–æ°´æ€§ã‚¢ãƒŸãƒé…¸
    hydrophobic_residues = [
        'ALA', 'VAL', 'ILE', 'LEU', 'MET',
        'PHE', 'TRP', 'PRO'
    ]

    # ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®ç–æ°´æ€§æ®‹åŸºã®ç‚­ç´ åŸå­
    protein_hydrophobic_atoms = []
    for residue in protein_structure.get_residues():
        if residue.get_resname() in hydrophobic_residues:
            for atom in residue:
                if atom.element == 'C':
                    protein_hydrophobic_atoms.append(atom)

    # ãƒªã‚¬ãƒ³ãƒ‰ã®ç‚­ç´ åŸå­
    ligand_carbon_atoms = [
        atom for atom in ligand_structure.get_atoms()
        if atom.element == 'C'
    ]

    # è¿‘å‚æ¢ç´¢
    ns = NeighborSearch(protein_hydrophobic_atoms)

    contacts = []

    for ligand_atom in ligand_carbon_atoms:
        nearby_atoms = ns.search(
            ligand_atom.get_coord(),
            distance_cutoff
        )

        for protein_atom in nearby_atoms:
            distance = ligand_atom - protein_atom

            if distance <= distance_cutoff:
                contacts.append({
                    'ligand_atom': ligand_atom.get_full_id(),
                    'protein_atom': protein_atom.get_full_id(),
                    'residue': protein_atom.get_parent().get_resname(),
                    'distance': distance
                })

    return contacts

<h1>ä½¿ç”¨ä¾‹</h1>
"""
contacts = detect_hydrophobic_contacts(protein, ligand)

print(f"\n=== ç–æ°´æ€§æ¥è§¦ ===")
print(f"æ¤œå‡ºæ•°: {len(contacts)}")

<h1>æ®‹åŸºã”ã¨ã«é›†è¨ˆ</h1>
from collections import Counter
residue_counts = Counter(
    [c['residue'] for c in contacts]
)

print("\næ®‹åŸºåˆ¥ã®æ¥è§¦æ•°:")
for residue, count in residue_counts.most_common(5):
    print(f"  {residue}: {count}")
"""</code></pre>

---

<h2>3.3 æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹çµåˆäºˆæ¸¬</h2>

<h3>ã‚°ãƒ©ãƒ•ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆGNNï¼‰</h3>

<strong>Example 6: ã‚¿ãƒ³ãƒ‘ã‚¯è³ª-ãƒªã‚¬ãƒ³ãƒ‰è¤‡åˆä½“ã®ã‚°ãƒ©ãƒ•è¡¨ç¾</strong>

<pre><code class="language-python">import networkx as nx
import numpy as np
from rdkit import Chem

def protein_ligand_to_graph(protein_atoms, ligand_mol):
    """
    ã‚¿ãƒ³ãƒ‘ã‚¯è³ª-ãƒªã‚¬ãƒ³ãƒ‰è¤‡åˆä½“ã‚’ã‚°ãƒ©ãƒ•ã«å¤‰æ›

    Parameters:
    -----------
    protein_atoms : list
        ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®åŸå­ãƒªã‚¹ãƒˆ
    ligand_mol : RDKit Mol
        ãƒªã‚¬ãƒ³ãƒ‰åˆ†å­

    Returns:
    --------
    networkx.Graph: è¤‡åˆä½“ã‚°ãƒ©ãƒ•
    """
    G = nx.Graph()

    # ãƒªã‚¬ãƒ³ãƒ‰ã®ã‚°ãƒ©ãƒ•ï¼ˆåˆ†å­ã‚°ãƒ©ãƒ•ï¼‰
    for atom in ligand_mol.GetAtoms():
        G.add_node(
            f"L{atom.GetIdx()}",
            atom_type=atom.GetSymbol(),
            atomic_num=atom.GetAtomicNum(),
            hybridization=str(atom.GetHybridization()),
            node_type='ligand'
        )

    # ãƒªã‚¬ãƒ³ãƒ‰ã®çµåˆ
    for bond in ligand_mol.GetBonds():
        G.add_edge(
            f"L{bond.GetBeginAtomIdx()}",
            f"L{bond.GetEndAtomIdx()}",
            bond_type=str(bond.GetBondType())
        )

    # ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®åŸå­ï¼ˆç°¡ç•¥åŒ–: ä»£è¡¨åŸå­ã®ã¿ï¼‰
    for i, atom in enumerate(protein_atoms[:50]):  # æœ€åˆã®50åŸå­
        G.add_node(
            f"P{i}",
            atom_type=atom.element,
            node_type='protein'
        )

    # ã‚¿ãƒ³ãƒ‘ã‚¯è³ª-ãƒªã‚¬ãƒ³ãƒ‰é–“ã®ç›¸äº’ä½œç”¨ã‚¨ãƒƒã‚¸
    # ï¼ˆè·é›¢ãƒ™ãƒ¼ã‚¹ã€é–¾å€¤4Ã…ï¼‰
    ligand_coords = ligand_mol.GetConformer().GetPositions()

    for i, protein_atom in enumerate(protein_atoms[:50]):
        protein_coord = protein_atom.get_coord()

        for j, ligand_coord in enumerate(ligand_coords):
            distance = np.linalg.norm(
                protein_coord - ligand_coord
            )

            if distance < 4.0:  # 4Ã…ä»¥å†…
                G.add_edge(
                    f"P{i}",
                    f"L{j}",
                    interaction='contact',
                    distance=distance
                )

    return G

<h1>ä½¿ç”¨ä¾‹</h1>
"""
ligand_smiles = "CC(=O)Oc1ccccc1C(=O)O"  # ã‚¢ã‚¹ãƒ”ãƒªãƒ³
ligand_mol = Chem.MolFromSmiles(ligand_smiles)
ligand_mol = Chem.AddHs(ligand_mol)
AllChem.EmbedMolecule(ligand_mol)

<h1>protein_atoms ã¯ Bio.PDB.Structure ã‹ã‚‰å–å¾—</h1>
<h1>complex_graph = protein_ligand_to_graph(</h1>
<h1>    protein_atoms, ligand_mol</h1>
<h1>)</h1>

<h1>ã‚°ãƒ©ãƒ•çµ±è¨ˆ</h1>
<h1>print(f"ãƒãƒ¼ãƒ‰æ•°: {complex_graph.number_of_nodes()}")</h1>
<h1>print(f"ã‚¨ãƒƒã‚¸æ•°: {complex_graph.number_of_edges()}")</h1>
"""</code></pre>

---

<h3>DeepDockingé¢¨ã®äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«</h3>

<strong>Example 7: çµåˆè¦ªå’Œæ€§äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«</strong>

<pre><code class="language-python">import numpy as np
import pandas as pd
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_absolute_error, r2_score

def extract_complex_features(
    protein_structure,
    ligand_mol
):
    """
    ã‚¿ãƒ³ãƒ‘ã‚¯è³ª-ãƒªã‚¬ãƒ³ãƒ‰è¤‡åˆä½“ã‹ã‚‰ç‰¹å¾´é‡ã‚’æŠ½å‡º

    Returns:
    --------
    dict: ç‰¹å¾´é‡è¾æ›¸
    """
    from rdkit.Chem import Descriptors

    # ãƒªã‚¬ãƒ³ãƒ‰ã®ç‰¹å¾´
    ligand_features = {
        'ligand_mw': Descriptors.MolWt(ligand_mol),
        'ligand_logp': Descriptors.MolLogP(ligand_mol),
        'ligand_hbd': Descriptors.NumHDonors(ligand_mol),
        'ligand_hba': Descriptors.NumHAcceptors(ligand_mol),
        'ligand_rotatable_bonds': Descriptors.NumRotatableBonds(
            ligand_mol
        ),
        'ligand_aromatic_rings': Descriptors.NumAromaticRings(
            ligand_mol
        )
    }

    # ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®ç‰¹å¾´ï¼ˆç°¡ç•¥åŒ–ï¼‰
    # å®Ÿéš›ã¯çµåˆéƒ¨ä½ã®æ®‹åŸºçµ„æˆãªã©
    protein_features = {
        'binding_site_residues': 10,  # ä»®ã®å€¤
        'binding_site_hydrophobic': 0.4,
        'binding_site_charged': 0.3
    }

    return {<strong>ligand_features, </strong>protein_features}

<h1>ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆå®Ÿéš›ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ï¼‰</h1>
np.random.seed(42)

n_samples = 200
X_features = []
y_affinities = []

for _ in range(n_samples):
    # ãƒ©ãƒ³ãƒ€ãƒ ãªç‰¹å¾´é‡ï¼ˆãƒ‡ãƒ¢ç”¨ï¼‰
    features = {
        'ligand_mw': np.random.uniform(150, 500),
        'ligand_logp': np.random.uniform(-2, 5),
        'ligand_hbd': np.random.randint(0, 6),
        'ligand_hba': np.random.randint(0, 10),
        'ligand_rotatable_bonds': np.random.randint(0, 10),
        'ligand_aromatic_rings': np.random.randint(0, 4),
        'binding_site_residues': np.random.randint(5, 20),
        'binding_site_hydrophobic': np.random.uniform(0.2, 0.6),
        'binding_site_charged': np.random.uniform(0.1, 0.5)
    }

    # çµåˆè¦ªå’Œæ€§ï¼ˆkcal/molï¼‰
    # å®Ÿéš›ã®é–¢ä¿‚å¼ã«åŸºã¥ã„ã¦ç”Ÿæˆ
    affinity = (
        -0.1 * features['ligand_mw'] / 100
        - 1.5 * features['ligand_hbd']
        - 1.0 * features['ligand_hba']
        + 2.0 * features['ligand_logp']
        + np.random.randn() * 1.0
    )

    X_features.append(list(features.values()))
    y_affinities.append(affinity)

X = np.array(X_features)
y = np.array(y_affinities)

<h1>è¨“ç·´/ãƒ†ã‚¹ãƒˆåˆ†å‰²</h1>
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

<h1>ãƒ¢ãƒ‡ãƒ«è¨“ç·´</h1>
model = RandomForestRegressor(
    n_estimators=100,
    max_depth=10,
    random_state=42
)

model.fit(X_train, y_train)

<h1>äºˆæ¸¬</h1>
y_pred = model.predict(X_test)

<h1>è©•ä¾¡</h1>
mae = mean_absolute_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f"=== çµåˆè¦ªå’Œæ€§äºˆæ¸¬ãƒ¢ãƒ‡ãƒ« ===")
print(f"MAE: {mae:.2f} kcal/mol")
print(f"RÂ²: {r2:.3f}")

<h1>ç‰¹å¾´é‡é‡è¦åº¦</h1>
feature_names = [
    'MW', 'LogP', 'HBD', 'HBA', 'RotBonds',
    'AromRings', 'BSResidues', 'BSHydrophobic',
    'BSCharged'
]

importance_df = pd.DataFrame({
    'feature': feature_names,
    'importance': model.feature_importances_
}).sort_values('importance', ascending=False)

print("\nç‰¹å¾´é‡é‡è¦åº¦:")
print(importance_df)</code></pre>

---

<h2>3.4 ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ï¼šæŠ—ä½“-æŠ—åŸç›¸äº’ä½œç”¨</h2>

<h3>æŠ—ä½“æ§‹é€ ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°</h3>

<strong>Example 8: æŠ—ä½“å¯å¤‰é ˜åŸŸã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°</strong>

<pre><code class="language-python">def model_antibody_structure(
    heavy_chain_seq,
    light_chain_seq,
    output_pdb="antibody_model.pdb"
):
    """
    æŠ—ä½“æ§‹é€ ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°

    Parameters:
    -----------
    heavy_chain_seq : str
        é‡é–ã®é…åˆ—
    light_chain_seq : str
        è»½é–ã®é…åˆ—
    output_pdb : str
        å‡ºåŠ›PDBãƒ•ã‚¡ã‚¤ãƒ«

    Note:
    -----
    å®Ÿéš›ã«ã¯å°‚é–€ãƒ„ãƒ¼ãƒ«ï¼ˆModellerã€AlphaFold2ï¼‰ã‚’ä½¿ç”¨
    """
    print("=== æŠ—ä½“æ§‹é€ ãƒ¢ãƒ‡ãƒªãƒ³ã‚° ===")
    print(f"é‡é–é•·: {len(heavy_chain_seq)} aa")
    print(f"è»½é–é•·: {len(light_chain_seq)} aa")

    # CDRï¼ˆç›¸è£œæ€§æ±ºå®šé ˜åŸŸï¼‰ã®æ¨å®š
    # ç°¡ç•¥åŒ–: é‡é–CDR3ã¯95-102ç•ªç›®ã¨ä»®å®š
    cdr_h3_start = 95
    cdr_h3_end = 102

    if len(heavy_chain_seq) >= cdr_h3_end:
        cdr_h3_seq = heavy_chain_seq[cdr_h3_start:cdr_h3_end]
        print(f"\nCDR-H3é…åˆ—: {cdr_h3_seq}")
        print(f"é•·ã•: {len(cdr_h3_seq)} aa")

    # å®Ÿéš›ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã¯AlphaFold2ã‚„Modeller ã§å®Ÿè¡Œ
    # ã“ã“ã§ã¯ãƒ‡ãƒ¢ã¨ã—ã¦æƒ…å ±è¡¨ç¤ºã®ã¿

    print(f"\nãƒ¢ãƒ‡ãƒ«ä¿å­˜äºˆå®š: {output_pdb}")
    print("å®Ÿéš›ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã«ã¯AlphaFold2ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„")

<h1>ä½¿ç”¨ä¾‹</h1>
heavy_chain = "QVQLQQSGPGLVKPSQTLSLTCAISGDSVSSNSAAWN" * 3
light_chain = "DIQMTQSPSSLSASVGDRVTITCRASQDVNTAVAWY" * 3

model_antibody_structure(heavy_chain, light_chain)</code></pre>

---

<h3>ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—äºˆæ¸¬</h3>

<strong>Example 9: ç·šå½¢ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—äºˆæ¸¬</strong>

<pre><code class="language-python">def predict_linear_epitopes(
    antigen_sequence,
    window_size=9
):
    """
    ç·šå½¢ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—ã‚’äºˆæ¸¬ï¼ˆç°¡æ˜“ç‰ˆï¼‰

    Parameters:
    -----------
    antigen_sequence : str
        æŠ—åŸã®ã‚¢ãƒŸãƒé…¸é…åˆ—
    window_size : int
        ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚º

    Returns:
    --------
    list: ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—å€™è£œã®ãƒªã‚¹ãƒˆ
    """
    # ç°¡æ˜“çš„ãªäºˆæ¸¬ï¼ˆå®Ÿéš›ã¯Bepipredã€IEDB toolsãªã©ã‚’ä½¿ç”¨ï¼‰

    # ç–æ°´æ€§ã€é›»è·ã€è¡¨é¢éœ²å‡ºã‚’è€ƒæ…®ã—ãŸã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
    hydrophobic_aa = "AVILMFWP"
    charged_aa = "KRHDE"
    polar_aa = "STNQYC"

    epitope_candidates = []

    for i in range(len(antigen_sequence) - window_size + 1):
        peptide = antigen_sequence[i:i+window_size]

        # ã‚¹ã‚³ã‚¢è¨ˆç®—
        hydrophobic_count = sum(
            1 for aa in peptide if aa in hydrophobic_aa
        )
        charged_count = sum(
            1 for aa in peptide if aa in charged_aa
        )
        polar_count = sum(
            1 for aa in peptide if aa in polar_aa
        )

        # ç°¡æ˜“ã‚¹ã‚³ã‚¢: ãƒãƒ©ãƒ³ã‚¹ã®è‰¯ã„ãƒšãƒ—ãƒãƒ‰ã‚’é¸å¥½
        score = (
            0.3 * charged_count +
            0.5 * polar_count +
            0.2 * hydrophobic_count
        )

        epitope_candidates.append({
            'position': i,
            'peptide': peptide,
            'score': score
        })

    # ã‚¹ã‚³ã‚¢é †ã«ã‚½ãƒ¼ãƒˆ
    epitope_candidates.sort(
        key=lambda x: x['score'],
        reverse=True
    )

    return epitope_candidates

<h1>ä½¿ç”¨ä¾‹</h1>
antigen_seq = """
MFVFLVLLPLVSSQCVNLTTRTQLPPAYTNSFTRGVYYPDKVFRSSVLHS
TQDLFLPFFSNVTWFHAIHVSGTNGTKRFDNPVLPFNDGVYFASTEKSNI
IRGWIFGTTLDSKTQSLLIVNNATNVVIKVCEFQFCNDPFLGVYYHKNNK
SWMESEFRVYSSANNCTFEYVSQPFLMDLEGKQGNFKNLREFVFKNIDGY
FKIYSKHTPINLVRDLPQGFSALEPLVDLPIGINITRFQTLLALHRSYLT
PGDSSSGWTAGAAAYYVGYLQPRTFLLKYNENGTITDAVDCALDPLSETK
CTLKSFTVEKGIYQTSNFRVQPTESIVRFPNITNLCPFGEVFNATRFASV
YAWNRKRISNCVADYSVLYNSASFSTFKCYGVSPTKLNDLCFTNVYADSF
VIRGDEVRQIAPGQTGKIADYNYKLPDDFTGCVIAWNSNNLDSKVGGNYN
YLYRLFRKSNLKPFERDISTEIYQAGSTPCNGVEGFNCYFPLQSYGFQPT
NGVGYQPYRVVVLSFELLHAPATVCGPKKSTNLVKNKCVNF
"""
antigen_seq = antigen_seq.replace("\n", "").replace(" ", "")

epitopes = predict_linear_epitopes(antigen_seq, window_size=9)

print(f"=== ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—äºˆæ¸¬ ===")
print(f"é…åˆ—é•·: {len(antigen_seq)} aa")
print(f"\nä¸Šä½5å€™è£œ:")

for i, ep in enumerate(epitopes[:5], 1):
    print(f"\n{i}. ä½ç½® {ep['position']}")
    print(f"   é…åˆ—: {ep['peptide']}")
    print(f"   ã‚¹ã‚³ã‚¢: {ep['score']:.2f}")</code></pre>

---

<h2>3.5 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

1. <strong>åˆ†å­ãƒ‰ãƒƒã‚­ãƒ³ã‚°</strong>
   - AutoDock Vinaã«ã‚ˆã‚‹ãƒ‰ãƒƒã‚­ãƒ³ã‚°
   - çµåˆè¦ªå’Œæ€§ã‚¹ã‚³ã‚¢

2. <strong>ç›¸äº’ä½œç”¨è§£æ</strong>
   - æ°´ç´ çµåˆã®æ¤œå‡º
   - ç–æ°´æ€§æ¥è§¦
   - PyMOLå¯è¦–åŒ–

3. <strong>æ©Ÿæ¢°å­¦ç¿’</strong>
   - ã‚°ãƒ©ãƒ•è¡¨ç¾
   - çµåˆè¦ªå’Œæ€§äºˆæ¸¬

4. <strong>æŠ—ä½“-æŠ—åŸ</strong>
   - æŠ—ä½“æ§‹é€ ãƒ¢ãƒ‡ãƒªãƒ³ã‚°
   - ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—äºˆæ¸¬

<h3>æ¬¡ã®ç« ã¸</h3>

ç¬¬4ç« ã§ã¯ã€<strong>ãƒã‚¤ã‚ªã‚»ãƒ³ã‚µãƒ¼ãƒ»DDSææ–™è¨­è¨ˆ</strong>ã‚’å­¦ã³ã¾ã™ã€‚

<strong>[ç¬¬4ç« ï¼šãƒã‚¤ã‚ªã‚»ãƒ³ã‚µãƒ¼ãƒ»DDSææ–™è¨­è¨ˆ â†’](./chapter-4.md)</strong>

---

<h2>å‚è€ƒæ–‡çŒ®</h2>

1. Trott, O. & Olson, A. J. (2010). "AutoDock Vina: improving the
   speed and accuracy of docking with a new scoring function."
   *Journal of Computational Chemistry*, 31(2), 455-461.

2. Burley, S. K. et al. (2021). "RCSB Protein Data Bank."
   *Nucleic Acids Research*, 49(D1), D437-D451.

---

<h2>ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³</h2>

<strong>[â† ç¬¬2ç« ](./chapter-2.md)</strong> | <strong>[ç¬¬4ç«  â†’](./chapter-4.md)</strong> | <strong>[ç›®æ¬¡](./index.md)</strong>
<div class="navigation">
    <a href="chapter-2.html" class="nav-button">â† ç¬¬2ç« </a>
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="chapter-4.html" class="nav-button">ç¬¬4ç«  â†’</a>
</div>
    </main>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ç›£ä¿®</strong>: Dr. Yusuke Hashimotoï¼ˆæ±åŒ—å¤§å­¦ï¼‰</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-17</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mermaidCodeBlocks = document.querySelectorAll('pre.codehilite code.language-mermaid, pre code.language-mermaid');

            mermaidCodeBlocks.forEach(function(codeBlock) {
                const pre = codeBlock.parentElement;
                const mermaidCode = codeBlock.textContent;

                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode.trim();

                pre.parentNode.replaceChild(mermaidDiv, pre);
            });

            if (typeof mermaid !== 'undefined') {
                mermaid.initialize({
                    startOnLoad: true,
                    theme: 'default'
                });
                mermaid.init(undefined, document.querySelectorAll('.mermaid'));
            }
        });
    </script>
</body>
</html>
