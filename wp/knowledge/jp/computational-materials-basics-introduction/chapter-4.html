<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬4ç« ï¼šãƒ•ã‚©ãƒãƒ³è¨ˆç®—ã¨ç†±åŠ›å­¦ç‰¹æ€§ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬4ç« ï¼šãƒ•ã‚©ãƒãƒ³è¨ˆç®—ã¨ç†±åŠ›å­¦ç‰¹æ€§</h1>
            <p class="subtitle">æ ¼å­æŒ¯å‹•ã‹ã‚‰ç†±ä¼å°ã¾ã§</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 20-25åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´šã€œä¸Šç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 6å€‹</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 0å•</span>
            </div>
        </div>
    </header>

    <main class="container">

<h1>ç¬¬4ç« ï¼šãƒ•ã‚©ãƒãƒ³è¨ˆç®—ã¨ç†±åŠ›å­¦ç‰¹æ€§</h1>

<h2>å­¦ç¿’ç›®æ¨™</h2>

ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š
- æ ¼å­æŒ¯å‹•ï¼ˆãƒ•ã‚©ãƒãƒ³ï¼‰ã®ç†è«–çš„åŸºç¤ã‚’ç†è§£ã™ã‚‹
- èª¿å’Œè¿‘ä¼¼ã¨å‹•åŠ›å­¦è¡Œåˆ—ã®æ¦‚å¿µã‚’èª¬æ˜ã§ãã‚‹
- Phonopyã§å®Ÿéš›ã«ãƒ•ã‚©ãƒãƒ³è¨ˆç®—ã‚’å®Ÿè¡Œã§ãã‚‹
- ãƒ•ã‚©ãƒãƒ³ãƒãƒ³ãƒ‰æ§‹é€ ã¨çŠ¶æ…‹å¯†åº¦ã‚’è§£é‡ˆã§ãã‚‹
- ç†±åŠ›å­¦ç‰¹æ€§ï¼ˆæ¯”ç†±ã€è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼‰ã‚’è¨ˆç®—ã§ãã‚‹

---

<h2>4.1 æ ¼å­æŒ¯å‹•ã®ç†è«–</h2>

<h3>èª¿å’ŒæŒ¯å‹•å­ãƒ¢ãƒ‡ãƒ«</h3>

çµæ™¶ä¸­ã®åŸå­ã¯å¹³è¡¡ä½ç½®$\mathbf{R}_I^0$ã®å‘¨ã‚Šã§æŒ¯å‹•ã—ã¾ã™ã€‚å¤‰ä½ã‚’$\mathbf{u}_I$ã¨ã™ã‚‹ã¨ï¼š

$$
\mathbf{R}_I = \mathbf{R}_I^0 + \mathbf{u}_I
$$

ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’Taylorå±•é–‹ï¼ˆèª¿å’Œè¿‘ä¼¼ï¼‰ï¼š

$$
U = U_0 + \sum_I \frac{\partial U}{\partial \mathbf{u}_I}\Bigg|_0 \mathbf{u}_I + \frac{1}{2}\sum_{I,J} \mathbf{u}_I \cdot \frac{\partial^2 U}{\partial \mathbf{u}_I \partial \mathbf{u}_J}\Bigg|_0 \cdot \mathbf{u}_J + O(\mathbf{u}^3)
$$

å¹³è¡¡ä½ç½®ã§ã¯ç¬¬1é …ãŒã‚¼ãƒ­ãªã®ã§ï¼š

$$
U \approx U_0 + \frac{1}{2}\sum_{I,J} \mathbf{u}_I \cdot \mathbf{\Phi}_{IJ} \cdot \mathbf{u}_J
$$

$\mathbf{\Phi}_{IJ}$ã¯<strong>åŠ›å®šæ•°è¡Œåˆ—</strong>ï¼ˆforce constant matrixï¼‰ï¼š

$$
\Phi_{IJ}^{\alpha\beta} = \frac{\partial^2 U}{\partial u_I^\alpha \partial u_J^\beta}\Bigg|_0
$$

<h3>é‹å‹•æ–¹ç¨‹å¼</h3>

åŸå­$I$ã®é‹å‹•æ–¹ç¨‹å¼ï¼š

$$
M_I \frac{d^2 u_I^\alpha}{dt^2} = -\sum_{J,\beta} \Phi_{IJ}^{\alpha\beta} u_J^\beta
$$

å¹³é¢æ³¢è§£ã‚’ä»®å®šï¼š

$$
u_I^\alpha = \frac{1}{\sqrt{M_I}} e_I^\alpha(\mathbf{k}) e^{i(\mathbf{k}\cdot\mathbf{R}_I - \omega t)}
$$

<strong>å‹•åŠ›å­¦è¡Œåˆ—</strong>ï¼ˆdynamical matrixï¼‰ã‚’å°å…¥ï¼š

$$
D_{IJ}^{\alpha\beta}(\mathbf{k}) = \frac{1}{\sqrt{M_I M_J}} \Phi_{IJ}^{\alpha\beta} e^{i\mathbf{k}\cdot(\mathbf{R}_I - \mathbf{R}_J)}
$$

<h3>å›ºæœ‰å€¤å•é¡Œ</h3>

$$
\sum_{J,\beta} D_{IJ}^{\alpha\beta}(\mathbf{k}) e_J^\beta(\mathbf{k}) = \omega^2(\mathbf{k}) e_I^\alpha(\mathbf{k})
$$

- $\omega(\mathbf{k})$: ãƒ•ã‚©ãƒãƒ³ã®è§’æŒ¯å‹•æ•°ï¼ˆãƒ•ã‚©ãƒãƒ³åˆ†æ•£ï¼‰
- $\mathbf{e}(\mathbf{k})$: ãƒ•ã‚©ãƒãƒ³ã®å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆåæ¥µãƒ™ã‚¯ãƒˆãƒ«ï¼‰

<strong>ãƒ•ã‚©ãƒãƒ³ãƒãƒ³ãƒ‰ã®æ•°</strong>: $3N_{\text{atom}}$æœ¬ï¼ˆå˜ä½èƒå†…åŸå­æ•°$N_{\text{atom}}$ã«å¯¾ã—ã¦ï¼‰

---

<h2>4.2 ãƒ•ã‚©ãƒãƒ³ã®åˆ†é¡</h2>

<h3>éŸ³éŸ¿ãƒ¢ãƒ¼ãƒ‰ï¼ˆAcoustic modesï¼‰</h3>

- $\omega(\mathbf{k}) \to 0$ as $\mathbf{k} \to 0$
- Î“ç‚¹ï¼ˆ$\mathbf{k}=0$ï¼‰ã§å‘¨æ³¢æ•°ãŒã‚¼ãƒ­
- 3æœ¬ï¼ˆ1æœ¬ã®ç¸¦æ³¢LAã€2æœ¬ã®æ¨ªæ³¢TAï¼‰
- ç‰©ç†çš„æ„å‘³: ä¸¦é€²é‹å‹•

<h3>å…‰å­¦ãƒ¢ãƒ¼ãƒ‰ï¼ˆOptical modesï¼‰</h3>

- $\omega(\mathbf{k}) \neq 0$ at $\mathbf{k} = 0$
- Î“ç‚¹ã§æœ‰é™ã®å‘¨æ³¢æ•°
- $3(N_{\text{atom}} - 1)$æœ¬
- ç‰©ç†çš„æ„å‘³: å˜ä½èƒå†…ã®ç›¸å¯¾é‹å‹•

<h3>ç¸¦æ³¢ï¼ˆLongitudinalï¼‰vs æ¨ªæ³¢ï¼ˆTransverseï¼‰</h3>

- <strong>ç¸¦æ³¢ï¼ˆLï¼‰</strong>: æŒ¯å‹•æ–¹å‘ãŒæ³¢ã®é€²è¡Œæ–¹å‘ã¨å¹³è¡Œ
- <strong>æ¨ªæ³¢ï¼ˆTï¼‰</strong>: æŒ¯å‹•æ–¹å‘ãŒæ³¢ã®é€²è¡Œæ–¹å‘ã¨å‚ç›´

<strong>å˜åŸå­çµæ™¶ï¼ˆSi, Cuãªã©ï¼‰</strong>:
- éŸ³éŸ¿ãƒ¢ãƒ¼ãƒ‰: 3æœ¬ï¼ˆ1 LA + 2 TAï¼‰
- å…‰å­¦ãƒ¢ãƒ¼ãƒ‰: ãªã—

<strong>2åŸå­çµæ™¶ï¼ˆNaCl, GaAsãªã©ï¼‰</strong>:
- éŸ³éŸ¿ãƒ¢ãƒ¼ãƒ‰: 3æœ¬
- å…‰å­¦ãƒ¢ãƒ¼ãƒ‰: 3æœ¬ï¼ˆ1 LO + 2 TOï¼‰

---

<h2>4.3 Phonopyã«ã‚ˆã‚‹å®Ÿè·µ</h2>

<h3>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h3>

<pre><code class="language-bash">pip install phonopy
<h1>ã¾ãŸã¯condaã§</h1>
conda install -c conda-forge phonopy</code></pre>

<h3>Example 1: Siã®ãƒ•ã‚©ãƒãƒ³è¨ˆç®—ï¼ˆGPAWä½¿ç”¨ï¼‰</h3>

<strong>Step 1: åŸºåº•çŠ¶æ…‹è¨ˆç®—</strong>

<pre><code class="language-python">from ase.build import bulk
from gpaw import GPAW, PW

<h1>Siçµæ™¶ã®ä½œæˆ</h1>
si = bulk('Si', 'diamond', a=5.43)

<h1>DFTè¨ˆç®—</h1>
calc = GPAW(mode=PW(400),
            xc='PBE',
            kpts=(8, 8, 8),
            txt='si_gs.txt')

si.calc = calc
si.get_potential_energy()
calc.write('si_groundstate.gpw')</code></pre>

<strong>Step 2: Phonopyç”¨ã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«ä½œæˆ</strong>

<pre><code class="language-bash"><h1>phonopy_disp.confã‚’ä½œæˆ</h1>
cat > phonopy_disp.conf <<EOF
DIM = 2 2 2
ATOM_NAME = Si
EOF

<h1>Phonopyã§å¤‰ä½æ§‹é€ ã‚’ç”Ÿæˆ</h1>
phonopy -d --dim="2 2 2" --gpaw</code></pre>

ã“ã‚Œã«ã‚ˆã‚Š<code>supercell-XXX.py</code>ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

<strong>Step 3: åŠ›ã®è¨ˆç®—</strong>

<pre><code class="language-python"><h1>supercell-001.pyã‚’å®Ÿè¡Œï¼ˆå„å¤‰ä½æ§‹é€ ã§ï¼‰</h1>
from gpaw import GPAW

calc = GPAW('si_groundstate.gpw', txt=None)
atoms = calc.get_atoms()
forces = atoms.get_forces()

<h1>FORCE_SETSãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿ï¼ˆPhonopyãŒèª­ã¿è¾¼ã‚€å½¢å¼ï¼‰</h1>
import numpy as np
np.savetxt('forces_001.dat', forces)</code></pre>

<strong>å…¨å¤‰ä½æ§‹é€ ã«å¯¾ã—ã¦ç¹°ã‚Šè¿”ã™</strong>ï¼ˆé€šå¸¸ã¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§è‡ªå‹•åŒ–ï¼‰

<strong>Step 4: ãƒ•ã‚©ãƒãƒ³è¨ˆç®—</strong>

<pre><code class="language-python">from phonopy import Phonopy
from phonopy.interface.gpaw import read_gpaw
import matplotlib.pyplot as plt

<h1>Phonopyã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ</h1>
unitcell, calc_forces = read_gpaw('si_groundstate.gpw')
phonon = Phonopy(unitcell, [[2, 0, 0], [0, 2, 0], [0, 0, 2]])

<h1>åŠ›å®šæ•°è¡Œåˆ—ã®è¨­å®šï¼ˆFORCE_SETSã‹ã‚‰ï¼‰</h1>
phonon.set_displacement_dataset(dataset)
phonon.produce_force_constants()

<h1>ãƒãƒ³ãƒ‰æ§‹é€ ã®è¨ˆç®—</h1>
path = [[[0, 0, 0], [0.5, 0, 0.5], [0.625, 0.25, 0.625],
         [0.375, 0.375, 0.75], [0, 0, 0], [0.5, 0.5, 0.5]]]
labels = ["$\\Gamma$", "X", "U", "K", "$\\Gamma$", "L"]
qpoints, connections = phonon.get_band_structure_plot_data(path)

phonon.plot_band_structure(path, labels=labels)
plt.ylabel('Frequency (THz)')
plt.savefig('si_phonon_band.png', dpi=150)
plt.show()

<h1>çŠ¶æ…‹å¯†åº¦ï¼ˆDOSï¼‰</h1>
phonon.set_mesh([20, 20, 20])
phonon.set_total_DOS()
dos_freq, dos_val = phonon.get_total_DOS()

plt.figure(figsize=(8, 6))
plt.plot(dos_freq, dos_val, linewidth=2)
plt.xlabel('Frequency (THz)', fontsize=12)
plt.ylabel('DOS (states/THz)', fontsize=12)
plt.title('Si Phonon DOS', fontsize=14)
plt.grid(alpha=0.3)
plt.savefig('si_phonon_dos.png', dpi=150)
plt.show()</code></pre>

---

<h3>Example 2: å®Œå…¨ãªè‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h3>

<pre><code class="language-python">from ase.build import bulk
from gpaw import GPAW, PW
from phonopy import Phonopy
from phonopy.structure.atoms import PhonopyAtoms
import numpy as np

def calculate_phonon(symbol='Si', a=5.43, dim=(2,2,2)):
    """
    å®Œå…¨è‡ªå‹•ãƒ•ã‚©ãƒãƒ³è¨ˆç®—
    """
    # 1. åŸºåº•çŠ¶æ…‹è¨ˆç®—
    print("Step 1: Ground state calculation...")
    atoms = bulk(symbol, 'diamond', a=a)
    calc = GPAW(mode=PW(400), xc='PBE', kpts=(8,8,8), txt=None)
    atoms.calc = calc
    atoms.get_potential_energy()

    # 2. Phonopyã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
    print("Step 2: Generate displacements...")
    cell = PhonopyAtoms(symbols=[symbol]*len(atoms),
                       cell=atoms.cell,
                       scaled_positions=atoms.get_scaled_positions())

    phonon = Phonopy(cell, np.diag(dim))
    phonon.generate_displacements(distance=0.01)

    # 3. åŠ›ã®è¨ˆç®—
    print(f"Step 3: Calculate forces for {len(phonon.supercells_with_displacements)} supercells...")
    set_of_forces = []

    for i, scell in enumerate(phonon.supercells_with_displacements):
        supercell = bulk(symbol, 'diamond', a=a).repeat(dim)
        supercell.positions = scell.positions
        supercell.calc = calc
        forces = supercell.get_forces()
        drift_force = forces.sum(axis=0)
        for force in forces:
            force -= drift_force / len(forces)  # ãƒ‰ãƒªãƒ•ãƒˆè£œæ­£
        set_of_forces.append(forces)

    # 4. ãƒ•ã‚©ãƒãƒ³è¨ˆç®—
    print("Step 4: Phonon calculation...")
    phonon.produce_force_constants(forces=set_of_forces)

    # ãƒãƒ³ãƒ‰æ§‹é€ 
    path = [[[0, 0, 0], [0.5, 0, 0.5], [0.625, 0.25, 0.625],
             [0.375, 0.375, 0.75], [0, 0, 0], [0.5, 0.5, 0.5]]]
    labels = ["$\\Gamma$", "X", "U", "K", "$\\Gamma$", "L"]

    phonon.auto_band_structure(plot=True, labels=labels, filename=f'{symbol}_band.png')

    # DOS
    phonon.auto_total_dos(plot=True, filename=f'{symbol}_dos.png')

    print("Done!")
    return phonon

<h1>å®Ÿè¡Œ</h1>
si_phonon = calculate_phonon('Si', a=5.43, dim=(2,2,2))</code></pre>

---

<h2>4.4 ç†±åŠ›å­¦ç‰¹æ€§ã®è¨ˆç®—</h2>

<h3>è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼</h3>

<strong>Helmholtzè‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼</strong>ï¼ˆNVTï¼‰:

$$
F(T) = U_0 + k_B T \sum_{\mathbf{q},j} \ln\left[2\sinh\left(\frac{\hbar\omega_{\mathbf{q}j}}{2k_B T}\right)\right]
$$

- $U_0$: ã‚¼ãƒ­ç‚¹ã‚¨ãƒãƒ«ã‚®ãƒ¼
- $\omega_{\mathbf{q}j}$: æ³¢æ•°$\mathbf{q}$ã€ãƒãƒ³ãƒ‰$j$ã®ãƒ•ã‚©ãƒãƒ³å‘¨æ³¢æ•°

<h3>å†…éƒ¨ã‚¨ãƒãƒ«ã‚®ãƒ¼</h3>

$$
U(T) = U_0 + \sum_{\mathbf{q},j} \hbar\omega_{\mathbf{q}j} \left[\frac{1}{2} + n_B(\omega_{\mathbf{q}j}, T)\right]
$$

$n_B(\omega, T)$ã¯Bose-Einsteinåˆ†å¸ƒé–¢æ•°ï¼š

$$
n_B(\omega, T) = \frac{1}{e^{\hbar\omega/(k_B T)} - 1}
$$

<h3>ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</h3>

$$
S(T) = -\left(\frac{\partial F}{\partial T}\right)_V = k_B \sum_{\mathbf{q},j} \left[\frac{\hbar\omega_{\mathbf{q}j}}{k_B T} n_B(\omega_{\mathbf{q}j}, T) - \ln(1 - e^{-\hbar\omega_{\mathbf{q}j}/(k_B T)})\right]
$$

<h3>æ¯”ç†±ï¼ˆå®šç©ï¼‰</h3>

$$
C_V(T) = \left(\frac{\partial U}{\partial T}\right)_V = k_B \sum_{\mathbf{q},j} \left(\frac{\hbar\omega_{\mathbf{q}j}}{k_B T}\right)^2 \frac{e^{\hbar\omega_{\mathbf{q}j}/(k_B T)}}{(e^{\hbar\omega_{\mathbf{q}j}/(k_B T)} - 1)^2}
$$

<h3>Phonopyã§ã®å®Ÿè£…</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

<h1>æ¸©åº¦ç¯„å›²</h1>
temperatures = np.arange(0, 1000, 10)

<h1>ç†±åŠ›å­¦ç‰¹æ€§ã‚’è¨ˆç®—</h1>
si_phonon.set_mesh([20, 20, 20])
si_phonon.set_thermal_properties(t_step=10, t_max=1000, t_min=0)

tp_dict = si_phonon.get_thermal_properties_dict()
temps = tp_dict['temperatures']
free_energy = tp_dict['free_energy']  # kJ/mol
entropy = tp_dict['entropy']  # J/K/mol
heat_capacity = tp_dict['heat_capacity']  # J/K/mol

<h1>ãƒ—ãƒ­ãƒƒãƒˆ</h1>
fig, axes = plt.subplots(2, 2, figsize=(12, 10))

<h1>è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼</h1>
axes[0,0].plot(temps, free_energy, linewidth=2)
axes[0,0].set_xlabel('Temperature (K)', fontsize=12)
axes[0,0].set_ylabel('Free Energy (kJ/mol)', fontsize=12)
axes[0,0].set_title('Helmholtz Free Energy', fontsize=14)
axes[0,0].grid(alpha=0.3)

<h1>ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</h1>
axes[0,1].plot(temps, entropy, linewidth=2, color='orange')
axes[0,1].set_xlabel('Temperature (K)', fontsize=12)
axes[0,1].set_ylabel('Entropy (J/K/mol)', fontsize=12)
axes[0,1].set_title('Entropy', fontsize=14)
axes[0,1].grid(alpha=0.3)

<h1>æ¯”ç†±</h1>
axes[1,0].plot(temps, heat_capacity, linewidth=2, color='green')
axes[1,0].axhline(3*8.314, color='red', linestyle='--', label='Dulong-Petit (3R)')
axes[1,0].set_xlabel('Temperature (K)', fontsize=12)
axes[1,0].set_ylabel('Heat Capacity (J/K/mol)', fontsize=12)
axes[1,0].set_title('Heat Capacity at Constant Volume', fontsize=14)
axes[1,0].legend()
axes[1,0].grid(alpha=0.3)

<h1>å†…éƒ¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆF = U - TSã‹ã‚‰è¨ˆç®—ï¼‰</h1>
internal_energy = free_energy + temps * entropy / 1000  # kJ/mol
axes[1,1].plot(temps, internal_energy, linewidth=2, color='purple')
axes[1,1].set_xlabel('Temperature (K)', fontsize=12)
axes[1,1].set_ylabel('Internal Energy (kJ/mol)', fontsize=12)
axes[1,1].set_title('Internal Energy', fontsize=14)
axes[1,1].grid(alpha=0.3)

plt.tight_layout()
plt.savefig('si_thermodynamics.png', dpi=150)
plt.show()

<h1>ãƒ‡ãƒã‚¤æ¸©åº¦ã®è¨ˆç®—</h1>
<h1>æ¯”ç†±ãŒ3Rï¼ˆDulong-Petitæ¥µé™ï¼‰ã®63%ã«é”ã™ã‚‹æ¸©åº¦</h1>
R = 8.314  # J/K/mol
target_cv = 0.63 * 3 * R
idx = np.argmin(np.abs(heat_capacity - target_cv))
theta_D = temps[idx]
print(f"ãƒ‡ãƒã‚¤æ¸©åº¦: {theta_D:.1f} K")
print(f"å®Ÿé¨“å€¤ï¼ˆSiï¼‰: 645 K")</code></pre>

---

<h2>4.5 ç†±è†¨å¼µä¿‚æ•°</h2>

<h3>æº–èª¿å’Œè¿‘ä¼¼ï¼ˆQuasi-harmonic approximationï¼‰</h3>

ä½“ç©ã‚’å¤‰ãˆã¦ãƒ•ã‚©ãƒãƒ³è¨ˆç®—ã‚’è¤‡æ•°å›å®Ÿè¡Œï¼š

$$
\alpha(T) = \frac{1}{V}\left(\frac{\partial V}{\partial T}\right)_P = -\frac{1}{V}\frac{(\partial^2 F/\partial T \partial V)}{(\partial^2 F/\partial V^2)}
$$

<h3>å®Ÿè£…ä¾‹</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

<h1>ç•°ãªã‚‹æ ¼å­å®šæ•°ã§è¨ˆç®—</h1>
lattice_constants = np.linspace(5.35, 5.51, 5)  # Ã…
phonons = []

for a in lattice_constants:
    print(f"Calculating phonon for a = {a:.3f} Ã…...")
    phonon = calculate_phonon('Si', a=a, dim=(2,2,2))
    phonons.append(phonon)

<h1>å„æ¸©åº¦ã€å„ä½“ç©ã§è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è¨ˆç®—</h1>
temps = np.arange(0, 1000, 50)
volumes = (lattice_constants / 5.43)**3  # è¦æ ¼åŒ–ä½“ç©
free_energies = np.zeros((len(temps), len(volumes)))

for i, phonon in enumerate(phonons):
    phonon.set_mesh([20, 20, 20])
    phonon.set_thermal_properties(t_step=50, t_max=1000, t_min=0)
    tp = phonon.get_thermal_properties_dict()
    free_energies[:, i] = tp['free_energy']

<h1>å„æ¸©åº¦ã§å¹³è¡¡ä½“ç©ã‚’è¦‹ã¤ã‘ã‚‹ï¼ˆFæœ€å°ï¼‰</h1>
V_eq = np.zeros(len(temps))
for i, T in enumerate(temps):
    # 2æ¬¡å¤šé …å¼ãƒ•ã‚£ãƒƒãƒˆ
    coeffs = np.polyfit(volumes, free_energies[i], 2)
    V_eq[i] = -coeffs[1] / (2 * coeffs[0])  # æ¥µå€¤

<h1>ç†±è†¨å¼µä¿‚æ•°</h1>
alpha = np.gradient(V_eq, temps) / V_eq

<h1>ãƒ—ãƒ­ãƒƒãƒˆ</h1>
plt.figure(figsize=(8, 6))
plt.plot(temps, alpha * 1e6, linewidth=2)
plt.xlabel('Temperature (K)', fontsize=12)
plt.ylabel('Thermal expansion coefficient (10$^{-6}$ K$^{-1}$)', fontsize=12)
plt.title('Si Thermal Expansion (QHA)', fontsize=14)
plt.grid(alpha=0.3)
plt.savefig('si_thermal_expansion.png', dpi=150)
plt.show()

print(f"å®¤æ¸©ï¼ˆ300Kï¼‰ã§ã®ç†±è†¨å¼µä¿‚æ•°: {alpha[6]*1e6:.2f} Ã— 10â»â¶ Kâ»Â¹")
print(f"å®Ÿé¨“å€¤: 2.6 Ã— 10â»â¶ Kâ»Â¹")</code></pre>

---

<h2>4.6 ãƒ•ã‚©ãƒãƒ³è¨ˆç®—ã®å¿œç”¨</h2>

<h3>1. æ ¼å­ç†±ä¼å°ç‡</h3>

<strong>Boltzmannè¼¸é€æ–¹ç¨‹å¼</strong>ã‹ã‚‰ã®æ¨å®šï¼ˆç°¡æ˜“ç‰ˆï¼‰:

$$
\kappa = \frac{1}{3} \sum_{\mathbf{q},j} C_{\mathbf{q}j} v_{\mathbf{q}j}^2 \tau_{\mathbf{q}j}
$$

- $C_{\mathbf{q}j}$: ãƒ¢ãƒ¼ãƒ‰ã”ã¨ã®æ¯”ç†±
- $v_{\mathbf{q}j}$: ç¾¤é€Ÿåº¦ï¼ˆ$\partial\omega/\partial\mathbf{q}$ï¼‰
- $\tau_{\mathbf{q}j}$: ç·©å’Œæ™‚é–“ï¼ˆãƒ•ã‚©ãƒãƒ³æ•£ä¹±ï¼‰

<strong>PhonoPyã§ã®ç¾¤é€Ÿåº¦è¨ˆç®—</strong>:

<pre><code class="language-python"><h1>ç¾¤é€Ÿåº¦ã®è¨ˆç®—</h1>
si_phonon.set_group_velocity()
group_velocities = si_phonon.get_group_velocity()

print("Group velocities at Gamma point:")
print(group_velocities[0])  # [band, cartesian_direction]</code></pre>

<h3>2. è¶…ä¼å°ã®è‡¨ç•Œæ¸©åº¦ï¼ˆTcï¼‰</h3>

<strong>McMillanå¼</strong>ï¼ˆç°¡æ˜“ç‰ˆï¼‰:

$$
T_c = \frac{\omega_{\text{log}}}{1.2} \exp\left[-\frac{1.04(1+\lambda)}{\lambda - \mu^*(1+0.62\lambda)}\right]
$$

- $\omega_{\text{log}}$: å¯¾æ•°å¹³å‡ãƒ•ã‚©ãƒãƒ³å‘¨æ³¢æ•°
- $\lambda$: é›»å­-ãƒ•ã‚©ãƒãƒ³çµåˆå®šæ•°
- $\mu^*$: ã‚¯ãƒ¼ãƒ­ãƒ³æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«

<h3>3. ç›¸è»¢ç§»ã®æ¤œå‡º</h3>

<strong>è™šæ•°ãƒ•ã‚©ãƒãƒ³ãƒ¢ãƒ¼ãƒ‰</strong>ãŒå­˜åœ¨ã™ã‚‹ã¨ã€çµæ™¶æ§‹é€ ãŒä¸å®‰å®šï¼š

<pre><code class="language-python"><h1>è² ã®æŒ¯å‹•æ•°ï¼ˆè™šæ•°ãƒ¢ãƒ¼ãƒ‰ï¼‰ã®ãƒã‚§ãƒƒã‚¯</h1>
frequencies = si_phonon.get_frequencies(q=[0, 0, 0])
if np.any(frequencies < -1e-3):
    print("Warning: Imaginary phonon modes detected!")
    print("Structure may be unstable.")</code></pre>

---

<h2>4.7 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

1. <strong>æ ¼å­æŒ¯å‹•ã®ç†è«–</strong>
   - èª¿å’Œè¿‘ä¼¼
   - å‹•åŠ›å­¦è¡Œåˆ—
   - ãƒ•ã‚©ãƒãƒ³åˆ†æ•£é–¢ä¿‚

2. <strong>ãƒ•ã‚©ãƒãƒ³ã®åˆ†é¡</strong>
   - éŸ³éŸ¿ãƒ¢ãƒ¼ãƒ‰ vs å…‰å­¦ãƒ¢ãƒ¼ãƒ‰
   - ç¸¦æ³¢ vs æ¨ªæ³¢

3. <strong>Phonopyã«ã‚ˆã‚‹å®Ÿè·µ</strong>
   - ãƒ•ã‚©ãƒãƒ³ãƒãƒ³ãƒ‰æ§‹é€ 
   - ãƒ•ã‚©ãƒãƒ³çŠ¶æ…‹å¯†åº¦
   - å®Œå…¨è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

4. <strong>ç†±åŠ›å­¦ç‰¹æ€§</strong>
   - è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼
   - å†…éƒ¨ã‚¨ãƒãƒ«ã‚®ãƒ¼
   - ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼
   - æ¯”ç†±
   - ãƒ‡ãƒã‚¤æ¸©åº¦

5. <strong>å¿œç”¨</strong>
   - ç†±è†¨å¼µä¿‚æ•°ï¼ˆæº–èª¿å’Œè¿‘ä¼¼ï¼‰
   - ç†±ä¼å°ç‡
   - ç›¸è»¢ç§»ã®æ¤œå‡º

<h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

- ãƒ•ã‚©ãƒãƒ³ã¯é‡å­åŒ–ã•ã‚ŒãŸæ ¼å­æŒ¯å‹•
- èª¿å’Œè¿‘ä¼¼ã§ååˆ†ãªç²¾åº¦ï¼ˆå¤šãã®å ´åˆï¼‰
- ç†±åŠ›å­¦ç‰¹æ€§ã¯ãƒ•ã‚©ãƒãƒ³ã‹ã‚‰è¨ˆç®—å¯èƒ½
- å®Ÿé¨“ã¨ã®è‰¯ã„ä¸€è‡´ï¼ˆSi: ãƒ‡ãƒã‚¤æ¸©åº¦ã€ç†±è†¨å¼µä¿‚æ•°ï¼‰

<h3>æ¬¡ã®ç« ã¸</h3>

ç¬¬5ç« ã§ã¯ã€DFTè¨ˆç®—ã¨æ©Ÿæ¢°å­¦ç¿’ã‚’çµ±åˆã—ãŸæœ€æ–°æ‰‹æ³•ã‚’å­¦ã³ã¾ã™ã€‚

---

<h2>æ¼”ç¿’å•é¡Œ</h2>

<h3>å•é¡Œ1ï¼ˆé›£æ˜“åº¦ï¼šeasyï¼‰</h3>

éŸ³éŸ¿ãƒ¢ãƒ¼ãƒ‰ã¨å…‰å­¦ãƒ¢ãƒ¼ãƒ‰ã®é•ã„ã‚’ã€ç‰©ç†çš„æ„å‘³ã¨ã¨ã‚‚ã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

<details>
<summary>è§£ç­”ä¾‹</summary>

<strong>éŸ³éŸ¿ãƒ¢ãƒ¼ãƒ‰ï¼ˆAcoustic modesï¼‰</strong>:

<strong>æ•°</strong>: 3æœ¬ï¼ˆ1 LA + 2 TAï¼‰
<strong>ç‰¹å¾´</strong>: Î“ç‚¹ï¼ˆ$\mathbf{k}=0$ï¼‰ã§å‘¨æ³¢æ•°ãŒã‚¼ãƒ­ï¼ˆ$\omega \to 0$ as $\mathbf{k} \to 0$ï¼‰
<strong>ç‰©ç†çš„æ„å‘³</strong>: çµæ™¶å…¨ä½“ã®ä¸¦é€²é‹å‹•ã€éŸ³æ³¢ã«å¯¾å¿œ
- ã™ã¹ã¦ã®åŸå­ãŒåŒã˜æ–¹å‘ãƒ»ä½ç›¸ã§æŒ¯å‹•
- é•·æ³¢é•·æ¥µé™ã§å¼¾æ€§æ³¢ï¼ˆéŸ³æ³¢ï¼‰ã«ãªã‚‹

<strong>å…‰å­¦ãƒ¢ãƒ¼ãƒ‰ï¼ˆOptical modesï¼‰</strong>:

<strong>æ•°</strong>: $3(N_{\text{atom}} - 1)$æœ¬ï¼ˆå˜ä½èƒå†…åŸå­æ•°$N_{\text{atom}}$ï¼‰
<strong>ç‰¹å¾´</strong>: Î“ç‚¹ã§æœ‰é™ã®å‘¨æ³¢æ•°ï¼ˆ$\omega(\mathbf{k}=0) \neq 0$ï¼‰
<strong>ç‰©ç†çš„æ„å‘³</strong>: å˜ä½èƒå†…ã®åŸå­ã®ç›¸å¯¾é‹å‹•ã€å…‰ï¼ˆèµ¤å¤–ç·šï¼‰ã¨çµåˆ
- ç•°ãªã‚‹åŸå­ãŒé€†ä½ç›¸ã§æŒ¯å‹•
- ã‚¤ã‚ªãƒ³çµæ™¶ã§ã¯é›»æ°—åŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆãŒç”Ÿã˜ã‚‹ â†’ èµ¤å¤–å¸å

<strong>ä¾‹ï¼ˆNaClçµæ™¶ï¼‰</strong>:
- éŸ³éŸ¿ãƒ¢ãƒ¼ãƒ‰: Naã¨ClãŒåŒã˜æ–¹å‘ã«å‹•ã
- å…‰å­¦ãƒ¢ãƒ¼ãƒ‰: Naã¨ClãŒé€†æ–¹å‘ã«å‹•ã â†’ åŒæ¥µå­ â†’ å…‰å¸å

</details>

<h3>å•é¡Œ2ï¼ˆé›£æ˜“åº¦ï¼šmediumï¼‰</h3>

ãƒ‡ãƒã‚¤æ¸©åº¦$\theta_D$ã®ç‰©ç†çš„æ„å‘³ã¨ã€æ¯”ç†±ã¨ã®é–¢ä¿‚ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

<details>
<summary>è§£ç­”ä¾‹</summary>

<strong>ãƒ‡ãƒã‚¤æ¸©åº¦$\theta_D$ã®å®šç¾©</strong>:

ãƒ‡ãƒã‚¤ãƒ¢ãƒ‡ãƒ«ã§ã¯ã€ã™ã¹ã¦ã®ãƒ•ã‚©ãƒãƒ³ãƒ¢ãƒ¼ãƒ‰ã‚’å˜ä¸€ã®ãƒ‡ãƒã‚¤å‘¨æ³¢æ•°$\omega_D$ã§è¿‘ä¼¼ã—ã¾ã™ï¼š

$$
\theta_D = \frac{\hbar\omega_D}{k_B}
$$

<strong>ç‰©ç†çš„æ„å‘³</strong>:

1. <strong>é‡å­åŠ¹æœã®å¢ƒç•Œæ¸©åº¦</strong>:
   - $T \ll \theta_D$: é‡å­åŠ¹æœãŒæ”¯é…çš„ï¼ˆä½æ¸©ï¼‰
   - $T \gg \theta_D$: å¤å…¸çš„æŒ¯ã‚‹èˆã„ï¼ˆé«˜æ¸©ï¼‰

2. <strong>ãƒ•ã‚©ãƒãƒ³åŠ±èµ·ã®ç›®å®‰</strong>:
   - $\theta_D$ã¯æœ€é«˜ãƒ•ã‚©ãƒãƒ³å‘¨æ³¢æ•°ã«å¯¾å¿œ
   - $T < \theta_D$: é«˜ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ•ã‚©ãƒãƒ³ã¯åŠ±èµ·ã•ã‚Œãªã„
   - $T > \theta_D$: ã™ã¹ã¦ã®ãƒ•ã‚©ãƒãƒ³ãƒ¢ãƒ¼ãƒ‰ãŒåŠ±èµ·

<strong>æ¯”ç†±ã¨ã®é–¢ä¿‚</strong>:

<strong>ä½æ¸©ï¼ˆ$T \ll \theta_D$ï¼‰</strong>: Debye $T^3$å‰‡

$$
C_V \propto T^3
$$

ãƒ•ã‚©ãƒãƒ³ã®é‡å­åŠ¹æœãŒé¡•è‘—ã€‚

<strong>é«˜æ¸©ï¼ˆ$T \gg \theta_D$ï¼‰</strong>: Dulong-Petitå‰‡

$$
C_V \to 3Nk_B = 3R
$$

ã™ã¹ã¦ã®è‡ªç”±åº¦ãŒåŠ±èµ·ã•ã‚Œã€å¤å…¸çš„æ¥µé™ã€‚

<strong>å…¸å‹çš„ãªå€¤</strong>:
- Si: $\theta_D \approx 645$ K
- Diamond: $\theta_D \approx 2230$ Kï¼ˆç¡¬ã„æ ¼å­ â†’ é«˜å‘¨æ³¢ï¼‰
- Pb: $\theta_D \approx 105$ Kï¼ˆæŸ”ã‚‰ã‹ã„æ ¼å­ â†’ ä½å‘¨æ³¢ï¼‰

<strong>å®Ÿç”¨çš„æ„å‘³</strong>:
- $\theta_D$ãŒé«˜ã„ â†’ å®¤æ¸©ã§ã‚‚é‡å­åŠ¹æœãŒé‡è¦
- $\theta_D$ãŒä½ã„ â†’ å®¤æ¸©ã§å¤å…¸çš„

</details>

<h3>å•é¡Œ3ï¼ˆé›£æ˜“åº¦ï¼šhardï¼‰</h3>

æº–èª¿å’Œè¿‘ä¼¼ï¼ˆQHAï¼‰ã§ç†±è†¨å¼µä¿‚æ•°ã‚’è¨ˆç®—ã™ã‚‹éš›ã€ãªãœè¤‡æ•°ã®ä½“ç©ã§ãƒ•ã‚©ãƒãƒ³è¨ˆç®—ãŒå¿…è¦ãªã®ã‹èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

<details>
<summary>è§£ç­”ä¾‹</summary>

<strong>èª¿å’Œè¿‘ä¼¼ã®é™ç•Œ</strong>:

èª¿å’Œè¿‘ä¼¼ã§ã¯ã€è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼$F(V, T)$ã®ä½“ç©ä¾å­˜æ€§ãŒä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

$$
F_{\text{harm}}(V, T) = U_0(V) + k_B T \sum_{\mathbf{q},j} \ln\left[2\sinh\left(\frac{\hbar\omega_{\mathbf{q}j}(V)}{2k_B T}\right)\right]
$$

ã“ã“ã§$\omega_{\mathbf{q}j}(V)$ã¯ä½“ç©$V$ã«ä¾å­˜ã—ã¾ã™ã€‚

ã—ã‹ã—ã€èª¿å’Œè¿‘ä¼¼ã§ã¯<strong>æ ¼å­å®šæ•°ãŒä¸€å®š</strong>ã¨ä»®å®šã—ã¦ã„ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®å•é¡ŒãŒã‚ã‚Šã¾ã™ï¼š

1. <strong>ç†±è†¨å¼µãŒè¨˜è¿°ã§ããªã„</strong>: $(âˆ‚V/âˆ‚T)_P = 0$
2. <strong>ç†±å®¹é‡ãŒå®šç©ã®ã¿</strong>: $C_P = C_V$ï¼ˆå®Ÿéš›ã¯$C_P > C_V$ï¼‰

<strong>æº–èª¿å’Œè¿‘ä¼¼ï¼ˆQHAï¼‰ã®å°å…¥</strong>:

QHAã§ã¯ã€<strong>ç•°ãªã‚‹ä½“ç©ã§ç‹¬ç«‹ã«èª¿å’Œè¿‘ä¼¼ã‚’é©ç”¨</strong>ã—ã¾ã™ï¼š

<strong>æ‰‹é †</strong>:

1. è¤‡æ•°ã®ä½“ç©$V_1, V_2, \ldots, V_n$ã§ãƒ•ã‚©ãƒãƒ³è¨ˆç®—
2. å„ä½“ç©ã§è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼$F(V_i, T)$ã‚’è¨ˆç®—
3. å„æ¸©åº¦$T$ã§è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æœ€å°åŒ–ã™ã‚‹ä½“ç©$V_{\text{eq}}(T)$ã‚’è¦‹ã¤ã‘ã‚‹ï¼š
   $$\left(\frac{\partial F}{\partial V}\right)_T = 0$$
4. ç†±è†¨å¼µä¿‚æ•°ã‚’è¨ˆç®—ï¼š
   $$\alpha(T) = \frac{1}{V}\left(\frac{\partial V}{\partial T}\right)_P$$

<strong>ãªãœè¤‡æ•°ã®ä½“ç©ãŒå¿…è¦ã‹</strong>:

- ä½“ç©ä¾å­˜æ€§$F(V, T)$ã‚’çŸ¥ã‚‹ãŸã‚
- è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®æ›²ç‡$(\partial^2 F/\partial V^2)$ãŒå¿…è¦
- æœ€å°å€¤ã®ä½ç½®$V_{\text{eq}}(T)$ãŒæ¸©åº¦ä¾å­˜

<strong>QHAã®ä»®å®š</strong>:

- ãƒ•ã‚©ãƒãƒ³å‘¨æ³¢æ•°ã®ä½“ç©ä¾å­˜æ€§ã‚’è€ƒæ…®
- ã—ã‹ã—ã€ãƒ•ã‚©ãƒãƒ³é–“ã®éèª¿å’Œç›¸äº’ä½œç”¨ã¯ç„¡è¦–
- å„ä½“ç©ã§ç‹¬ç«‹ã«èª¿å’Œè¿‘ä¼¼

<strong>QHAã®é™ç•Œ</strong>:

- é«˜æ¸©ï¼ˆèç‚¹è¿‘ãï¼‰ã§ã¯ä¸æ­£ç¢º
- å¼·ã„éèª¿å’Œæ€§ï¼ˆä¾‹: è² ã®ç†±è†¨å¼µææ–™ï¼‰ã¯è¨˜è¿°å›°é›£
- å®Œå…¨ãªéèª¿å’Œè¨ˆç®—ï¼ˆTDEP, SSCHAãªã©ï¼‰ãŒå¿…è¦

<strong>è¨ˆç®—ã‚³ã‚¹ãƒˆ</strong>:

- 5-10å€‹ã®ä½“ç©ã§ãƒ•ã‚©ãƒãƒ³è¨ˆç®— â†’ 5-10å€ã®ã‚³ã‚¹ãƒˆ
- ã—ã‹ã—ã€ç†±è†¨å¼µä¿‚æ•°ãŒå¾—ã‚‰ã‚Œã‚‹åˆ©ç‚¹

</details>

---

<h2>å‚è€ƒæ–‡çŒ®</h2>

1. Dove, M. T. (1993). *Introduction to Lattice Dynamics*. Cambridge University Press.

2. Togo, A., & Tanaka, I. (2015). "First principles phonon calculations in materials science." *Scripta Materialia*, 108, 1-5.
   DOI: [10.1016/j.scriptamat.2015.07.021](https://doi.org/10.1016/j.scriptamat.2015.07.021)

3. Phonopy Documentation: https://phonopy.github.io/phonopy/

4. Shulumba, N., et al. (2017). "Temperature-dependent elastic properties of Ti$_x$Zr$_{1-x}$N alloys." *Applied Physics Letters*, 111, 061901.

---

<h2>è‘—è€…æƒ…å ±</h2>

<strong>ä½œæˆè€…</strong>: MI Knowledge Hub Content Team
<strong>ç›£ä¿®</strong>: Dr. Yusuke Hashimotoï¼ˆæ±åŒ—å¤§å­¦ï¼‰
<strong>ä½œæˆæ—¥</strong>: 2025-10-17
<strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0
<strong>ã‚·ãƒªãƒ¼ã‚º</strong>: è¨ˆç®—ææ–™ç§‘å­¦åŸºç¤å…¥é–€ v1.0

<strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY-NC-SA 4.0
<div class="navigation">
    <a href="chapter-3.html" class="nav-button">â† ç¬¬3ç« </a>
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="chapter-5.html" class="nav-button">ç¬¬5ç«  â†’</a>
</div>
    </main>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ç›£ä¿®</strong>: Dr. Yusuke Hashimotoï¼ˆæ±åŒ—å¤§å­¦ï¼‰</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-17</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mermaidCodeBlocks = document.querySelectorAll('pre.codehilite code.language-mermaid, pre code.language-mermaid');

            mermaidCodeBlocks.forEach(function(codeBlock) {
                const pre = codeBlock.parentElement;
                const mermaidCode = codeBlock.textContent;

                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode.trim();

                pre.parentNode.replaceChild(mermaidDiv, pre);
            });

            if (typeof mermaid !== 'undefined') {
                mermaid.initialize({
                    startOnLoad: true,
                    theme: 'default'
                });
                mermaid.init(undefined, document.querySelectorAll('.mermaid'));
            }
        });
    </script>
</body>
</html>
