<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« ï¼šå¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰å…¥é–€ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬2ç« ï¼šå¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰å…¥é–€</h1>
            <p class="subtitle">å¤šé›»å­ç³»ã®ç¬¬ä¸€åŸç†è¨ˆç®—ã®å®Ÿè·µ</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 20-25åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´šã€œä¸Šç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 8å€‹</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 0å•</span>
            </div>
        </div>
    </header>

    <main class="container">

<h1>ç¬¬2ç« ï¼šå¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰å…¥é–€</h1>

<h2>å­¦ç¿’ç›®æ¨™</h2>

ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š
- DFTã®åŸºæœ¬åŸç†ï¼ˆHohenberg-Kohnå®šç†ã€Kohn-Shamæ–¹ç¨‹å¼ï¼‰ã‚’ç†è§£ã™ã‚‹
- äº¤æ›ç›¸é–¢æ±é–¢æ•°ï¼ˆLDAã€GGAï¼‰ã®é•ã„ã‚’èª¬æ˜ã§ãã‚‹
- ASEã¨GPAWã‚’ä½¿ã£ã¦DFTè¨ˆç®—ã‚’å®Ÿè¡Œã§ãã‚‹
- ãƒãƒ³ãƒ‰æ§‹é€ ã€çŠ¶æ…‹å¯†åº¦ã€æ§‹é€ æœ€é©åŒ–ã‚’è¨ˆç®—ã§ãã‚‹
- DFTã®é™ç•Œï¼ˆãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—å•é¡Œã€van der Waalsç›¸äº’ä½œç”¨ï¼‰ã‚’ç†è§£ã™ã‚‹

---

<h2>2.1 å¤šé›»å­ç³»ã®å›°é›£ã•ã¨DFTã®ç™»å ´</h2>

<h3>å¤šé›»å­ã‚·ãƒ¥ãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼æ–¹ç¨‹å¼</h3>

å¤šé›»å­ç³»ï¼ˆ$N$å€‹ã®é›»å­ï¼‰ã®ã‚·ãƒ¥ãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼æ–¹ç¨‹å¼ï¼š

$$
\hat{H}\Psi(\mathbf{r}_1, \mathbf{r}_2, \ldots, \mathbf{r}_N) = E\Psi(\mathbf{r}_1, \mathbf{r}_2, \ldots, \mathbf{r}_N)
$$

æ³¢å‹•é–¢æ•°$\Psi$ã¯$3N$æ¬¡å…ƒç©ºé–“ã®é–¢æ•°ã§ã™ã€‚ã“ã‚ŒãŒæ±ºå®šçš„ã«å›°é›£ãªç†ç”±ã§ã™ã€‚

<strong>è¨ˆç®—é‡ã®çˆ†ç™º</strong>:
- 2é›»å­ç³»: 6æ¬¡å…ƒ
- 10é›»å­ç³»: 30æ¬¡å…ƒ
- 100é›»å­ç³»ï¼ˆå°ã•ãªåˆ†å­ï¼‰: 300æ¬¡å…ƒ

å„æ¬¡å…ƒã‚’100ç‚¹ã§ã‚µãƒ³ãƒ—ãƒ«ã™ã‚‹ã¨ã€$100^{300} \approx 10^{600}$ç‚¹ãŒå¿…è¦ â†’ <strong>å®Ÿè³ªçš„ã«ä¸å¯èƒ½</strong>

<h3>DFTã®ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã‚·ãƒ•ãƒˆ</h3>

<strong>Walter Kohnï¼ˆ1998å¹´ãƒãƒ¼ãƒ™ãƒ«åŒ–å­¦è³ï¼‰ã®ã‚¢ã‚¤ãƒ‡ã‚¢</strong>:

> æ³¢å‹•é–¢æ•°$\Psi(\mathbf{r}_1, \ldots, \mathbf{r}_N)$ï¼ˆ$3N$æ¬¡å…ƒï¼‰ã®ä»£ã‚ã‚Šã«ã€<strong>é›»å­å¯†åº¦</strong>$n(\mathbf{r})$ï¼ˆ3æ¬¡å…ƒï¼‰ã‚’åŸºæœ¬å¤‰æ•°ã«ã§ããªã„ã‹ï¼Ÿ

$$
n(\mathbf{r}) = N \int |\Psi(\mathbf{r}, \mathbf{r}_2, \ldots, \mathbf{r}_N)|^2 d\mathbf{r}_2 \cdots d\mathbf{r}_N
$$

ã‚‚ã—ã“ã‚ŒãŒå¯èƒ½ãªã‚‰ï¼š
- $3N$æ¬¡å…ƒ â†’ 3æ¬¡å…ƒã¸ã®æ¬¡å…ƒå‰Šæ¸›
- è¨ˆç®—é‡ãŒåŠ‡çš„ã«å‰Šæ¸›

---

<h2>2.2 Hohenberg-Kohnå®šç†ï¼ˆ1964å¹´ï¼‰</h2>

DFTã®ç†è«–çš„åŸºç¤ã‚’ä¸ãˆã‚‹2ã¤ã®å®šç†ã§ã™ã€‚

<h3>ç¬¬1å®šç†ï¼šä¸€å¯¾ä¸€å¯¾å¿œ</h3>

<strong>å®šç†</strong>: å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«$V_{\text{ext}}(\mathbf{r})$ã¯é›»å­å¯†åº¦$n(\mathbf{r})$ã«ã‚ˆã‚Šä¸€æ„ã«æ±ºå®šã•ã‚Œã‚‹ï¼ˆå®šæ•°ã‚’é™¤ã„ã¦ï¼‰ã€‚

<strong>ç‰©ç†çš„æ„å‘³</strong>:
- é›»å­å¯†åº¦$n(\mathbf{r})$ãŒåˆ†ã‹ã‚Œã°ã€ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³$\hat{H}$ãŒæ±ºã¾ã‚‹
- ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ãŒæ±ºã¾ã‚Œã°ã€ã™ã¹ã¦ã®ç‰©ç†é‡ãŒæ±ºã¾ã‚‹
- ã¤ã¾ã‚Šã€$n(\mathbf{r})$ã ã‘ã§ã™ã¹ã¦ã®æƒ…å ±ãŒå«ã¾ã‚Œã‚‹

<h3>ç¬¬2å®šç†ï¼šå¤‰åˆ†åŸç†</h3>

<strong>å®šç†</strong>: åŸºåº•çŠ¶æ…‹ã‚¨ãƒãƒ«ã‚®ãƒ¼$E_0$ã¯çœŸã®é›»å­å¯†åº¦$n_0(\mathbf{r})$ã§æœ€å°å€¤ã‚’å–ã‚‹ã€‚

$$
E[n] \geq E[n_0] = E_0
$$

ä»»æ„ã®è©¦è¡Œå¯†åº¦$n(\mathbf{r})$ã«å¯¾ã—ã¦ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼æ±é–¢æ•°$E[n]$ã‚’æœ€å°åŒ–ã™ã‚Œã°åŸºåº•çŠ¶æ…‹ãŒå¾—ã‚‰ã‚Œã‚‹ã€‚

<h3>ã‚¨ãƒãƒ«ã‚®ãƒ¼æ±é–¢æ•°</h3>

$$
E[n] = T[n] + V_{\text{ext}}[n] + V_{\text{ee}}[n]
$$

- $T[n]$: é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼æ±é–¢æ•°
- $V_{\text{ext}}[n] = \int V_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) d\mathbf{r}$: å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«
- $V_{\text{ee}}[n]$: é›»å­é–“ç›¸äº’ä½œç”¨æ±é–¢æ•°

<strong>å•é¡Œ</strong>: $T[n]$ã¨$V_{\text{ee}}[n]$ã®æ­£ç¢ºãªå½¢ãŒåˆ†ã‹ã‚‰ãªã„ï¼

---

<h2>2.3 Kohn-Shamæ–¹ç¨‹å¼ï¼ˆ1965å¹´ï¼‰</h2>

<h3>Kohn-Shamã®å¤©æ‰çš„ã‚¢ã‚¤ãƒ‡ã‚¢</h3>

<strong>ä»®æƒ³çš„ãªéç›¸äº’ä½œç”¨ç³»</strong>ã‚’å°å…¥ï¼š
- å®Ÿéš›ã®ç›¸äº’ä½œç”¨ã™ã‚‹é›»å­ç³»ã¨<strong>åŒã˜é›»å­å¯†åº¦</strong>ã‚’æŒã¤
- ã—ã‹ã—é›»å­é–“ç›¸äº’ä½œç”¨ã¯<strong>ã‚¼ãƒ­</strong>ï¼ˆç‹¬ç«‹ç²’å­ç³»ï¼‰

ã“ã®éç›¸äº’ä½œç”¨ç³»ã®ã‚·ãƒ¥ãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼æ–¹ç¨‹å¼ï¼š

$$
\left[-\frac{\hbar^2}{2m_e}\nabla^2 + V_{\text{KS}}(\mathbf{r})\right] \psi_i(\mathbf{r}) = \epsilon_i \psi_i(\mathbf{r})
$$

- $\psi_i(\mathbf{r})$: Kohn-Shamè»Œé“ï¼ˆ$i = 1, 2, \ldots, N$ï¼‰
- $\epsilon_i$: Kohn-Shamã‚¨ãƒãƒ«ã‚®ãƒ¼å›ºæœ‰å€¤
- $V_{\text{KS}}(\mathbf{r})$: <strong>Kohn-Shamãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«</strong>ï¼ˆeffective potentialï¼‰

<h3>é›»å­å¯†åº¦</h3>

$$
n(\mathbf{r}) = \sum_{i=1}^N f_i |\psi_i(\mathbf{r})|^2
$$

$f_i$ã¯å æœ‰æ•°ï¼ˆåŸºåº•çŠ¶æ…‹ã§ã¯$f_i = 1$ã€ã‚¹ãƒ”ãƒ³ã‚’è€ƒæ…®ã™ã‚‹ã¨$f_i \leq 2$ï¼‰

<h3>Kohn-Shamãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«</h3>

$$
V_{\text{KS}}(\mathbf{r}) = V_{\text{ext}}(\mathbf{r}) + V_{\text{Hartree}}(\mathbf{r}) + V_{\text{xc}}(\mathbf{r})
$$

<strong>Hartreeãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«</strong>ï¼ˆå¤å…¸çš„ã‚¯ãƒ¼ãƒ­ãƒ³ç›¸äº’ä½œç”¨ï¼‰:

$$
V_{\text{Hartree}}(\mathbf{r}) = e^2 \int \frac{n(\mathbf{r}')}{|\mathbf{r} - \mathbf{r}'|} d\mathbf{r}'
$$

<strong>äº¤æ›ç›¸é–¢ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«</strong>ï¼ˆé‡å­åŠ¹æœã‚’å«ã‚€ï¼‰:

$$
V_{\text{xc}}(\mathbf{r}) = \frac{\delta E_{\text{xc}}[n]}{\delta n(\mathbf{r})}
$$

$E_{\text{xc}}[n]$ã¯äº¤æ›ç›¸é–¢ã‚¨ãƒãƒ«ã‚®ãƒ¼æ±é–¢æ•°ã€‚

<h3>è‡ªå·±ç„¡æ’ç€å ´ï¼ˆSCFï¼‰è¨ˆç®—</h3>

Kohn-Shamæ–¹ç¨‹å¼ã¯è‡ªå·±ç„¡æ’ç€ã«è§£ãå¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

<div class="mermaid">graph TD
    A[åˆæœŸå¯†åº¦ nâ°r ã‚’ä»®å®š] --> B[V_KSr ã‚’è¨ˆç®—]
    B --> C[Kohn-Shamæ–¹ç¨‹å¼ã‚’è§£ã: Ïˆáµ¢r, Îµáµ¢]
    C --> D[æ–°ã—ã„å¯†åº¦ nÂ¹r = Î£fáµ¢|Ïˆáµ¢r|Â²]
    D --> E{åæŸåˆ¤å®š: |nÂ¹-nâ°| < tol?}
    E -->|No| F[å¯†åº¦ã‚’æ··åˆ: nâ° = Î±nÂ¹ + 1-Î±nâ°]
    F --> B
    E -->|Yes| G[åŸºåº•çŠ¶æ…‹ã‚¨ãƒãƒ«ã‚®ãƒ¼Eâ‚€, é›»å­æ§‹é€ ã‚’å¾—ã‚‹]

    style A fill:#e3f2fd
    style G fill:#c8e6c9</div>

---

<h2>2.4 äº¤æ›ç›¸é–¢æ±é–¢æ•°</h2>

DFTã®ç²¾åº¦ã¯$E_{\text{xc}}[n]$ã®è¿‘ä¼¼ã«ä¾å­˜ã—ã¾ã™ã€‚

<h3>LDAï¼ˆLocal Density Approximationï¼‰</h3>

<strong>ä»®å®š</strong>: å„ç‚¹$\mathbf{r}$ã§ã®äº¤æ›ç›¸é–¢ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã€ãã®ç‚¹ã®é›»å­å¯†åº¦$n(\mathbf{r})$ã®ã¿ã«ä¾å­˜ã™ã‚‹ã€‚

$$
E_{\text{xc}}^{\text{LDA}}[n] = \int n(\mathbf{r}) \epsilon_{\text{xc}}^{\text{unif}}(n(\mathbf{r})) d\mathbf{r}
$$

$\epsilon_{\text{xc}}^{\text{unif}}(n)$ã¯ä¸€æ§˜é›»å­ã‚¬ã‚¹ã®äº¤æ›ç›¸é–¢ã‚¨ãƒãƒ«ã‚®ãƒ¼å¯†åº¦ï¼ˆé‡å­ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­è¨ˆç®—ã§ç²¾å¯†ã«æ±‚ã‚ã‚‰ã‚Œã¦ã„ã‚‹ï¼‰ã€‚

<strong>ç‰¹å¾´</strong>:
- âœ… è¨ˆç®—ãŒé«˜é€Ÿ
- âœ… çµæ™¶æ§‹é€ ã€æ ¼å­å®šæ•°ã«è‰¯ã„ç²¾åº¦
- âŒ ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’éå°è©•ä¾¡ï¼ˆ~30-50%ï¼‰
- âŒ å¼±ã„çµåˆï¼ˆvan der Waalsï¼‰ã‚’è¨˜è¿°ã§ããªã„

<h3>GGAï¼ˆGeneralized Gradient Approximationï¼‰</h3>

å¯†åº¦$n(\mathbf{r})$ã ã‘ã§ãªãã€ãã®å‹¾é…$\nabla n(\mathbf{r})$ã‚‚è€ƒæ…®ï¼š

$$
E_{\text{xc}}^{\text{GGA}}[n] = \int n(\mathbf{r}) \epsilon_{\text{xc}}^{\text{GGA}}(n(\mathbf{r}), |\nabla n(\mathbf{r})|) d\mathbf{r}
$$

<strong>ä»£è¡¨çš„ãªGGAæ±é–¢æ•°</strong>:
- <strong>PBE</strong>ï¼ˆPerdew-Burke-Ernzerhof, 1996ï¼‰: æœ€ã‚‚åºƒãä½¿ã‚ã‚Œã‚‹
- <strong>PW91</strong>ï¼ˆPerdew-Wang 1991ï¼‰: PBEã®å‰èº«
- <strong>BLYP</strong>ï¼ˆBecke-Lee-Yang-Parrï¼‰: é‡å­åŒ–å­¦ã§äººæ°—

<strong>ç‰¹å¾´</strong>:
- âœ… LDAã‚ˆã‚Šæ§‹é€ ã€çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ç²¾åº¦å‘ä¸Š
- âœ… åˆ†å­ã®çµåˆè·é›¢ãƒ»è§’åº¦ãŒæ”¹å–„
- âŒ ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—å•é¡Œã¯LDAã¨åŒç¨‹åº¦
- âŒ van der Waalsç›¸äº’ä½œç”¨ã¯ä¾ç„¶ä¸ååˆ†

<h3>æ¯”è¼ƒè¡¨</h3>

| é …ç›® | LDA | GGAï¼ˆPBEï¼‰ | å®Ÿé¨“å€¤ |
|------|-----|-----------|--------|
| Siæ ¼å­å®šæ•° [Ã…] | 5.40 | 5.47 | 5.43 |
| Siãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— [eV] | 0.5 | 0.6 | 1.17 |
| Hâ‚‚çµåˆé•· [Ã…] | 0.76 | 0.75 | 0.74 |
| Hâ‚‚çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV] | -4.8 | -4.6 | -4.75 |

---

<h2>2.5 ASE + GPAWã«ã‚ˆã‚‹DFTè¨ˆç®—ã®å®Ÿè·µ</h2>

<h3>ç’°å¢ƒæ§‹ç¯‰</h3>

<pre><code class="language-bash"><h1>Anacondaç’°å¢ƒã§ã®æ¨å¥¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h1>
conda create -n dft python=3.11
conda activate dft
conda install -c conda-forge ase gpaw
pip install matplotlib numpy scipy</code></pre>

<h3>Example 1: æ°´ç´ åˆ†å­ï¼ˆHâ‚‚ï¼‰ã®æ§‹é€ æœ€é©åŒ–</h3>

<pre><code class="language-python">from ase import Atoms
from ase.optimize import BFGS
from gpaw import GPAW, PW

<h1>æ°´ç´ åˆ†å­ã®åˆæœŸæ§‹é€ </h1>
atoms = Atoms('H2',
              positions=[[0, 0, 0], [0, 0, 0.8]],  # åˆæœŸçµåˆé•·0.8Ã…
              cell=[6, 6, 6],  # ã‚»ãƒ«ã‚µã‚¤ã‚º
              pbc=False)  # å‘¨æœŸå¢ƒç•Œæ¡ä»¶ãªã—

<h1>è¨ˆç®—æ©Ÿã‚’è¨­å®š</h1>
calc = GPAW(mode=PW(400),  # å¹³é¢æ³¢åŸºåº•ã€ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼400eV
            xc='PBE',  # GGAæ±é–¢æ•°ï¼ˆPBEï¼‰
            txt='h2_opt.txt')  # ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«

atoms.calc = calc

<h1>æ§‹é€ æœ€é©åŒ–</h1>
opt = BFGS(atoms, trajectory='h2_opt.traj')
opt.run(fmax=0.01)  # åŠ›ãŒ0.01 eV/Ã…ä»¥ä¸‹ã¾ã§æœ€é©åŒ–

<h1>çµæœã®è¡¨ç¤º</h1>
print(f"æœ€é©åŒ–å¾Œã®çµåˆé•·: {atoms.get_distance(0, 1):.3f} Ã…")
print(f"ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼: {atoms.get_potential_energy():.3f} eV")</code></pre>

<strong>å®Ÿè¡Œçµæœ</strong>:
<pre><code>æœ€é©åŒ–å¾Œã®çµåˆé•·: 0.748 Ã…
ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼: -6.873 eV</code></pre>

<strong>å®Ÿé¨“å€¤ã¨ã®æ¯”è¼ƒ</strong>: 0.741 Ã…ï¼ˆå®Ÿé¨“å€¤ï¼‰â†’ èª¤å·®ç´„1%

---

<h3>Example 2: Siã®ãƒãƒ³ãƒ‰æ§‹é€ è¨ˆç®—</h3>

<pre><code class="language-python">from ase.build import bulk
from gpaw import GPAW, PW
from gpaw.utilities.kpoints import get_bandpath
import matplotlib.pyplot as plt

<h1>Siçµæ™¶ã®ä½œæˆ</h1>
si = bulk('Si', 'diamond', a=5.43)

<h1>SCFè¨ˆç®—ï¼ˆå¯†ãª kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ï¼‰</h1>
calc = GPAW(mode=PW(400),
            xc='PBE',
            kpts=(8, 8, 8),  # Monkhorst-Pack ãƒ¡ãƒƒã‚·ãƒ¥
            txt='si_scf.txt')

si.calc = calc
si.get_potential_energy()  # SCFè¨ˆç®—ã‚’å®Ÿè¡Œ
calc.write('si_groundstate.gpw')  # æ³¢å‹•é–¢æ•°ã‚’ä¿å­˜

<h1>ãƒãƒ³ãƒ‰æ§‹é€ è¨ˆç®—</h1>
calc_bands = calc.fixed_density(
    kpts={'path': 'LGXULK', 'npoints': 60},  # é«˜å¯¾ç§°ç‚¹çµŒè·¯
    txt='si_bands.txt'
)

<h1>ãƒãƒ³ãƒ‰æ§‹é€ ã®å–å¾—</h1>
ef = calc_bands.get_fermi_level()
energies, k_distances = calc_bands.band_structure().get_bands()

<h1>ãƒ—ãƒ­ãƒƒãƒˆ</h1>
plt.figure(figsize=(8, 6))
for n in range(energies.shape[1]):
    plt.plot(k_distances, energies[:, n] - ef, 'b-', linewidth=1)

plt.axhline(0, color='red', linestyle='--', linewidth=1)
plt.ylabel('Energy [eV]', fontsize=12)
plt.xlabel('k-path', fontsize=12)
plt.title('Si Band Structure (PBE)', fontsize=14)
plt.ylim(-6, 6)
plt.grid(alpha=0.3)
plt.savefig('si_bandstructure.png', dpi=150)
plt.show()

<h1>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—è¨ˆç®—</h1>
vbm = energies[:, :4].max() - ef  # Valence Band Maximum
cbm = energies[:, 4:].min() - ef  # Conduction Band Minimum
print(f"ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— (Indirect): {cbm - vbm:.3f} eV")
print(f"å®Ÿé¨“å€¤: 1.17 eV")</code></pre>

<strong>å®Ÿè¡Œçµæœ</strong>:
<pre><code>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— (Indirect): 0.614 eV
å®Ÿé¨“å€¤: 1.17 eV</code></pre>

<strong>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—éå°è©•ä¾¡</strong>: DFTã®æ—¢çŸ¥ã®å•é¡Œï¼ˆæ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§è§£èª¬ï¼‰

---

<h3>Example 3: çŠ¶æ…‹å¯†åº¦ï¼ˆDOSï¼‰ã®è¨ˆç®—</h3>

<pre><code class="language-python">from gpaw import GPAW
import matplotlib.pyplot as plt

<h1>æ—¢ã«è¨ˆç®—æ¸ˆã¿ã®åŸºåº•çŠ¶æ…‹ã‚’èª­ã¿è¾¼ã¿</h1>
calc = GPAW('si_groundstate.gpw', txt=None)

<h1>çŠ¶æ…‹å¯†åº¦ã®è¨ˆç®—</h1>
energies, dos = calc.get_dos(spin=0, npts=1000, width=0.1)
ef = calc.get_fermi_level()

<h1>ãƒ—ãƒ­ãƒƒãƒˆ</h1>
plt.figure(figsize=(8, 6))
plt.plot(energies - ef, dos, linewidth=2)
plt.axvline(0, color='red', linestyle='--', linewidth=1, label='Fermi level')
plt.fill_between(energies - ef, dos, where=(energies <= ef), alpha=0.3, label='Occupied states')
plt.xlabel('Energy [eV]', fontsize=12)
plt.ylabel('DOS [states/eV]', fontsize=12)
plt.title('Si Density of States (PBE)', fontsize=14)
plt.xlim(-15, 10)
plt.legend()
plt.grid(alpha=0.3)
plt.savefig('si_dos.png', dpi=150)
plt.show()</code></pre>

---

<h3>Example 4: æ§‹é€ æœ€é©åŒ–ã¨åŠ›ã®è¨ˆç®—</h3>

<pre><code class="language-python">from ase.build import molecule
from ase.optimize import BFGS
from gpaw import GPAW, PW

<h1>æ°´åˆ†å­ã®åˆæœŸæ§‹é€ ï¼ˆã‚†ãŒã‚“ã æ§‹é€ ï¼‰</h1>
h2o = molecule('H2O')
h2o.positions[0] += [0.1, 0.1, 0]  # ã‚ã–ã¨æ­ªã¾ã›ã‚‹
h2o.center(vacuum=4.0)  # çœŸç©ºé ˜åŸŸã‚’è¿½åŠ 

<h1>è¨ˆç®—æ©Ÿã®è¨­å®š</h1>
calc = GPAW(mode=PW(400),
            xc='PBE',
            txt='h2o_opt.txt')

h2o.calc = calc

print("åˆæœŸæ§‹é€ :")
print(f"O-H1è·é›¢: {h2o.get_distance(0, 1):.3f} Ã…")
print(f"O-H2è·é›¢: {h2o.get_distance(0, 2):.3f} Ã…")
print(f"H-O-Hè§’åº¦: {h2o.get_angle(1, 0, 2):.1f}Â°")

<h1>æ§‹é€ æœ€é©åŒ–</h1>
opt = BFGS(h2o, trajectory='h2o_opt.traj')
opt.run(fmax=0.02)

print("\næœ€é©åŒ–å¾Œ:")
print(f"O-H1è·é›¢: {h2o.get_distance(0, 1):.3f} Ã…")
print(f"O-H2è·é›¢: {h2o.get_distance(0, 2):.3f} Ã…")
print(f"H-O-Hè§’åº¦: {h2o.get_angle(1, 0, 2):.1f}Â°")
print(f"\nå®Ÿé¨“å€¤: O-H = 0.958 Ã…, H-O-H = 104.5Â°")</code></pre>

<strong>å®Ÿè¡Œçµæœ</strong>:
<pre><code>åˆæœŸæ§‹é€ :
O-H1è·é›¢: 1.071 Ã…
O-H2è·é›¢: 0.969 Ã…
H-O-Hè§’åº¦: 104.5Â°

æœ€é©åŒ–å¾Œ:
O-H1è·é›¢: 0.972 Ã…
O-H2è·é›¢: 0.972 Ã…
H-O-Hè§’åº¦: 104.0Â°

å®Ÿé¨“å€¤: O-H = 0.958 Ã…, H-O-H = 104.5Â°</code></pre>

---

<h2>2.6 DFTã®é™ç•Œã¨å¯¾ç­–</h2>

<h3>é™ç•Œ1: ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã®éå°è©•ä¾¡</h3>

<strong>åŸå› </strong>: Kohn-Shamå›ºæœ‰å€¤$\epsilon_i$ã¯å³å¯†ã«ã¯æº–ç²’å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã¯ãªã„ã€‚äº¤æ›ç›¸é–¢ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ä¸æ­£ç¢ºã•ã€‚

<strong>å…¸å‹çš„ãªèª¤å·®</strong>: å®Ÿé¨“å€¤ã®30-50%éå°è©•ä¾¡

| ææ–™ | å®Ÿé¨“å€¤ [eV] | LDA [eV] | GGA [eV] |
|------|------------|---------|---------|
| Si | 1.17 | 0.5 | 0.6 |
| GaAs | 1.52 | 0.3 | 0.5 |
| Diamond | 5.48 | 4.1 | 4.3 |

<strong>å¯¾ç­–</strong>:
1. <strong>GWè¿‘ä¼¼</strong>ï¼ˆå¤šä½“æ‘‚å‹•è«–ï¼‰: æº–ç²’å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è¨ˆç®—
2. <strong>ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ±é–¢æ•°</strong>ï¼ˆHSE, B3LYPï¼‰: Hartree-Fockäº¤æ›ã®æ··åˆ
3. <strong>Scissorsæ“ä½œ</strong>ï¼ˆçµŒé¨“çš„è£œæ­£ï¼‰: ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’å®Ÿé¨“å€¤ã«ã‚·ãƒ•ãƒˆ

<h3>é™ç•Œ2: van der Waalsç›¸äº’ä½œç”¨</h3>

<strong>å•é¡Œ</strong>: LDA/GGAã¯van der Waalsï¼ˆåˆ†æ•£åŠ›ï¼‰ã‚’è¨˜è¿°ã§ããªã„ã€‚

<strong>å½±éŸ¿ã‚’å—ã‘ã‚‹ç³»</strong>:
- ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆå±¤é–“
- åˆ†å­çµæ™¶
- ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®æŠ˜ã‚ŠãŸãŸã¿

<strong>å¯¾ç­–</strong>:
1. <strong>DFT-D3</strong>ï¼ˆGrimmeã®åˆ†æ•£è£œæ­£ï¼‰: çµŒé¨“çš„è£œæ­£é …ã‚’è¿½åŠ 
2. <strong>vdW-DF</strong>ï¼ˆvan der Waals density functionalï¼‰: éå±€æ‰€ç›¸é–¢æ±é–¢æ•°
3. <strong>GPAWã§ã®å®Ÿè£…</strong>:

<pre><code class="language-python">calc = GPAW(mode=PW(400),
            xc='vdW-DF',  # van der Waalsæ±é–¢æ•°
            txt='graphite_vdw.txt')</code></pre>

<h3>é™ç•Œ3: å¼·ç›¸é–¢ç³»</h3>

<strong>å•é¡Œ</strong>: LDA/GGAã¯å¼·ã„é›»å­ç›¸é–¢ã‚’è¨˜è¿°ã§ããªã„ã€‚

<strong>å½±éŸ¿ã‚’å—ã‘ã‚‹ç³»</strong>:
- é·ç§»é‡‘å±é…¸åŒ–ç‰©ï¼ˆNiO, FeOï¼‰
- fé›»å­ç³»ï¼ˆå¸ŒåœŸé¡ã€ã‚¢ã‚¯ãƒãƒã‚¤ãƒ‰ï¼‰

<strong>å¯¾ç­–</strong>:
1. <strong>DFT+U</strong>: Hubbard Uãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å°å…¥
2. <strong>DMFT</strong>ï¼ˆDynamical Mean-Field Theoryï¼‰
3. <strong>Hybrid functionals</strong>

---

<h2>2.7 åæŸãƒ†ã‚¹ãƒˆ</h2>

DFTè¨ˆç®—ã§ã¯ä»¥ä¸‹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’åæŸã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

<h3>kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã®åæŸ</h3>

<pre><code class="language-python">from ase.build import bulk
from gpaw import GPAW, PW
import numpy as np
import matplotlib.pyplot as plt

si = bulk('Si', 'diamond', a=5.43)

k_grids = [(2,2,2), (4,4,4), (6,6,6), (8,8,8), (10,10,10), (12,12,12)]
energies = []

for kpts in k_grids:
    calc = GPAW(mode=PW(400), xc='PBE', kpts=kpts, txt=None)
    si.calc = calc
    E = si.get_potential_energy()
    energies.append(E)
    print(f"k-grid {kpts}: E = {E:.6f} eV")

<h1>ãƒ—ãƒ­ãƒƒãƒˆ</h1>
k_total = [k[0]**3 for k in k_grids]
plt.figure(figsize=(8, 6))
plt.plot(k_total, energies, 'o-', linewidth=2, markersize=8)
plt.xlabel('Total k-points', fontsize=12)
plt.ylabel('Total Energy [eV]', fontsize=12)
plt.title('k-point Convergence Test', fontsize=14)
plt.grid(alpha=0.3)
plt.savefig('k_convergence.png', dpi=150)
plt.show()</code></pre>

<strong>åæŸåˆ¤å®š</strong>: ã‚¨ãƒãƒ«ã‚®ãƒ¼å·® < 1 meV/atom

<h3>ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®åæŸ</h3>

<pre><code class="language-python">cutoffs = [200, 300, 400, 500, 600, 700]
energies = []

for ecut in cutoffs:
    calc = GPAW(mode=PW(ecut), xc='PBE', kpts=(8,8,8), txt=None)
    si.calc = calc
    E = si.get_potential_energy()
    energies.append(E)
    print(f"Cutoff {ecut} eV: E = {E:.6f} eV")

<h1>ãƒ—ãƒ­ãƒƒãƒˆ</h1>
plt.figure(figsize=(8, 6))
plt.plot(cutoffs, energies, 'o-', linewidth=2, markersize=8)
plt.xlabel('Cutoff Energy [eV]', fontsize=12)
plt.ylabel('Total Energy [eV]', fontsize=12)
plt.title('Plane Wave Cutoff Convergence Test', fontsize=14)
plt.grid(alpha=0.3)
plt.savefig('cutoff_convergence.png', dpi=150)
plt.show()</code></pre>

---

<h2>2.8 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

1. <strong>DFTã®åŸºæœ¬åŸç†</strong>
   - Hohenberg-Kohnå®šç†: é›»å­å¯†åº¦ã§ã™ã¹ã¦ãŒæ±ºã¾ã‚‹
   - Kohn-Shamæ–¹ç¨‹å¼: éç›¸äº’ä½œç”¨ç³»ã¸ã®å¤‰æ›
   - äº¤æ›ç›¸é–¢æ±é–¢æ•°: LDAã€GGA

2. <strong>ASE + GPAWã«ã‚ˆã‚‹å®Ÿè·µ</strong>
   - æ§‹é€ æœ€é©åŒ–
   - ãƒãƒ³ãƒ‰æ§‹é€ è¨ˆç®—
   - çŠ¶æ…‹å¯†åº¦ï¼ˆDOSï¼‰è¨ˆç®—
   - åæŸãƒ†ã‚¹ãƒˆ

3. <strong>DFTã®é™ç•Œ</strong>
   - ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã®éå°è©•ä¾¡
   - van der Waalsç›¸äº’ä½œç”¨ã®æ¬ å¦‚
   - å¼·ç›¸é–¢ç³»ã¸ã®ä¸é©ç”¨

<h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

- DFTã¯ç¬¬ä¸€åŸç†è¨ˆç®—ã®å®Ÿç”¨çš„æ‰‹æ³•
- è¨ˆç®—ç²¾åº¦ã¯äº¤æ›ç›¸é–¢æ±é–¢æ•°ã®é¸æŠã«ä¾å­˜
- åæŸãƒ†ã‚¹ãƒˆã¯å¿…é ˆ
- ç³»ã«å¿œã˜ã¦é©åˆ‡ãªè£œæ­£ãŒå¿…è¦

<h3>æ¬¡ã®ç« ã¸</h3>

ç¬¬3ç« ã§ã¯ã€åŸå­æ ¸ã®é‹å‹•ã‚’æ‰±ã†<strong>åˆ†å­å‹•åŠ›å­¦ï¼ˆMDï¼‰ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</strong>ã‚’å­¦ã³ã¾ã™ã€‚

---

<h2>æ¼”ç¿’å•é¡Œ</h2>

<h3>å•é¡Œ1ï¼ˆé›£æ˜“åº¦ï¼šeasyï¼‰</h3>

Hohenberg-Kohnç¬¬1å®šç†ã®ç‰©ç†çš„æ„å‘³ã‚’è‡ªåˆ†ã®è¨€è‘‰ã§èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

<details>
<summary>è§£ç­”ä¾‹</summary>

é›»å­å¯†åº¦$n(\mathbf{r})$ãŒä¸ãˆã‚‰ã‚Œã‚Œã°ã€å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«$V_{\text{ext}}(\mathbf{r})$ãŒæ±ºã¾ã‚Šã¾ã™ã€‚å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãŒæ±ºã¾ã‚Œã°ã€ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³$\hat{H}$ãŒæ±ºã¾ã‚Šã€ã‚·ãƒ¥ãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼æ–¹ç¨‹å¼ãŒè§£ã‘ã¾ã™ã€‚ã¤ã¾ã‚Šã€<strong>é›»å­å¯†åº¦ã ã‘ã§ç³»ã®ã™ã¹ã¦ã®æ€§è³ªãŒæ±ºå®šã•ã‚Œã‚‹</strong>ã¨ã„ã†ã“ã¨ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€$3N$æ¬¡å…ƒã®æ³¢å‹•é–¢æ•°ã®ä»£ã‚ã‚Šã«ã€3æ¬¡å…ƒã®é›»å­å¯†åº¦ã§å¤šé›»å­ç³»ã‚’è¨˜è¿°ã§ãã¾ã™ã€‚

</details>

<h3>å•é¡Œ2ï¼ˆé›£æ˜“åº¦ï¼šmediumï¼‰</h3>

Siã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ãŒDFT-GGAï¼ˆPBEï¼‰ã§0.6 eVã€å®Ÿé¨“å€¤ãŒ1.17 eVã§ã™ã€‚ã“ã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—éå°è©•ä¾¡ã®åŸå› ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

<details>
<summary>è§£ç­”ä¾‹</summary>

DFTã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—éå°è©•ä¾¡ã®ä¸»ãªåŸå› ã¯ä»¥ä¸‹ã®2ã¤ã§ã™ï¼š

1. <strong>Kohn-Shamå›ºæœ‰å€¤ã®è§£é‡ˆã®å•é¡Œ</strong>: Kohn-Shamå›ºæœ‰å€¤$\epsilon_i$ã¯å³å¯†ã«ã¯æº–ç²’å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚Kohn-Shamæ–¹ç¨‹å¼ã¯å½¢å¼çš„ã«ã¯1é›»å­ã‚·ãƒ¥ãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼æ–¹ç¨‹å¼ã§ã™ãŒã€ã“ã‚Œã¯æ•°å­¦çš„ãªä¾¿å®œã®ãŸã‚ã®ã‚‚ã®ã§ã€$\epsilon_i$ã¯ç‰©ç†çš„ãªåŠ±èµ·ã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

2. <strong>äº¤æ›ç›¸é–¢æ±é–¢æ•°ã®ä¸æ­£ç¢ºã•</strong>: LDA/GGAã®äº¤æ›ç›¸é–¢æ±é–¢æ•°ã¯ã€é›»å­ã®è‡ªå·±ç›¸äº’ä½œç”¨ï¼ˆself-interactionï¼‰ã‚’å®Œå…¨ã«ã¯æ‰“ã¡æ¶ˆã—ã¾ã›ã‚“ã€‚ã“ã®èª¤å·®ã«ã‚ˆã‚Šã€å æœ‰æº–ä½ãŒä¸ŠãŒã‚Šï¼ˆæµ…ããªã‚Šï¼‰ã€éå æœ‰æº–ä½ãŒä¸‹ãŒã‚‹ï¼ˆæµ…ããªã‚‹ï¼‰ãŸã‚ã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ãŒéå°è©•ä¾¡ã•ã‚Œã¾ã™ã€‚

<strong>å¯¾ç­–</strong>:
- GWè¿‘ä¼¼: æº–ç²’å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ­£ç¢ºã«è¨ˆç®—ï¼ˆè¨ˆç®—ã‚³ã‚¹ãƒˆå¤§ï¼‰
- ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ±é–¢æ•°ï¼ˆHSE, B3LYPï¼‰: Hartree-Fockäº¤æ›ã‚’æ··åˆ
- DFT+U: å¼·ç›¸é–¢ç³»å‘ã‘
- Scissorsæ“ä½œ: çµŒé¨“çš„ã«ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’è£œæ­£

</details>

<h3>å•é¡Œ3ï¼ˆé›£æ˜“åº¦ï¼šhardï¼‰</h3>

ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆå±¤é–“è·é›¢ã‚’DFT-GGAï¼ˆPBEï¼‰ã§è¨ˆç®—ã™ã‚‹ã¨å®Ÿé¨“å€¤ã‚ˆã‚Šå¤§ããéå¤§è©•ä¾¡ã•ã‚Œã¾ã™ã€‚ã“ã®ç†ç”±ã¨å¯¾ç­–ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

<details>
<summary>è§£ç­”ä¾‹</summary>

<strong>ç†ç”±</strong>: LDA/GGAã¯van der Waalsï¼ˆåˆ†æ•£åŠ›ï¼‰ç›¸äº’ä½œç”¨ã‚’è¨˜è¿°ã§ããªã„ãŸã‚ã§ã™ã€‚

ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆã®å±¤é–“ã¯å…±æœ‰çµåˆã‚„ã‚¤ã‚ªãƒ³çµåˆã§ã¯ãªãã€<strong>van der WaalsåŠ›</strong>ï¼ˆLondonåˆ†æ•£åŠ›ï¼‰ã§çµåˆã—ã¦ã„ã¾ã™ã€‚ã“ã®åŠ›ã¯é›»å­å¯†åº¦ã®æºã‚‰ãã«ã‚ˆã‚‹ç¬é–“åŒæ¥µå­é–“ã®ç›¸äº’ä½œç”¨ã§ã€éå±€æ‰€çš„ãªåŠ¹æœã§ã™ã€‚

LDA/GGAã®äº¤æ›ç›¸é–¢æ±é–¢æ•°ã¯<strong>å±€æ‰€çš„</strong>ï¼ˆã¾ãŸã¯æº–å±€æ‰€çš„ï¼‰ã§ã‚ã‚Šã€å¯†åº¦$n(\mathbf{r})$ã¨ãã®å‹¾é…$\nabla n(\mathbf{r})$ã ã‘ã§æ±ºã¾ã‚Šã¾ã™ã€‚ã“ã®ãŸã‚ã€é è·é›¢ã®é›»å­ç›¸é–¢ï¼ˆvan der WaalsåŠ›ï¼‰ã‚’è¨˜è¿°ã§ãã¾ã›ã‚“ã€‚

çµæœã¨ã—ã¦ï¼š
- å±¤é–“ã®å¼•åŠ›ãŒéå°è©•ä¾¡ã•ã‚Œã‚‹
- å±¤é–“è·é›¢ãŒå®Ÿé¨“å€¤ã‚ˆã‚Šå¤§ãããªã‚‹
- çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒéå°è©•ä¾¡ã•ã‚Œã‚‹

<strong>å¯¾ç­–</strong>:

1. <strong>DFT-D3</strong>ï¼ˆGrimmeã®åˆ†æ•£è£œæ­£ï¼‰:
   - çµŒé¨“çš„ãª$C_6/r^6$é …ã‚’è¿½åŠ 
   - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å…ƒç´ ã”ã¨ã«æ±ºå®š
   - GPAWã§ã®å®Ÿè£…: <code>xc='PBE+D3'</code>

2. <strong>vdW-DF</strong>ï¼ˆvan der Waals density functionalï¼‰:
   - éå±€æ‰€ç›¸é–¢æ±é–¢æ•°
   - ç¬¬ä¸€åŸç†çš„ï¼ˆçµŒé¨“ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã—ï¼‰
   - GPAWã§ã®å®Ÿè£…: <code>xc='vdW-DF'</code> or <code>xc='vdW-DF2'</code>

3. <strong>è¨ˆç®—ä¾‹</strong>:
<pre><code class="language-python">from ase.build import graphite
from gpaw import GPAW, PW

graphite = graphite(a=2.46, c=6.70)  # åˆæœŸæ§‹é€ 

<h1>PBEã®ã¿</h1>
calc_pbe = GPAW(mode=PW(400), xc='PBE', kpts=(8,8,4), txt='gr_pbe.txt')
graphite.calc = calc_pbe
E_pbe = graphite.get_potential_energy()

<h1>PBE + D3</h1>
calc_d3 = GPAW(mode=PW(400), xc='PBE+D3', kpts=(8,8,4), txt='gr_d3.txt')
graphite.calc = calc_d3
E_d3 = graphite.get_potential_energy()

print(f"PBE: E = {E_pbe:.3f} eV")
print(f"PBE+D3: E = {E_d3:.3f} eV")
print(f"vdWè£œæ­£: {E_d3 - E_pbe:.3f} eV")</code></pre>

vdWè£œæ­£ã«ã‚ˆã‚Šå±¤é–“è·é›¢ãŒå®Ÿé¨“å€¤ï¼ˆ3.35 Ã…ï¼‰ã«è¿‘ã¥ãã¾ã™ã€‚

</details>

---

<h2>å‚è€ƒæ–‡çŒ®</h2>

1. Hohenberg, P., & Kohn, W. (1964). "Inhomogeneous Electron Gas." *Physical Review*, 136(3B), B864-B871.
   DOI: [10.1103/PhysRev.136.B864](https://doi.org/10.1103/PhysRev.136.B864)

2. Kohn, W., & Sham, L. J. (1965). "Self-Consistent Equations Including Exchange and Correlation Effects." *Physical Review*, 140(4A), A1133-A1138.
   DOI: [10.1103/PhysRev.140.A1133](https://doi.org/10.1103/PhysRev.140.A1133)

3. Perdew, J. P., Burke, K., & Ernzerhof, M. (1996). "Generalized Gradient Approximation Made Simple." *Physical Review Letters*, 77(18), 3865-3868.
   DOI: [10.1103/PhysRevLett.77.3865](https://doi.org/10.1103/PhysRevLett.77.3865)

4. Martin, R. M. (2004). *Electronic Structure: Basic Theory and Practical Methods*. Cambridge University Press.

5. ASE Documentation: https://wiki.fysik.dtu.dk/ase/
6. GPAW Documentation: https://wiki.fysik.dtu.dk/gpaw/

---

<h2>è‘—è€…æƒ…å ±</h2>

<strong>ä½œæˆè€…</strong>: MI Knowledge Hub Content Team
<strong>ç›£ä¿®</strong>: Dr. Yusuke Hashimotoï¼ˆæ±åŒ—å¤§å­¦ï¼‰
<strong>ä½œæˆæ—¥</strong>: 2025-10-17
<strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0
<strong>ã‚·ãƒªãƒ¼ã‚º</strong>: è¨ˆç®—ææ–™ç§‘å­¦åŸºç¤å…¥é–€ v1.0

<strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY-NC-SA 4.0
<div class="navigation">
    <a href="chapter-1.html" class="nav-button">â† ç¬¬1ç« </a>
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="chapter-3.html" class="nav-button">ç¬¬3ç«  â†’</a>
</div>
    </main>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ç›£ä¿®</strong>: Dr. Yusuke Hashimotoï¼ˆæ±åŒ—å¤§å­¦ï¼‰</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-17</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mermaidCodeBlocks = document.querySelectorAll('pre.codehilite code.language-mermaid, pre code.language-mermaid');

            mermaidCodeBlocks.forEach(function(codeBlock) {
                const pre = codeBlock.parentElement;
                const mermaidCode = codeBlock.textContent;

                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode.trim();

                pre.parentNode.replaceChild(mermaidDiv, pre);
            });

            if (typeof mermaid !== 'undefined') {
                mermaid.initialize({
                    startOnLoad: true,
                    theme: 'default'
                });
                mermaid.init(undefined, document.querySelectorAll('.mermaid'));
            }
        });
    </script>
</body>
</html>
