<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« ï¼šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ - AI Terakoya</title>
    <style>
        :root {
            --color-primary-900: #1a252f;
            --color-primary-700: #2c3e50;
            --color-primary-500: #34495e;
            --color-primary-300: #4a5f7a;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-bg: #ffffff;
            --color-bg-secondary: #f8f9fa;
            --color-text: #2c3e50;
            --color-text-light: #6c757d;
            --color-border: #e9ecef;
            --color-code-bg: #f8f9fa;
            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;
            --font-base: 1rem;
            --font-sm: 0.875rem;
            --font-lg: 1.125rem;
            --font-xl: 1.5rem;
            --font-2xl: 2rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans JP", sans-serif;
            line-height: 1.7;
            color: var(--color-text);
            background: var(--color-bg);
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            max-width: 800px;
            margin: 0 auto;
        }

        header h1 {
            font-size: var(--font-2xl);
            margin-bottom: var(--spacing-sm);
            font-weight: 700;
        }

        .subtitle {
            font-size: var(--font-lg);
            opacity: 0.95;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            justify-content: center;
            font-size: var(--font-sm);
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--spacing-xl) var(--spacing-md);
        }

        h2 {
            font-size: var(--font-xl);
            color: var(--color-accent);
            margin: var(--spacing-lg) 0 var(--spacing-md) 0;
            padding-bottom: var(--spacing-xs);
            border-bottom: 2px solid var(--color-accent-light);
        }

        h3 {
            font-size: var(--font-lg);
            color: var(--color-primary-700);
            margin: var(--spacing-md) 0 var(--spacing-sm) 0;
        }

        h4 {
            font-size: var(--font-base);
            color: var(--color-primary-500);
            margin: var(--spacing-sm) 0;
        }

        p {
            margin-bottom: var(--spacing-md);
            line-height: 1.8;
        }

        ul, ol {
            margin: var(--spacing-md) 0;
            padding-left: var(--spacing-lg);
        }

        li {
            margin-bottom: var(--spacing-xs);
        }

        code {
            background: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
            color: var(--color-accent);
        }

        pre {
            background: var(--color-code-bg);
            border-left: 4px solid var(--color-accent);
            padding: var(--spacing-md);
            overflow-x: auto;
            border-radius: 4px;
            margin: var(--spacing-md) 0;
        }

        pre code {
            background: none;
            padding: 0;
            color: var(--color-text);
        }

        .mermaid {
            background: white;
            padding: var(--spacing-md);
            border-radius: 8px;
            margin: var(--spacing-md) 0;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: var(--spacing-md) 0;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        th, td {
            padding: var(--spacing-sm);
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }

        th {
            background: var(--color-accent);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: var(--color-bg-secondary);
        }

        details {
            background: var(--color-bg-secondary);
            padding: var(--spacing-md);
            border-radius: 8px;
            margin: var(--spacing-md) 0;
            border: 1px solid var(--color-border);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-accent);
            padding: var(--spacing-sm);
            margin: calc(-1 * var(--spacing-md));
            margin-bottom: var(--spacing-md);
            background: white;
            border-radius: 8px 8px 0 0;
        }

        summary:hover {
            background: var(--color-bg-secondary);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 1px solid var(--color-border);
        }

        .btn {
            display: inline-block;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s;
            min-height: 44px;
            display: flex;
            align-items: center;
        }

        .btn-primary {
            background: var(--color-accent);
            color: white;
        }

        .btn-secondary {
            background: var(--color-primary-500);
            color: white;
        }

        @media (hover: hover) and (pointer: fine) {
            .btn-primary:hover {
                background: var(--color-accent-light);
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(123, 44, 191, 0.3);
            }

            .btn-secondary:hover {
                background: var(--color-primary-700);
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            }
        }

        footer {
            background: var(--color-primary-900);
            color: white;
            padding: var(--spacing-lg);
            text-align: center;
            margin-top: var(--spacing-xl);
        }

        footer a {
            color: var(--color-accent-light);
            text-decoration: none;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: var(--font-xl);
            }

            .subtitle {
                font-size: var(--font-base);
            }

            .meta {
                font-size: 0.8rem;
            }

            .navigation {
                flex-direction: column;
            }
        }
    </style>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬3ç« ï¼šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h1>
            <p class="subtitle"></p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 20-25åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: åˆç´šã€œä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 12</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 3</span>
            </div>
        </div>
    </header>

    <main class="container">
        <p>
<h1>ç¬¬3ç« ï¼šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h1>
</p>
<p>
<strong>è¤‡æ•°DBã®çµ±åˆã¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å®Ÿè·µ</strong>
</p>
<p>
<h2>å­¦ç¿’ç›®æ¨™</h2>
</p>
<p>
ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š
</p>
<p>
<ul><li>âœ… Materials Projectã¨AFLOWãƒ‡ãƒ¼ã‚¿ã‚’çµ±åˆã§ãã‚‹</li>
<li>âœ… ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã®æ¨™æº–æ‰‹æ³•ã‚’é©ç”¨ã§ãã‚‹</li>
<li>âœ… æ¬ æå€¤ã‚’é©åˆ‡ã«å‡¦ç†ã§ãã‚‹</li>
<li>âœ… è‡ªå‹•æ›´æ–°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
<li>âœ… ãƒ‡ãƒ¼ã‚¿å“è³ªã‚’å®šé‡çš„ã«è©•ä¾¡ã§ãã‚‹</li>
</p>
<p>
<strong>èª­äº†æ™‚é–“</strong>: 20-25åˆ†
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹</strong>: 12å€‹
<strong>æ¼”ç¿’å•é¡Œ</strong>: 3å•
</p>
<p>
---
</p>
<p>
<h2>3.1 è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®çµ±åˆ</h2>
</p>
<p>
ææ–™ç ”ç©¶ã§ã¯ã€å˜ä¸€ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã ã‘ã§ãªãã€è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šä¿¡é ¼æ€§ã®é«˜ã„çµæœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚ã“ã“ã§ã¯ã€Materials Projectã¨AFLOWãƒ‡ãƒ¼ã‚¿ã‚’çµ±åˆã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚
</p>
<p>
<h3>3.1.1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆã®åŸºæœ¬æˆ¦ç•¥</h3>
</p>
<p>
<pre><code class="language-mermaid">flowchart TD
    A[Materials Project] --> C[å…±é€šè­˜åˆ¥å­ã§ç…§åˆ]
    B[AFLOW] --> C
    C --> D[ãƒ‡ãƒ¼ã‚¿çµåˆ]
    D --> E[é‡è¤‡å‰Šé™¤]
    E --> F[æ¬ æå€¤å‡¦ç†]
    F --> G[çµ±åˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ]
</p>
<p>
    style A fill:#e3f2fd
    style B fill:#fff3e0
    style G fill:#e8f5e9
</code></pre>
</p>
<p>
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹1: Materials Projectã¨AFLOWãƒ‡ãƒ¼ã‚¿ã®å–å¾—</strong>
</p>
<p>
<pre><code class="language-python">from mp_api.client import MPRester
import requests
import pandas as pd
</p>
<p>
MP_API_KEY = "your_mp_key"
</p>
<p>
def get_mp_data(formula):
    """Materials Projectã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—"""
    with MPRester(MP_API_KEY) as mpr:
        docs = mpr.materials.summary.search(
            formula=formula,
            fields=[
                "material_id",
                "formula_pretty",
                "band_gap",
                "formation_energy_per_atom",
                "energy_above_hull"
            ]
        )
</p>
<p>
        if docs:
            doc = docs[0]
            return {
                "source": "Materials Project",
                "id": doc.material_id,
                "formula": doc.formula_pretty,
                "band_gap": doc.band_gap,
                "formation_energy":
                    doc.formation_energy_per_atom,
                "stability": doc.energy_above_hull
            }
    return None
</p>
<p>
def get_aflow_data(formula):
    """AFLOWã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—"""
    url = "http://aflowlib.org/API/aflux"
    params = {
        "species": formula,
        "$": "formula,Egap,enthalpy_formation_atom"
    }
</p>
<p>
    try:
        response = requests.get(url, params=params, timeout=10)
        data = response.json()
</p>
<p>
        if data:
            item = data[0]
            return {
                "source": "AFLOW",
                "id": item.get("auid", "N/A"),
                "formula": item.get("formula", formula),
                "band_gap": item.get("Egap", None),
                "formation_energy":
                    item.get("enthalpy_formation_atom", None),
                "stability": None  # AFLOWã«ã¯ç›´æ¥çš„ãªå€¤ãªã—
            }
    except Exception as e:
        print(f"AFLOWå–å¾—ã‚¨ãƒ©ãƒ¼: {e}")
</p>
<p>
    return None
</p>
<p>
<h1>TiO2ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸¡æ–¹ã‹ã‚‰å–å¾—</h1>
formula = "TiO2"
mp_data = get_mp_data(formula)
aflow_data = get_aflow_data(formula)
</p>
<p>
print(f"=== {formula}ã®ãƒ‡ãƒ¼ã‚¿æ¯”è¼ƒ ===")
print(f"\nMaterials Project:")
print(mp_data)
print(f"\nAFLOW:")
print(aflow_data)
</code></pre>
</p>
<p>
<strong>å‡ºåŠ›ä¾‹</strong>:
``<code>
=== TiO2ã®ãƒ‡ãƒ¼ã‚¿æ¯”è¼ƒ ===
</p>
<p>
Materials Project:
{'source': 'Materials Project', 'id': 'mp-2657', 'formula': 'TiO2',
 'band_gap': 3.44, 'formation_energy': -4.872, 'stability': 0.0}
</p>
<p>
AFLOW:
{'source': 'AFLOW', 'id': 'aflow:123456', 'formula': 'TiO2',
 'band_gap': 3.38, 'formation_energy': -4.915, 'stability': None}
</code>`<code>
</p>
<p>
<h3>3.1.2 ãƒ‡ãƒ¼ã‚¿çµåˆï¼ˆJoinï¼‰</h3>
</p>
<p>
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹2: åŒ–å­¦å¼ã‚’ã‚­ãƒ¼ã¨ã—ãŸçµåˆ</strong>
</p>
<p>
<pre><code class="language-python">import pandas as pd
</p>
<p>
def merge_databases(formulas):
    """è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚’çµåˆ"""
    mp_data_list = []
    aflow_data_list = []
</p>
<p>
    for formula in formulas:
        mp_data = get_mp_data(formula)
        if mp_data:
            mp_data_list.append(mp_data)
</p>
<p>
        aflow_data = get_aflow_data(formula)
        if aflow_data:
            aflow_data_list.append(aflow_data)
</p>
<p>
    # DataFrameã«å¤‰æ›
    df_mp = pd.DataFrame(mp_data_list)
    df_aflow = pd.DataFrame(aflow_data_list)
</p>
<p>
    # åŒ–å­¦å¼ã§ãƒãƒ¼ã‚¸
    df_merged = pd.merge(
        df_mp,
        df_aflow,
        on="formula",
        how="outer",
        suffixes=("_mp", "_aflow")
    )
</p>
<p>
    return df_merged
</p>
<p>
<h1>è¤‡æ•°ææ–™ã§çµ±åˆ</h1>
formulas = ["TiO2", "ZnO", "GaN", "SiC"]
df = merge_databases(formulas)
</p>
<p>
print("çµ±åˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ:")
print(df)
print(f"\nç·ä»¶æ•°: {len(df)}")
</code></pre>
</p>
<p>
<strong>å‡ºåŠ›ä¾‹</strong>:
</code>`<code>
çµ±åˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ:
  formula    id_mp  band_gap_mp  formation_energy_mp    id_aflow  band_gap_aflow  ...
0    TiO2  mp-2657         3.44                -4.872  aflow:123              3.38  ...
1     ZnO  mp-2133         3.44                -1.950  aflow:456              3.41  ...
...
</p>
<p>
ç·ä»¶æ•°: 4
</code>``
</p>
<p>
---
</p>
<p>
<h2>3.2 ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°</h2>
</p>
<p>
<h3>3.2.1 é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®æ¤œå‡ºã¨å‰Šé™¤</h3>
</p>
<p>
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹3: é‡è¤‡æ¤œå‡º</strong>
</p>
<p>
<pre><code class="language-python">import pandas as pd
</p>
<p>
def detect_duplicates(df):
    """é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®æ¤œå‡º"""
    # åŒ–å­¦å¼ã«ã‚ˆã‚‹é‡è¤‡
    duplicates = df[df.duplicated(subset=['formula'],
                                   keep=False)]
</p>
<p>
    print("=== é‡è¤‡ãƒ‡ãƒ¼ã‚¿æ¤œå‡º ===")
    print(f"ç·ãƒ‡ãƒ¼ã‚¿æ•°: {len(df)}")
    print(f"é‡è¤‡ã‚ã‚Š: {len(duplicates)}")
</p>
<p>
    if len(duplicates) > 0:
        print("\né‡è¤‡ãƒ‡ãƒ¼ã‚¿:")
        print(duplicates[['formula', 'source', 'id']])
</p>
<p>
    # é‡è¤‡å‰Šé™¤ï¼ˆæœ€åˆã®ã‚¨ãƒ³ãƒˆãƒªã‚’ä¿æŒï¼‰
    df_clean = df.drop_duplicates(subset=['formula'],
                                   keep='first')
</p>
<p>
    print(f"\né‡è¤‡å‰Šé™¤å¾Œ: {len(df_clean)}ä»¶")
    return df_clean
</p>
<p>
<h1>ä½¿ç”¨ä¾‹</h1>
df_clean = detect_duplicates(df)
</code></pre>
</p>
<p>
<h3>3.2.2 ç•°å¸¸å€¤ã®æ¤œå‡º</h3>
</p>
<p>
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹4: å¤–ã‚Œå€¤æ¤œå‡ºï¼ˆIQRæ³•ï¼‰</strong>
</p>
<p>
<pre><code class="language-python">import numpy as np
</p>
<p>
def detect_outliers(df, column):
    """IQRæ³•ã«ã‚ˆã‚‹å¤–ã‚Œå€¤æ¤œå‡º"""
    Q1 = df[column].quantile(0.25)
    Q3 = df[column].quantile(0.75)
    IQR = Q3 - Q1
</p>
<p>
    # å¤–ã‚Œå€¤ã®ç¯„å›²
    lower_bound = Q1 - 1.5 * IQR
    upper_bound = Q3 + 1.5 * IQR
</p>
<p>
    # å¤–ã‚Œå€¤æ¤œå‡º
    outliers = df[
        (df[column] < lower_bound) |
        (df[column] > upper_bound)
    ]
</p>
<p>
    print(f"=== {column}ã®å¤–ã‚Œå€¤æ¤œå‡º ===")
    print(f"Q1: {Q1:.3f}, Q3: {Q3:.3f}, IQR: {IQR:.3f}")
    print(f"ç¯„å›²: [{lower_bound:.3f}, {upper_bound:.3f}]")
    print(f"å¤–ã‚Œå€¤: {len(outliers)}ä»¶")
</p>
<p>
    if len(outliers) > 0:
        print("\nå¤–ã‚Œå€¤ãƒ‡ãƒ¼ã‚¿:")
        print(outliers[['formula', column]])
</p>
<p>
    return outliers
</p>
<p>
<h1>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã®å¤–ã‚Œå€¤æ¤œå‡º</h1>
outliers_bg = detect_outliers(df_clean, 'band_gap_mp')
</code></pre>
</p>
<p>
---
</p>
<p>
<h2>3.3 æ¬ æå€¤å‡¦ç†</h2>
</p>
<p>
<h3>3.3.1 æ¬ æãƒ‘ã‚¿ãƒ¼ãƒ³ã®å¯è¦–åŒ–</h3>
</p>
<p>
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹5: æ¬ æå€¤ã®åˆ†æ</strong>
</p>
<p>
<pre><code class="language-python">import matplotlib.pyplot as plt
import seaborn as sns
</p>
<p>
def analyze_missing_values(df):
    """æ¬ æå€¤ã®è©³ç´°åˆ†æ"""
    # æ¬ æå€¤ã‚«ã‚¦ãƒ³ãƒˆ
    missing_count = df.isnull().sum()
    missing_percent = (missing_count / len(df)) * 100
</p>
<p>
    # ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ
    missing_df = pd.DataFrame({
        "Column": missing_count.index,
        "Missing Count": missing_count.values,
        "Missing %": missing_percent.values
    })
    missing_df = missing_df[missing_df["Missing Count"] > 0]
    missing_df = missing_df.sort_values("Missing %",
                                        ascending=False)
</p>
<p>
    print("=== æ¬ æå€¤ãƒ¬ãƒãƒ¼ãƒˆ ===")
    print(missing_df)
</p>
<p>
    # ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—
    plt.figure(figsize=(10, 6))
    sns.heatmap(
        df.isnull(),
        cbar=True,
        cmap='viridis',
        yticklabels=False
    )
    plt.title("Missing Values Heatmap")
    plt.xlabel("Columns")
    plt.tight_layout()
    plt.savefig("missing_values_heatmap.png", dpi=150)
    plt.show()
</p>
<p>
    return missing_df
</p>
<p>
<h1>æ¬ æå€¤åˆ†æ</h1>
missing_report = analyze_missing_values(df_clean)
</code></pre>
</p>
<p>
<h3>3.3.2 æ¬ æå€¤ã®è£œå®Œ</h3>
</p>
<p>
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹6: è£œå®Œæˆ¦ç•¥</strong>
</p>
<p>
<pre><code class="language-python">from sklearn.impute import SimpleImputer, KNNImputer
</p>
<p>
def impute_missing_values(df, method='mean'):
    """
    æ¬ æå€¤è£œå®Œ
</p>
<p>
    Parameters:
    -----------
    method : str
        'mean', 'median', 'knn'ã®ã„ãšã‚Œã‹
    """
    numeric_cols = df.select_dtypes(
        include=[np.number]
    ).columns
</p>
<p>
    df_imputed = df.copy()
</p>
<p>
    if method == 'mean':
        imputer = SimpleImputer(strategy='mean')
    elif method == 'median':
        imputer = SimpleImputer(strategy='median')
    elif method == 'knn':
        imputer = KNNImputer(n_neighbors=5)
    else:
        raise ValueError(f"Unknown method: {method}")
</p>
<p>
    # æ•°å€¤åˆ—ã®ã¿è£œå®Œ
    df_imputed[numeric_cols] = imputer.fit_transform(
        df[numeric_cols]
    )
</p>
<p>
    print(f"=== æ¬ æå€¤è£œå®Œï¼ˆ{method}æ³•ï¼‰ ===")
    print(f"è£œå®Œå‰: {df.isnull().sum().sum()}ä»¶")
    print(f"è£œå®Œå¾Œ: {df_imputed.isnull().sum().sum()}ä»¶")
</p>
<p>
    return df_imputed
</p>
<p>
<h1>å¹³å‡å€¤è£œå®Œ</h1>
df_imputed = impute_missing_values(df_clean, method='mean')
</p>
<p>
<h1>KNNè£œå®Œï¼ˆã‚ˆã‚Šé«˜åº¦ï¼‰</h1>
df_knn = impute_missing_values(df_clean, method='knn')
</code></pre>
</p>
<p>
---
</p>
<p>
<h2>3.4 è‡ªå‹•æ›´æ–°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</h2>
</p>
<p>
<h3>3.4.1 ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</h3>
</p>
<p>
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹7: è‡ªå‹•æ›´æ–°ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</strong>
</p>
<p>
<pre><code class="language-python">from datetime import datetime
import json
import os
</p>
<p>
class DataUpdatePipeline:
    """è‡ªå‹•ãƒ‡ãƒ¼ã‚¿æ›´æ–°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³"""
</p>
<p>
    def __init__(self, output_dir="data"):
        self.output_dir = output_dir
        os.makedirs(output_dir, exist_ok=True)
</p>
<p>
    def fetch_data(self, formulas):
        """ãƒ‡ãƒ¼ã‚¿å–å¾—"""
        print(f"ãƒ‡ãƒ¼ã‚¿å–å¾—é–‹å§‹: {datetime.now()}")
        df = merge_databases(formulas)
        return df
</p>
<p>
    def clean_data(self, df):
        """ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°"""
        print("ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ä¸­...")
        df = detect_duplicates(df)
        df = impute_missing_values(df, method='mean')
        return df
</p>
<p>
    def save_data(self, df, filename=None):
        """ãƒ‡ãƒ¼ã‚¿ä¿å­˜"""
        if filename is None:
            timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
            filename = f"materials_data_{timestamp}.csv"
</p>
<p>
        filepath = os.path.join(self.output_dir, filename)
        df.to_csv(filepath, index=False)
        print(f"ãƒ‡ãƒ¼ã‚¿ä¿å­˜å®Œäº†: {filepath}")
</p>
<p>
        # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä¿å­˜
        metadata = {
            "timestamp": datetime.now().isoformat(),
            "num_records": len(df),
            "columns": list(df.columns),
            "file": filename
        }
</p>
<p>
        meta_file = filepath.replace(".csv", "_meta.json")
        with open(meta_file, 'w') as f:
            json.dump(metadata, f, indent=2)
</p>
<p>
        return filepath
</p>
<p>
    def run(self, formulas):
        """ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ"""
        # ãƒ‡ãƒ¼ã‚¿å–å¾—
        df = self.fetch_data(formulas)
</p>
<p>
        # ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
        df_clean = self.clean_data(df)
</p>
<p>
        # ä¿å­˜
        filepath = self.save_data(df_clean)
</p>
<p>
        print(f"\n=== ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Œäº† ===")
        print(f"å–å¾—ä»¶æ•°: {len(df_clean)}")
        print(f"ãƒ•ã‚¡ã‚¤ãƒ«: {filepath}")
</p>
<p>
        return df_clean
</p>
<p>
<h1>ä½¿ç”¨ä¾‹</h1>
pipeline = DataUpdatePipeline()
formulas = ["TiO2", "ZnO", "GaN", "SiC", "Al2O3"]
df_result = pipeline.run(formulas)
</code></pre>
</p>
<p>
<h3>3.4.2 ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ</h3>
</p>
<p>
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹8: croné¢¨ã®å®šæœŸå®Ÿè¡Œ</strong>
</p>
<p>
<pre><code class="language-python">import schedule
import time
</p>
<p>
def scheduled_update():
    """å®šæœŸæ›´æ–°ã‚¸ãƒ§ãƒ–"""
    print(f"\n{'='*50}")
    print(f"å®šæœŸæ›´æ–°é–‹å§‹: {datetime.now()}")
    print(f"{'='*50}")
</p>
<p>
    # ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ
    pipeline = DataUpdatePipeline()
    formulas = ["TiO2", "ZnO", "GaN", "SiC"]
    pipeline.run(formulas)
</p>
<p>
<h1>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­å®š</h1>
schedule.every().day.at("09:00").do(scheduled_update)
schedule.every().week.do(scheduled_update)
</p>
<p>
<h1>å®Ÿè¡Œï¼ˆãƒ‡ãƒ¢ç”¨: 10ç§’ã”ã¨ï¼‰</h1>
schedule.every(10).seconds.do(scheduled_update)
</p>
<p>
print("ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼é–‹å§‹...")
print("Ctrl+Cã§çµ‚äº†")
</p>
<p>
<h1>ç„¡é™ãƒ«ãƒ¼ãƒ—</h1>
while True:
    schedule.run_pending()
    time.sleep(1)
</code></pre>
</p>
<p>
---
</p>
<p>
<h2>3.5 ãƒ‡ãƒ¼ã‚¿å“è³ªç®¡ç†</h2>
</p>
<p>
<h3>3.5.1 å“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹</h3>
</p>
<p>
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹9: ãƒ‡ãƒ¼ã‚¿å“è³ªè©•ä¾¡</strong>
</p>
<p>
<pre><code class="language-python">def calculate_quality_metrics(df):
    """ãƒ‡ãƒ¼ã‚¿å“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹è¨ˆç®—"""
</p>
<p>
    metrics = {}
</p>
<p>
    # å®Œå…¨æ€§ï¼ˆCompletenessï¼‰
    total_cells = df.size
    missing_cells = df.isnull().sum().sum()
    completeness = (
        (total_cells - missing_cells) / total_cells
    ) * 100
</p>
<p>
    # ä¸€è²«æ€§ï¼ˆConsistencyï¼‰
    # ä¾‹: ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ãŒè² ã®å€¤ã§ãªã„ã‹
    if 'band_gap_mp' in df.columns:
        invalid_bg = (df['band_gap_mp'] < 0).sum()
        consistency = (
            (len(df) - invalid_bg) / len(df)
        ) * 100
    else:
        consistency = 100.0
</p>
<p>
    # ç²¾åº¦ï¼ˆAccuracyï¼‰
    # ä¾‹: MPã¨AFLOWã®å·®ç•°
    if 'band_gap_mp' in df.columns and \
       'band_gap_aflow' in df.columns:
        diff = (
            df['band_gap_mp'] - df['band_gap_aflow']
        ).abs()
        avg_diff = diff.mean()
        accuracy = max(
            0, 100 - (avg_diff / df['band_gap_mp'].mean()) * 100
        )
    else:
        accuracy = None
</p>
<p>
    metrics = {
        "Completeness (%)": round(completeness, 2),
        "Consistency (%)": round(consistency, 2),
        "Accuracy (%)": round(accuracy, 2) if accuracy else "N/A",
        "Total Records": len(df),
        "Total Cells": total_cells,
        "Missing Cells": missing_cells
    }
</p>
<p>
    print("=== ãƒ‡ãƒ¼ã‚¿å“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹ ===")
    for key, value in metrics.items():
        print(f"{key}: {value}")
</p>
<p>
    return metrics
</p>
<p>
<h1>å“è³ªè©•ä¾¡</h1>
quality = calculate_quality_metrics(df_clean)
</code></pre>
</p>
<p>
<h3>3.5.2 ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«</h3>
</p>
<p>
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹10: ãƒ‡ãƒ¼ã‚¿ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³</strong>
</p>
<p>
<pre><code class="language-python">def validate_materials_data(df):
    """ææ–™ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³"""
</p>
<p>
    validation_report = []
</p>
<p>
    # ãƒ«ãƒ¼ãƒ«1: ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã¯0ä»¥ä¸Š
    if 'band_gap_mp' in df.columns:
        invalid_bg = df[df['band_gap_mp'] < 0]
        if len(invalid_bg) > 0:
            validation_report.append({
                "Rule": "Band Gap >= 0",
                "Status": "FAIL",
                "Failed Records": len(invalid_bg)
            })
        else:
            validation_report.append({
                "Rule": "Band Gap >= 0",
                "Status": "PASS",
                "Failed Records": 0
            })
</p>
<p>
    # ãƒ«ãƒ¼ãƒ«2: å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯è² 
    if 'formation_energy_mp' in df.columns:
        invalid_fe = df[df['formation_energy_mp'] > 0]
        if len(invalid_fe) > 0:
            validation_report.append({
                "Rule": "Formation Energy <= 0",
                "Status": "WARNING",
                "Failed Records": len(invalid_fe)
            })
        else:
            validation_report.append({
                "Rule": "Formation Energy <= 0",
                "Status": "PASS",
                "Failed Records": 0
            })
</p>
<p>
    # ãƒ«ãƒ¼ãƒ«3: å®‰å®šæ€§ <= 0.1 eV/atom
    if 'stability_mp' in df.columns:
        unstable = df[df['stability_mp'] > 0.1]
        validation_report.append({
            "Rule": "Stability <= 0.1 eV/atom",
            "Status": "INFO",
            "Failed Records": len(unstable)
        })
</p>
<p>
    # ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º
    print("=== ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¬ãƒãƒ¼ãƒˆ ===")
    report_df = pd.DataFrame(validation_report)
    print(report_df)
</p>
<p>
    return report_df
</p>
<p>
<h1>ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ</h1>
validation = validate_materials_data(df_clean)
</code></pre>
</p>
<p>
---
</p>
<p>
<h2>3.6 å®Ÿè·µã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£</h2>
</p>
<p>
<h3>3.6.1 é›»æ± ææ–™æ¢ç´¢</h3>
</p>
<p>
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹11: Li-ioné›»æ± æ­£æ¥µææ–™ã®çµ±åˆæ¢ç´¢</strong>
</p>
<p>
<pre><code class="language-python">def find_battery_materials():
    """è¤‡æ•°DBã‹ã‚‰é›»æ± ææ–™ã‚’æ¢ç´¢"""
</p>
<p>
    # Materials Projectã‹ã‚‰æ¢ç´¢
    with MPRester(MP_API_KEY) as mpr:
        mp_docs = mpr.materials.summary.search(
            elements=["Li", "Co", "O"],
            energy_above_hull=(0, 0.05),
            fields=[
                "material_id",
                "formula_pretty",
                "energy_above_hull",
                "formation_energy_per_atom"
            ]
        )
</p>
<p>
    mp_data = [{
        "source": "MP",
        "formula": doc.formula_pretty,
        "stability": doc.energy_above_hull,
        "formation_energy": doc.formation_energy_per_atom
    } for doc in mp_docs]
</p>
<p>
    # AFLOWï¼ˆç°¡ç•¥ç‰ˆï¼‰
    # å®Ÿéš›ã®AFLOW APIã‚³ãƒ¼ãƒ«ã¯çœç•¥
</p>
<p>
    # çµ±åˆ
    df_battery = pd.DataFrame(mp_data)
</p>
<p>
    # å®‰å®šæ€§ã§ã‚½ãƒ¼ãƒˆ
    df_battery = df_battery.sort_values('stability')
</p>
<p>
    print("=== Li-Co-Oç³»é›»æ± ææ–™å€™è£œ ===")
    print(df_battery.head(10))
</p>
<p>
    return df_battery
</p>
<p>
<h1>å®Ÿè¡Œ</h1>
df_battery = find_battery_materials()
</code></pre>
</p>
<p>
<h3>3.6.2 è§¦åª’ææ–™ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°</h3>
</p>
<p>
<strong>ã‚³ãƒ¼ãƒ‰ä¾‹12: é·ç§»é‡‘å±é…¸åŒ–ç‰©è§¦åª’ã®çµ±åˆã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°</strong>
</p>
<p>
<pre><code class="language-python">def screen_catalysts(
    transition_metals=["Ti", "V", "Cr", "Mn", "Fe"]
):
    """è§¦åª’ææ–™ã®çµ±åˆã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°"""
</p>
<p>
    all_results = []
</p>
<p>
    for tm in transition_metals:
        # Materials Projectã‹ã‚‰å–å¾—
        with MPRester(MP_API_KEY) as mpr:
            docs = mpr.materials.summary.search(
                elements=[tm, "O"],
                band_gap=(0.1, 3.0),
                energy_above_hull=(0, 0.1),
                fields=[
                    "material_id",
                    "formula_pretty",
                    "band_gap",
                    "energy_above_hull"
                ]
            )
</p>
<p>
            for doc in docs:
                all_results.append({
                    "transition_metal": tm,
                    "formula": doc.formula_pretty,
                    "band_gap": doc.band_gap,
                    "stability": doc.energy_above_hull,
                    "source": "MP"
                })
</p>
<p>
    df_catalysts = pd.DataFrame(all_results)
</p>
<p>
    # ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
    df_catalysts = df_catalysts.drop_duplicates(
        subset=['formula']
    )
</p>
<p>
    # ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ç¯„å›²ã§ãƒ•ã‚£ãƒ«ã‚¿
    df_ideal = df_catalysts[
        (df_catalysts['band_gap'] >= 1.5) &
        (df_catalysts['band_gap'] <= 2.5)
    ]
</p>
<p>
    print(f"=== è§¦åª’å€™è£œææ–™ ===")
    print(f"ç·å€™è£œ: {len(df_catalysts)}ä»¶")
    print(f"ç†æƒ³çš„ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: {len(df_ideal)}ä»¶")
    print("\nä¸Šä½10ä»¶:")
    print(df_ideal.head(10))
</p>
<p>
    return df_ideal
</p>
<p>
<h1>å®Ÿè¡Œ</h1>
df_catalysts = screen_catalysts()
</code></pre>
</p>
<p>
---
</p>
<p>
<h2>3.7 ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å¯è¦–åŒ–</h2>
</p>
<p>
<pre><code class="language-mermaid">graph TD
    A[ãƒ‡ãƒ¼ã‚¿å–å¾—] --> B[Materials Project]
    A --> C[AFLOW]
    A --> D[OQMD]
</p>
<p>
    B --> E[ãƒ‡ãƒ¼ã‚¿çµåˆ]
    C --> E
    D --> E
</p>
<p>
    E --> F[é‡è¤‡å‰Šé™¤]
    F --> G[å¤–ã‚Œå€¤æ¤œå‡º]
    G --> H[æ¬ æå€¤å‡¦ç†]
</p>
<p>
    H --> I[å“è³ªè©•ä¾¡]
    I --> J{å“è³ªOK?}
</p>
<p>
    J -->|Yes| K[ãƒ‡ãƒ¼ã‚¿ä¿å­˜]
    J -->|No| L[å†å‡¦ç†]
    L --> E
</p>
<p>
    K --> M[å®šæœŸæ›´æ–°]
    M --> A
</p>
<p>
    style A fill:#e3f2fd
    style K fill:#e8f5e9
    style J fill:#fff3e0
</code></pre>
</p>
<p>
---
</p>
<p>
<h2>3.8 æœ¬ç« ã®ã¾ã¨ã‚</h2>
</p>
<p>
<h3>å­¦ã‚“ã ã“ã¨</h3>
</p>
<p>
1. <strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆ</strong>
   - Materials Projectã¨AFLOWã®çµ±åˆ
   - åŒ–å­¦å¼ã‚’ã‚­ãƒ¼ã¨ã—ãŸçµåˆ
   - outer joinã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿çµ±åˆ
</p>
<p>
2. <strong>ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°</strong>
   - é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®æ¤œå‡ºã¨å‰Šé™¤
   - IQRæ³•ã«ã‚ˆã‚‹å¤–ã‚Œå€¤æ¤œå‡º
   - ãƒ‡ãƒ¼ã‚¿å‹ã®çµ±ä¸€
</p>
<p>
3. <strong>æ¬ æå€¤å‡¦ç†</strong>
   - æ¬ æãƒ‘ã‚¿ãƒ¼ãƒ³ã®å¯è¦–åŒ–
   - å¹³å‡å€¤ãƒ»ä¸­å¤®å€¤è£œå®Œ
   - KNNè£œå®Œ
</p>
<p>
4. <strong>è‡ªå‹•åŒ–ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</strong>
   - ãƒ‡ãƒ¼ã‚¿å–å¾—â†’ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°â†’ä¿å­˜
   - ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ
   - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†
</p>
<p>
5. <strong>å“è³ªç®¡ç†</strong>
   - å®Œå…¨æ€§ãƒ»ä¸€è²«æ€§ãƒ»ç²¾åº¦ã®è©•ä¾¡
   - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«
   - å“è³ªãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ
</p>
<p>
<h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>
</p>
<p>
<li>âœ… è¤‡æ•°DBã®çµ±åˆã§ä¿¡é ¼æ€§å‘ä¸Š</li>
<li>âœ… ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã¯å¿…é ˆãƒ—ãƒ­ã‚»ã‚¹</li>
<li>âœ… æ¬ æå€¤å‡¦ç†ã¯ç”¨é€”ã«å¿œã˜ã¦é¸æŠ</li>
<li>âœ… è‡ªå‹•åŒ–ã§ç¶™ç¶šçš„ãªãƒ‡ãƒ¼ã‚¿æ›´æ–°</li>
<li>âœ… å“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹ã§å®¢è¦³çš„è©•ä¾¡</li>
</p>
<p>
<h3>æ¬¡ã®ç« ã¸</h3>
</p>
<p>
ç¬¬4ç« ã§ã¯ã€ç‹¬è‡ªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ§‹ç¯‰ã‚’å­¦ã³ã¾ã™ï¼š
<li>SQLite/PostgreSQLè¨­è¨ˆ</li>
<li>ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆ</li>
<li>CRUDæ“ä½œ</li>
<li>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥</li></ul>
</p>
<p>
<strong><a href="./chapter-4.md">ç¬¬4ç« ï¼šç‹¬è‡ªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹ç¯‰ â†’</a></strong>
</p>
<p>
---
</p>
<p>
<h2>æ¼”ç¿’å•é¡Œ</h2>
</p>
<p>
<h3>å•é¡Œ1ï¼ˆé›£æ˜“åº¦ï¼šeasyï¼‰</h3>
</p>
<p>
Materials Projectã¨AFLOWã‹ã‚‰åŒä¸€ææ–™ï¼ˆSiCï¼‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã¨å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚
</p>
<p>
<strong>è¦æ±‚äº‹é …</strong>:
1. ä¸¡æ–¹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰SiCã®ãƒ‡ãƒ¼ã‚¿å–å¾—
2. ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã®å·®ç•°ã‚’%ã§è¡¨ç¤º
3. å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã®å·®ç•°ã‚’%ã§è¡¨ç¤º
</p>
<p>
<details>
<summary>è§£ç­”ä¾‹</summary>
</p>
<p>
<pre><code class="language-python">from mp_api.client import MPRester
import requests
</p>
<p>
MP_API_KEY = "your_api_key"
</p>
<p>
<h1>Materials Projectã‹ã‚‰å–å¾—</h1>
with MPRester(MP_API_KEY) as mpr:
    mp_docs = mpr.materials.summary.search(
        formula="SiC",
        fields=["band_gap", "formation_energy_per_atom"]
    )
    mp_bg = mp_docs[0].band_gap
    mp_fe = mp_docs[0].formation_energy_per_atom
</p>
<p>
<h1>AFLOWã‹ã‚‰å–å¾—ï¼ˆç°¡ç•¥ç‰ˆï¼‰</h1>
aflow_url = "http://aflowlib.org/API/aflux"
params = {
    "species": "Si,C",
    "$": "Egap,enthalpy_formation_atom"
}
response = requests.get(aflow_url, params=params)
aflow_data = response.json()[0]
aflow_bg = aflow_data.get("Egap")
aflow_fe = aflow_data.get("enthalpy_formation_atom")
</p>
<p>
<h1>æ¯”è¼ƒ</h1>
bg_diff = abs(mp_bg - aflow_bg) / mp_bg * 100
fe_diff = abs(mp_fe - aflow_fe) / abs(mp_fe) * 100
</p>
<p>
print(f"SiCãƒ‡ãƒ¼ã‚¿æ¯”è¼ƒ:")
print(f"ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: MP={mp_bg} eV, AFLOW={aflow_bg} eV")
print(f"å·®ç•°: {bg_diff:.1f}%")
print(f"\nå½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼: MP={mp_fe} eV/atom, "
      f"AFLOW={aflow_fe} eV/atom")
print(f"å·®ç•°: {fe_diff:.1f}%")
</code></pre>
</p>
<p>
</details>
</p>
<p>
---
</p>
<p>
<h3>å•é¡Œ2ï¼ˆé›£æ˜“åº¦ï¼šmediumï¼‰</h3>
</p>
<p>
ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å¯¾ã—ã¦ã€æ¬ æå€¤å‡¦ç†ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
</p>
<p>
<pre><code class="language-python">import pandas as pd
import numpy as np
</p>
<p>
<h1>ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿</h1>
data = {
    'material_id': ['mp-1', 'mp-2', 'mp-3', 'mp-4', 'mp-5'],
    'formula': ['TiO2', 'ZnO', 'GaN', 'SiC', 'Al2O3'],
    'band_gap': [3.44, np.nan, 3.20, 2.36, np.nan],
    'formation_energy': [-4.87, -1.95, np.nan, -0.67, -3.45]
}
df = pd.DataFrame(data)
</code></pre>
</p>
<p>
<strong>è¦æ±‚äº‹é …</strong>:
1. æ¬ æå€¤ã‚’å¹³å‡å€¤ã§è£œå®Œ
2. æ¬ æå€¤ã‚’KNNæ³•ã§è£œå®Œ
3. 2ã¤ã®æ–¹æ³•ã®çµæœã‚’æ¯”è¼ƒ
</p>
<p>
<details>
<summary>è§£ç­”ä¾‹</summary>
</p>
<p>
<pre><code class="language-python">from sklearn.impute import SimpleImputer, KNNImputer
</p>
<p>
<h1>å¹³å‡å€¤è£œå®Œ</h1>
imputer_mean = SimpleImputer(strategy='mean')
df_mean = df.copy()
df_mean[['band_gap', 'formation_energy']] = \
    imputer_mean.fit_transform(
        df[['band_gap', 'formation_energy']]
    )
</p>
<p>
<h1>KNNè£œå®Œ</h1>
imputer_knn = KNNImputer(n_neighbors=2)
df_knn = df.copy()
df_knn[['band_gap', 'formation_energy']] = \
    imputer_knn.fit_transform(
        df[['band_gap', 'formation_energy']]
    )
</p>
<p>
<h1>æ¯”è¼ƒ</h1>
print("å…ƒãƒ‡ãƒ¼ã‚¿:")
print(df)
print("\nå¹³å‡å€¤è£œå®Œ:")
print(df_mean)
print("\nKNNè£œå®Œ:")
print(df_knn)
</p>
<p>
<h1>å·®ç•°åˆ†æ</h1>
diff_bg = (
    df_mean['band_gap'] - df_knn['band_gap']
).abs().mean()
diff_fe = (
    df_mean['formation_energy'] -
    df_knn['formation_energy']
).abs().mean()
</p>
<p>
print(f"\nå¹³å‡å·®ç•°:")
print(f"ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: {diff_bg:.3f} eV")
print(f"å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼: {diff_fe:.3f} eV/atom")
</code></pre>
</p>
<p>
</details>
</p>
<p>
---
</p>
<p>
<h3>å•é¡Œ3ï¼ˆé›£æ˜“åº¦ï¼šhardï¼‰</h3>
</p>
<p>
Materials Projectã¨AFLOWã‹ã‚‰100ä»¶ä»¥ä¸Šã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€çµ±åˆãƒ»ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ãƒ»å“è³ªè©•ä¾¡ã‚’è¡Œã†å®Œå…¨ãªãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã—ã¦ãã ã•ã„ã€‚
</p>
<p>
<strong>è¦æ±‚äº‹é …</strong>:
1. é…¸åŒ–ç‰©ï¼ˆOå«æœ‰ï¼‰ææ–™ã‚’100ä»¶ä»¥ä¸Šå–å¾—
2. ãƒ‡ãƒ¼ã‚¿çµ±åˆï¼ˆouter joinï¼‰
3. é‡è¤‡å‰Šé™¤ã€å¤–ã‚Œå€¤æ¤œå‡º
4. æ¬ æå€¤è£œå®Œ
5. å“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹ç®—å‡º
6. çµæœã‚’CSVã¨JSONã§ä¿å­˜
</p>
<p>
<details>
<summary>è§£ç­”ä¾‹</summary>
</p>
<p>
<pre><code class="language-python">from mp_api.client import MPRester
import requests
import pandas as pd
import numpy as np
from sklearn.impute import KNNImputer
import json
from datetime import datetime
</p>
<p>
MP_API_KEY = "your_api_key"
</p>
<p>
class IntegratedDataPipeline:
    """çµ±åˆãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³"""
</p>
<p>
    def __init__(self):
        self.df = None
</p>
<p>
    def fetch_mp_data(self, num_materials=100):
        """Materials Projectã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—"""
        with MPRester(MP_API_KEY) as mpr:
            docs = mpr.materials.summary.search(
                elements=["O"],
                fields=[
                    "material_id",
                    "formula_pretty",
                    "band_gap",
                    "formation_energy_per_atom"
                ]
            )[:num_materials]
</p>
<p>
            return pd.DataFrame([{
                "material_id": doc.material_id,
                "formula": doc.formula_pretty,
                "band_gap_mp": doc.band_gap,
                "formation_energy_mp":
                    doc.formation_energy_per_atom,
                "source": "MP"
            } for doc in docs])
</p>
<p>
    def merge_data(self, df_mp, df_aflow=None):
        """ãƒ‡ãƒ¼ã‚¿çµ±åˆ"""
        # ç°¡ç•¥ç‰ˆ: AFLOWãƒ‡ãƒ¼ã‚¿ã¯çœç•¥
        return df_mp
</p>
<p>
    def clean_data(self, df):
        """ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°"""
        # é‡è¤‡å‰Šé™¤
        df = df.drop_duplicates(subset=['formula'])
</p>
<p>
        # å¤–ã‚Œå€¤æ¤œå‡ºï¼ˆIQRæ³•ï¼‰
        Q1 = df['band_gap_mp'].quantile(0.25)
        Q3 = df['band_gap_mp'].quantile(0.75)
        IQR = Q3 - Q1
        df = df[
            (df['band_gap_mp'] >= Q1 - 1.5 * IQR) &
            (df['band_gap_mp'] <= Q3 + 1.5 * IQR)
        ]
</p>
<p>
        return df
</p>
<p>
    def impute_missing(self, df):
        """æ¬ æå€¤è£œå®Œ"""
        numeric_cols = [
            'band_gap_mp', 'formation_energy_mp'
        ]
        imputer = KNNImputer(n_neighbors=5)
        df[numeric_cols] = imputer.fit_transform(
            df[numeric_cols]
        )
        return df
</p>
<p>
    def calculate_quality(self, df):
        """å“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹"""
        total_cells = df.size
        missing_cells = df.isnull().sum().sum()
        completeness = (
            (total_cells - missing_cells) / total_cells
        ) * 100
</p>
<p>
        return {
            "completeness": completeness,
            "num_records": len(df),
            "timestamp": datetime.now().isoformat()
        }
</p>
<p>
    def save_results(self, df, quality):
        """çµæœä¿å­˜"""
        # CSVä¿å­˜
        df.to_csv("integrated_data.csv", index=False)
</p>
<p>
        # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä¿å­˜
        with open("quality_report.json", 'w') as f:
            json.dump(quality, f, indent=2)
</p>
<p>
        print("ãƒ‡ãƒ¼ã‚¿ä¿å­˜å®Œäº†:")
        print("- integrated_data.csv")
        print("- quality_report.json")
</p>
<p>
    def run(self):
        """ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ"""
        print("=== çµ±åˆãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ ===")
</p>
<p>
        # ãƒ‡ãƒ¼ã‚¿å–å¾—
        print("1. ãƒ‡ãƒ¼ã‚¿å–å¾—ä¸­...")
        df_mp = self.fetch_mp_data(100)
</p>
<p>
        # çµ±åˆ
        print("2. ãƒ‡ãƒ¼ã‚¿çµ±åˆä¸­...")
        df = self.merge_data(df_mp)
</p>
<p>
        # ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
        print("3. ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ä¸­...")
        df = self.clean_data(df)
</p>
<p>
        # æ¬ æå€¤è£œå®Œ
        print("4. æ¬ æå€¤è£œå®Œä¸­...")
        df = self.impute_missing(df)
</p>
<p>
        # å“è³ªè©•ä¾¡
        print("5. å“è³ªè©•ä¾¡ä¸­...")
        quality = self.calculate_quality(df)
</p>
<p>
        # ä¿å­˜
        print("6. çµæœä¿å­˜ä¸­...")
        self.save_results(df, quality)
</p>
<p>
        print("\n=== å®Œäº† ===")
        print(f"ç·ãƒ‡ãƒ¼ã‚¿æ•°: {len(df)}")
        print(f"å“è³ªã‚¹ã‚³ã‚¢: {quality['completeness']:.2f}%")
</p>
<p>
        self.df = df
        return df, quality
</p>
<p>
<h1>å®Ÿè¡Œ</h1>
pipeline = IntegratedDataPipeline()
df_result, quality_metrics = pipeline.run()
</code></pre>
</p>
<p>
</details>
</p>
<p>
---
</p>
<p>
<h2>å‚è€ƒæ–‡çŒ®</h2>
</p>
<p>
1. Wilkinson, M. D. et al. (2016). "The FAIR Guiding Principles for scientific data management and stewardship." <em>Scientific Data</em>, 3, 160018.
   DOI: <a href="https://doi.org/10.1038/sdata.2016.18">10.1038/sdata.2016.18</a>
</p>
<p>
2. pandas Documentation. "Merge, join, concatenate and compare." URL: <a href="https://pandas.pydata.org/docs">pandas.pydata.org/docs</a>
</p>
<p>
---
</p>
<p>
<h2>ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³</h2>
</p>
<p>
<h3>å‰ã®ç« </h3>
<strong><a href="./chapter-2.md">ç¬¬2ç« ï¼šMaterials Projectå®Œå…¨ã‚¬ã‚¤ãƒ‰ â†</a></strong>
</p>
<p>
<h3>æ¬¡ã®ç« </h3>
<strong><a href="./chapter-4.md">ç¬¬4ç« ï¼šç‹¬è‡ªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹ç¯‰ â†’</a></strong>
</p>
<p>
<h3>ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡</h3>
<strong><a href="./index.md">â† ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a></strong>
</p>
<p>
---
</p>
<p>
<h2>è‘—è€…æƒ…å ±</h2>
</p>
<p>
<strong>ä½œæˆè€…</strong>: AI Terakoya Content Team
<strong>ç›£ä¿®</strong>: Dr. Yusuke Hashimotoï¼ˆæ±åŒ—å¤§å­¦ï¼‰
<strong>ä½œæˆæ—¥</strong>: 2025-10-17
<strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0
</p>
<p>
<strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0
</p>
<p>
---
</p>
<p>
<strong>æ¬¡ã®ç« ã§å­¦ç¿’ã‚’ç¶šã‘ã¾ã—ã‚‡ã†ï¼</strong>

</p>

        <div class="navigation">
            <div>
                <a href="chapter-2.html" class="btn btn-secondary">â† å‰ã¸</a>
                <a href="index.html" class="btn btn-secondary">ç›®æ¬¡ã¸</a>
            </div>
            <div>
                <a href="chapter-4.html" class="btn btn-primary">æ¬¡ã¸ â†’</a>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 AI Terakoya - Tohoku University. All rights reserved.</p>
        <p><a href="https://ai.tohoku.ac.jp">AI Terakoya Home</a></p>
    </footer>
</body>
</html>